<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 38 Principal component analysis | R statistics</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 38 Principal component analysis | R statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 38 Principal component analysis | R statistics" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Mark Goldberg" />


<meta name="date" content="2021-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="principal-component-analysis.html"/>
<link rel="next" href="learning-vector-quantization.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html"><i class="fa fa-check"></i><b>2</b> Statistics R functions reference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#get-data"><i class="fa fa-check"></i><b>2.1</b> Get data</a></li>
<li class="chapter" data-level="2.2" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#data-inspection"><i class="fa fa-check"></i><b>2.2</b> Data inspection</a></li>
<li class="chapter" data-level="2.3" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#plots"><i class="fa fa-check"></i><b>2.3</b> Plots</a></li>
<li class="chapter" data-level="2.4" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#analysis-of-the-distribution"><i class="fa fa-check"></i><b>2.4</b> Analysis of the distribution</a></li>
<li class="chapter" data-level="2.5" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#distributions"><i class="fa fa-check"></i><b>2.5</b> Distributions</a></li>
<li class="chapter" data-level="2.6" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#t-test"><i class="fa fa-check"></i><b>2.6</b> t-Test</a></li>
<li class="chapter" data-level="2.7" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#anova"><i class="fa fa-check"></i><b>2.7</b> ANOVA</a></li>
<li class="chapter" data-level="2.8" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#machine-learning-functions-reference"><i class="fa fa-check"></i><b>2.8</b> Machine Learning Functions Reference</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#linear-regression"><i class="fa fa-check"></i><b>2.8.1</b> Linear Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="combinatorics.html"><a href="combinatorics.html"><i class="fa fa-check"></i><b>3</b> Combinatorics</a></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Probability</a></li>
<li class="chapter" data-level="5" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>5</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="basic-statistics.html"><a href="basic-statistics.html#definitions"><i class="fa fa-check"></i><b>5.1</b> Definitions</a></li>
<li class="chapter" data-level="5.2" data-path="basic-statistics.html"><a href="basic-statistics.html#probability-1"><i class="fa fa-check"></i><b>5.2</b> Probability</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-distributions.html"><a href="statistical-distributions.html"><i class="fa fa-check"></i><b>6</b> Statistical distributions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistical-distributions.html"><a href="statistical-distributions.html#normal-distribution"><i class="fa fa-check"></i><b>6.1</b> Normal Distribution</a></li>
<li class="chapter" data-level="6.2" data-path="statistical-distributions.html"><a href="statistical-distributions.html#bernoulli-distribution"><i class="fa fa-check"></i><b>6.2</b> Bernoulli Distribution</a></li>
<li class="chapter" data-level="6.3" data-path="statistical-distributions.html"><a href="statistical-distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>6.3</b> Binomial Distribution</a></li>
<li class="chapter" data-level="6.4" data-path="statistical-distributions.html"><a href="statistical-distributions.html#beta-distribution"><i class="fa fa-check"></i><b>6.4</b> Beta distribution</a></li>
<li class="chapter" data-level="6.5" data-path="statistical-distributions.html"><a href="statistical-distributions.html#geometric-distribution"><i class="fa fa-check"></i><b>6.5</b> Geometric Distribution</a></li>
<li class="chapter" data-level="6.6" data-path="statistical-distributions.html"><a href="statistical-distributions.html#uniform-distributions"><i class="fa fa-check"></i><b>6.6</b> Uniform Distributions</a></li>
<li class="chapter" data-level="6.7" data-path="statistical-distributions.html"><a href="statistical-distributions.html#poisson-distribution"><i class="fa fa-check"></i><b>6.7</b> Poisson Distribution</a></li>
<li class="chapter" data-level="6.8" data-path="statistical-distributions.html"><a href="statistical-distributions.html#exponential-distribution"><i class="fa fa-check"></i><b>6.8</b> Exponential Distribution</a></li>
<li class="chapter" data-level="6.9" data-path="statistical-distributions.html"><a href="statistical-distributions.html#chi-squared-distribution"><i class="fa fa-check"></i><b>6.9</b> Chi-squared Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html"><i class="fa fa-check"></i><b>7</b> Primary data analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#analysis-of-sample-distribution"><i class="fa fa-check"></i><b>7.1</b> Analysis of sample distribution</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#histogram"><i class="fa fa-check"></i><b>7.1.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#handling-missing-data"><i class="fa fa-check"></i><b>7.2</b> Handling missing data</a></li>
<li class="chapter" data-level="7.3" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#dealing-with-outliers"><i class="fa fa-check"></i><b>7.3</b> Dealing with outliers</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-normalization.html"><a href="data-normalization.html"><i class="fa fa-check"></i><b>8</b> Data normalization</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-normalization.html"><a href="data-normalization.html#normality-test"><i class="fa fa-check"></i><b>8.1</b> Normality test</a></li>
<li class="chapter" data-level="8.2" data-path="data-normalization.html"><a href="data-normalization.html#finding-confidence-intervals"><i class="fa fa-check"></i><b>8.2</b> Finding Confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="primary-data-analysis-case-studies.html"><a href="primary-data-analysis-case-studies.html"><i class="fa fa-check"></i><b>9</b> Primary data analysis - Case studies</a></li>
<li class="chapter" data-level="10" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>10</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-theory"><i class="fa fa-check"></i><b>10.1</b> Hypothesis testing theory</a></li>
<li class="chapter" data-level="10.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-test-practice"><i class="fa fa-check"></i><b>10.2</b> Hypothesis test (Practice)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="t-procedures.html"><a href="t-procedures.html"><i class="fa fa-check"></i><b>11</b> t-Procedures</a>
<ul>
<li class="chapter" data-level="11.1" data-path="t-procedures.html"><a href="t-procedures.html#t-test-and-normal-distribution"><i class="fa fa-check"></i><b>11.1</b> t-test and normal distribution</a></li>
<li class="chapter" data-level="11.2" data-path="t-procedures.html"><a href="t-procedures.html#one-sample-t-test"><i class="fa fa-check"></i><b>11.2</b> One-sample t-test</a></li>
<li class="chapter" data-level="11.3" data-path="t-procedures.html"><a href="t-procedures.html#practical-example-t-test-in-r"><i class="fa fa-check"></i><b>11.3</b> Practical example: t-test in R</a></li>
<li class="chapter" data-level="11.4" data-path="t-procedures.html"><a href="t-procedures.html#two-samples-t-test"><i class="fa fa-check"></i><b>11.4</b> Two samples t-test</a></li>
<li class="chapter" data-level="11.5" data-path="t-procedures.html"><a href="t-procedures.html#compare-students-t-and-normal-distributions"><i class="fa fa-check"></i><b>11.5</b> Compare Student’s t and normal distributions</a></li>
<li class="chapter" data-level="11.6" data-path="t-procedures.html"><a href="t-procedures.html#non-parametric-tests"><i class="fa fa-check"></i><b>11.6</b> Non-parametric tests</a></li>
<li class="chapter" data-level="11.7" data-path="t-procedures.html"><a href="t-procedures.html#mann-whitney-u-rank-sum-test"><i class="fa fa-check"></i><b>11.7</b> Mann-Whitney U Rank Sum Test</a></li>
<li class="chapter" data-level="11.8" data-path="t-procedures.html"><a href="t-procedures.html#wilcoxon-test"><i class="fa fa-check"></i><b>11.8</b> Wilcoxon test</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="tests-for-categorical-variables.html"><a href="tests-for-categorical-variables.html"><i class="fa fa-check"></i><b>12</b> Tests for categorical variables</a>
<ul>
<li class="chapter" data-level="12.1" data-path="tests-for-categorical-variables.html"><a href="tests-for-categorical-variables.html#chi-squared-tests"><i class="fa fa-check"></i><b>12.1</b> Chi-squared tests</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multiple-testing.html"><a href="multiple-testing.html"><i class="fa fa-check"></i><b>13</b> Multiple testing</a>
<ul>
<li class="chapter" data-level="13.1" data-path="multiple-testing.html"><a href="multiple-testing.html#the-bonferroni-correction"><i class="fa fa-check"></i><b>13.1</b> The Bonferroni correction</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sources.html"><a href="sources.html"><i class="fa fa-check"></i><b>14</b> Sources</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sources.html"><a href="sources.html#t-test-1"><i class="fa fa-check"></i><b>14.1</b> t-test</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="sources.html"><a href="sources.html#two-tailed-test"><i class="fa fa-check"></i><b>14.1.1</b> Two-tailed test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="wilcoxon-signed-rank-test.html"><a href="wilcoxon-signed-rank-test.html"><i class="fa fa-check"></i><b>15</b> Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="16" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>16</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="16.1" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html#one-way-anova"><i class="fa fa-check"></i><b>16.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="16.2" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html#sources-1"><i class="fa fa-check"></i><b>16.2</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="t-test-anova-difference.html"><a href="t-test-anova-difference.html"><i class="fa fa-check"></i><b>17</b> t-test ANOVA difference</a></li>
<li class="chapter" data-level="18" data-path="chi-squared-test.html"><a href="chi-squared-test.html"><i class="fa fa-check"></i><b>18</b> Chi-squared test</a>
<ul>
<li class="chapter" data-level="18.1" data-path="chi-squared-test.html"><a href="chi-squared-test.html#multinomial-goodness-of-fit"><i class="fa fa-check"></i><b>18.1</b> Multinomial Goodness of Fit</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html"><i class="fa fa-check"></i><b>19</b> Non-parametric Methods</a>
<ul>
<li class="chapter" data-level="19.1" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#sign-test"><i class="fa fa-check"></i><b>19.1</b> Sign Test</a></li>
<li class="chapter" data-level="19.2" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#wilcoxon-signed-rank-test-1"><i class="fa fa-check"></i><b>19.2</b> Wilcoxon Signed-Rank Test</a></li>
<li class="chapter" data-level="19.3" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#mann-whitney-wilcoxon-test"><i class="fa fa-check"></i><b>19.3</b> Mann-Whitney-Wilcoxon Test</a></li>
<li class="chapter" data-level="19.4" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>19.4</b> Kruskal-Wallis Test</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>20</b> Correlation</a></li>
<li class="chapter" data-level="21" data-path="methods-and-algorithms-of-machine-learning.html"><a href="methods-and-algorithms-of-machine-learning.html"><i class="fa fa-check"></i><b>21</b> Methods and algorithms of machine learning</a></li>
<li class="chapter" data-level="22" data-path="split-data-into-train-and-test-subsets.html"><a href="split-data-into-train-and-test-subsets.html"><i class="fa fa-check"></i><b>22</b> Split data into train and test subsets</a></li>
<li class="chapter" data-level="23" data-path="estimate-model-accuracy.html"><a href="estimate-model-accuracy.html"><i class="fa fa-check"></i><b>23</b> Estimate model accuracy</a>
<ul>
<li class="chapter" data-level="23.1" data-path="estimate-model-accuracy.html"><a href="estimate-model-accuracy.html#continuous-variables"><i class="fa fa-check"></i><b>23.1</b> Continuous variables</a></li>
<li class="chapter" data-level="23.2" data-path="estimate-model-accuracy.html"><a href="estimate-model-accuracy.html#discret-variables"><i class="fa fa-check"></i><b>23.2</b> Discret variables</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="model-evaluation.html"><a href="model-evaluation.html"><i class="fa fa-check"></i><b>24</b> Model evaluation</a></li>
<li class="chapter" data-level="25" data-path="cross-validation-and-bootstrep.html"><a href="cross-validation-and-bootstrep.html"><i class="fa fa-check"></i><b>25</b> Cross-validation and Bootstrep</a></li>
<li class="chapter" data-level="26" data-path="linear-regression-1.html"><a href="linear-regression-1.html"><i class="fa fa-check"></i><b>26</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="26.1" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-regression---theory"><i class="fa fa-check"></i><b>26.1</b> Linear regression - theory</a></li>
<li class="chapter" data-level="26.2" data-path="linear-regression-1.html"><a href="linear-regression-1.html#generate-random-data-set-for-the-linear-model"><i class="fa fa-check"></i><b>26.2</b> Generate random data set for the linear model</a></li>
<li class="chapter" data-level="26.3" data-path="linear-regression-1.html"><a href="linear-regression-1.html#practical-example"><i class="fa fa-check"></i><b>26.3</b> Practical example</a></li>
<li class="chapter" data-level="26.4" data-path="linear-regression-1.html"><a href="linear-regression-1.html#mean-squared-error-mse"><i class="fa fa-check"></i><b>26.4</b> Mean squared error (MSE)</a></li>
<li class="chapter" data-level="26.5" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-model-in-r"><i class="fa fa-check"></i><b>26.5</b> Linear model in R</a></li>
<li class="chapter" data-level="26.6" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-regression-model-for-multiple-parameters"><i class="fa fa-check"></i><b>26.6</b> Linear regression model for multiple parameters</a></li>
<li class="chapter" data-level="26.7" data-path="linear-regression-1.html"><a href="linear-regression-1.html#choosing-explanatory-variables-for-the-model"><i class="fa fa-check"></i><b>26.7</b> Choosing explanatory variables for the model</a></li>
<li class="chapter" data-level="26.8" data-path="linear-regression-1.html"><a href="linear-regression-1.html#assessment-of-model-performance-for-categorical-data."><i class="fa fa-check"></i><b>26.8</b> Assessment of model performance for categorical data.</a></li>
<li class="chapter" data-level="26.9" data-path="linear-regression-1.html"><a href="linear-regression-1.html#confidence-intervals-for-linear-model"><i class="fa fa-check"></i><b>26.9</b> Confidence intervals for linear model</a></li>
<li class="chapter" data-level="26.10" data-path="linear-regression-1.html"><a href="linear-regression-1.html#practical-examples-for-linear-model-regression"><i class="fa fa-check"></i><b>26.10</b> Practical examples for linear model regression</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html"><i class="fa fa-check"></i><b>27</b> Linear regression complex cases</a>
<ul>
<li class="chapter" data-level="27.1" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#cars"><i class="fa fa-check"></i><b>27.1</b> Cars</a></li>
<li class="chapter" data-level="27.2" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#linear-regression-modeling-compair-with-knn"><i class="fa fa-check"></i><b>27.2</b> Linear regression modeling, compair with kNN</a></li>
<li class="chapter" data-level="27.3" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#more-complex-example"><i class="fa fa-check"></i><b>27.3</b> More complex example</a></li>
<li class="chapter" data-level="27.4" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#next-part"><i class="fa fa-check"></i><b>27.4</b> NEXT part</a></li>
<li class="chapter" data-level="27.5" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#next-part-1"><i class="fa fa-check"></i><b>27.5</b> NEXT Part</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>28</b> Nonlinear regression</a></li>
<li class="chapter" data-level="29" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>29</b> Multiple linear regression</a></li>
<li class="chapter" data-level="30" data-path="spline-model.html"><a href="spline-model.html"><i class="fa fa-check"></i><b>30</b> Spline model</a>
<ul>
<li class="chapter" data-level="30.1" data-path="spline-model.html"><a href="spline-model.html#splines"><i class="fa fa-check"></i><b>30.1</b> Splines</a></li>
<li class="chapter" data-level="30.2" data-path="spline-model.html"><a href="spline-model.html#area-under-the-curve-using-spline-method"><i class="fa fa-check"></i><b>30.2</b> Area under the curve using spline method</a></li>
<li class="chapter" data-level="30.3" data-path="spline-model.html"><a href="spline-model.html#set-data-using-given-function-and-predict-curve-using-spline-method"><i class="fa fa-check"></i><b>30.3</b> Set data using given function and predict curve using spline method</a></li>
<li class="chapter" data-level="30.4" data-path="spline-model.html"><a href="spline-model.html#generate-dataset-from-a-given-function"><i class="fa fa-check"></i><b>30.4</b> Generate dataset from a given function</a></li>
<li class="chapter" data-level="30.5" data-path="spline-model.html"><a href="spline-model.html#split-data-for-train-and-test"><i class="fa fa-check"></i><b>30.5</b> Split data for train and test</a></li>
<li class="chapter" data-level="30.6" data-path="spline-model.html"><a href="spline-model.html#diagram-of-the-given-function-and-generated-datasets"><i class="fa fa-check"></i><b>30.6</b> Diagram of the given function and generated datasets</a></li>
<li class="chapter" data-level="30.7" data-path="spline-model.html"><a href="spline-model.html#build-a-model-using-splines"><i class="fa fa-check"></i><b>30.7</b> Build a model using splines</a></li>
<li class="chapter" data-level="30.8" data-path="spline-model.html"><a href="spline-model.html#diagram-of-mse-for-train-and-test-data"><i class="fa fa-check"></i><b>30.8</b> Diagram of MSE for train and test data</a></li>
<li class="chapter" data-level="30.9" data-path="spline-model.html"><a href="spline-model.html#build-optimal-model-and-plot-for-the-model"><i class="fa fa-check"></i><b>30.9</b> Build optimal model and plot for the model</a></li>
<li class="chapter" data-level="30.10" data-path="spline-model.html"><a href="spline-model.html#bibliograpy"><i class="fa fa-check"></i><b>30.10</b> Bibliograpy</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>31</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="31.1" data-path="logistic-regression.html"><a href="logistic-regression.html#confusion-matrix"><i class="fa fa-check"></i><b>31.1</b> Confusion matrix</a></li>
<li class="chapter" data-level="31.2" data-path="logistic-regression.html"><a href="logistic-regression.html#next-part-2"><i class="fa fa-check"></i><b>31.2</b> Next part</a></li>
<li class="chapter" data-level="31.3" data-path="logistic-regression.html"><a href="logistic-regression.html#next-part-3"><i class="fa fa-check"></i><b>31.3</b> NExt part</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="models-for-binary-data.html"><a href="models-for-binary-data.html"><i class="fa fa-check"></i><b>32</b> Models for binary Data</a></li>
<li class="chapter" data-level="33" data-path="support-vector-machine.html"><a href="support-vector-machine.html"><i class="fa fa-check"></i><b>33</b> Support Vector Machine</a></li>
<li class="chapter" data-level="34" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>34</b> Clustering</a>
<ul>
<li class="chapter" data-level="34.1" data-path="clustering.html"><a href="clustering.html#finding-distances-using-factoextra"><i class="fa fa-check"></i><b>34.1</b> Finding distances using factoextra</a></li>
<li class="chapter" data-level="34.2" data-path="clustering.html"><a href="clustering.html#example-of-choosing-clustering-model"><i class="fa fa-check"></i><b>34.2</b> Example of choosing clustering model</a></li>
<li class="chapter" data-level="34.3" data-path="clustering.html"><a href="clustering.html#k-means-clustering"><i class="fa fa-check"></i><b>34.3</b> K-means clustering</a></li>
<li class="chapter" data-level="34.4" data-path="clustering.html"><a href="clustering.html#k-means"><i class="fa fa-check"></i><b>34.4</b> k-Means</a></li>
<li class="chapter" data-level="34.5" data-path="clustering.html"><a href="clustering.html#hierarchical-clustering"><i class="fa fa-check"></i><b>34.5</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="34.6" data-path="clustering.html"><a href="clustering.html#knn"><i class="fa fa-check"></i><b>34.6</b> KNN</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>35</b> Regularization</a></li>
<li class="chapter" data-level="36" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>36</b> Factor analysis</a></li>
<li class="chapter" data-level="37" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>37</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="38" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html"><i class="fa fa-check"></i><b>38</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="38.1" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html#basic-statistics-1"><i class="fa fa-check"></i><b>38.1</b> Basic statistics</a></li>
<li class="chapter" data-level="38.2" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html#basic-linear-algebra-matrices"><i class="fa fa-check"></i><b>38.2</b> Basic linear algebra (matrices)</a>
<ul>
<li class="chapter" data-level="38.2.1" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html#t-sne---stochastic-neighbor-embedding"><i class="fa fa-check"></i><b>38.2.1</b> t-SNE - Stochastic Neighbor Embedding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="39" data-path="learning-vector-quantization.html"><a href="learning-vector-quantization.html"><i class="fa fa-check"></i><b>39</b> Learning Vector Quantization</a></li>
<li class="chapter" data-level="40" data-path="tree-based-models.html"><a href="tree-based-models.html"><i class="fa fa-check"></i><b>40</b> Tree-based models</a>
<ul>
<li class="chapter" data-level="40.1" data-path="tree-based-models.html"><a href="tree-based-models.html#classification-tree-example"><i class="fa fa-check"></i><b>40.1</b> Classification Tree example</a></li>
<li class="chapter" data-level="40.2" data-path="tree-based-models.html"><a href="tree-based-models.html#regression-tree-example"><i class="fa fa-check"></i><b>40.2</b> Regression Tree example</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>41</b> Random forest</a></li>
<li class="chapter" data-level="42" data-path="gradient-boosted-trees.html"><a href="gradient-boosted-trees.html"><i class="fa fa-check"></i><b>42</b> Gradient boosted trees</a></li>
<li class="chapter" data-level="43" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>43</b> Markov Chain Monte Carlo (MCMC)</a></li>
<li class="chapter" data-level="44" data-path="simple-markov-process.html"><a href="simple-markov-process.html"><i class="fa fa-check"></i><b>44</b> Simple Markov process</a>
<ul>
<li class="chapter" data-level="44.0.1" data-path="simple-markov-process.html"><a href="simple-markov-process.html#sources-2"><i class="fa fa-check"></i><b>44.0.1</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="45" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>45</b> Bayesian inference</a>
<ul>
<li class="chapter" data-level="45.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#simple-model-with-one-binary-parameter"><i class="fa fa-check"></i><b>45.1</b> Simple model with one binary parameter</a></li>
<li class="chapter" data-level="45.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#grid-approximation"><i class="fa fa-check"></i><b>45.2</b> Grid approximation</a></li>
<li class="chapter" data-level="45.3" data-path="bayesian-inference.html"><a href="bayesian-inference.html#grid-approximation-1"><i class="fa fa-check"></i><b>45.3</b> Grid approximation</a></li>
<li class="chapter" data-level="45.4" data-path="bayesian-inference.html"><a href="bayesian-inference.html#model-of-birth-weights-using-normal-distribution"><i class="fa fa-check"></i><b>45.4</b> Model of birth weights using normal distribution</a></li>
<li class="chapter" data-level="45.5" data-path="bayesian-inference.html"><a href="bayesian-inference.html#a-bayesian-model-of-zombie-iq"><i class="fa fa-check"></i><b>45.5</b> A Bayesian model of Zombie IQ</a></li>
<li class="chapter" data-level="45.6" data-path="bayesian-inference.html"><a href="bayesian-inference.html#the-best-models"><i class="fa fa-check"></i><b>45.6</b> The BEST models</a></li>
</ul></li>
<li class="chapter" data-level="46" data-path="naive-bayes-classifiers.html"><a href="naive-bayes-classifiers.html"><i class="fa fa-check"></i><b>46</b> Naive Bayes classifiers</a></li>
<li class="chapter" data-level="47" data-path="modeling-with-r-caret.html"><a href="modeling-with-r-caret.html"><i class="fa fa-check"></i><b>47</b> Modeling with R caret</a></li>
<li class="chapter" data-level="48" data-path="modeling-with-r-tensorflow.html"><a href="modeling-with-r-tensorflow.html"><i class="fa fa-check"></i><b>48</b> Modeling with R Tensorflow</a></li>
<li class="chapter" data-level="49" data-path="perceptron.html"><a href="perceptron.html"><i class="fa fa-check"></i><b>49</b> Perceptron</a></li>
<li class="chapter" data-level="50" data-path="deeplearning-r-h2o.html"><a href="deeplearning-r-h2o.html"><i class="fa fa-check"></i><b>50</b> Deeplearning R H2O</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="principal-component-analysis-1" class="section level1" number="38">
<h1><span class="header-section-number">Chapter 38</span> Principal component analysis</h1>
<div id="basic-statistics-1" class="section level2" number="38.1">
<h2><span class="header-section-number">38.1</span> Basic statistics</h2>
<p><strong>Standard deviation</strong> (SD) and <strong>Variance</strong> (<span class="math inline">\(s^2\)</span> are measures of the spread
of data in a data set.</p>
<p><strong>Standard deviation</strong> (SD):<br />
<span class="math display">\[s = \sqrt{\frac{\sum_{i=1}^{n} (X_i - \overline{X})^2}{(n-1)}}\]</span></p>
<p><strong>Variance</strong> (<span class="math inline">\(s^2, var(X)\)</span>):
<span class="math display">\[s^2 = \frac{\sum_{i=1}^{n} (X_i - \overline{X})^2}{(n-1)} = \frac{\sum_{i=1}^{n} (X_i - \overline{X})(X_i - \overline{X})}{(n-1)}\]</span></p>
<p><strong>Covariance</strong> (<span class="math inline">\(cov(X,Y)\)</span>):
<span class="math display">\[cov(X,Y) = \frac{\sum_{i=1}^{n} (X_i - \overline{X})(Y_i - \overline{Y})}{(n-1)}\]</span><br />
<strong>Covariance matrix</strong> for a set of data with n dimensions:
<span class="math display">\[C^{n \times n} = (C_{i,j}, c_{i,j} = cov(Dim_{i}, Dim_{j})),\]</span><br />
where <span class="math inline">\(C^{n \times n}\)</span> is a matrix with <span class="math inline">\(n\)</span> rows and <span class="math inline">\(n\)</span> columns, and <span class="math inline">\(Dim_x\)</span> is the <span class="math inline">\(x\)</span>th dimension.<br />
For n-dimentional data set, the matrix has n rows and columns and each entry in
the matrix is the result of calculating the covariance between two separate dimensions.
Eg. the entry on row 2, column 3, is the covariance value calculated between the
2nd dimension and the 3rd dimension.<br />
Example for 3 dimensional data set, using dimensions <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span>:</p>
<p><span class="math display">\[
C =
  \begin{pmatrix}
    cov(x,x) &amp; cov(x,y) &amp; cov(x,z)\\
    cov(y,x) &amp; cov(y,y) &amp; cov(y,z)\\
    cov(z,x) &amp; cov(z,y) &amp; cov(z,z)
  \end{pmatrix}
\]</span>
Covariations of the main diagonal turn to variance: <span class="math inline">\(cov(a,a) = var(a)\)</span><br />
The matrix is symmetrical about the main diagonal since <span class="math inline">\(cov(a,b) = cov(b,a)\)</span>.</p>
</div>
<div id="basic-linear-algebra-matrices" class="section level2" number="38.2">
<h2><span class="header-section-number">38.2</span> Basic linear algebra (matrices)</h2>
<p>Example of non-eigenvector:
<span class="math display">\[
  \begin{pmatrix}
    2 &amp; 3\\
    2 &amp; 1\\
  \end{pmatrix} \times \begin{pmatrix}
  1\\
  3
  \end{pmatrix} = \begin{pmatrix}
  2\cdot1+3\cdot3\\
  2\cdot1+1\cdot3
  \end{pmatrix} = \begin{pmatrix}
  11\\
  5
  \end{pmatrix}
\]</span>
Eigenvector:
<span class="math display">\[
  \begin{pmatrix}
    2 &amp; 3\\
    2 &amp; 1\\
  \end{pmatrix} \times \begin{pmatrix}
  3\\
  2
  \end{pmatrix} = \begin{pmatrix}
  12\\
  8
  \end{pmatrix} = 4 \times \begin{pmatrix}
  3\\
  2
  \end{pmatrix}
\]</span></p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="principal-component-analysis-1.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Principal Component Analysis</span></span>
<span id="cb253-2"><a href="principal-component-analysis-1.html#cb253-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-3"><a href="principal-component-analysis-1.html#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Source: https://www.datacamp.com/community/tutorials/pca-analysis-r</span></span>
<span id="cb253-4"><a href="principal-component-analysis-1.html#cb253-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-5"><a href="principal-component-analysis-1.html#cb253-5" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA allows to visualize datasets with many variables</span></span>
<span id="cb253-6"><a href="principal-component-analysis-1.html#cb253-6" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA is a linear transformation which simplify many variables into a smaller number of &quot;Principal Components&quot;.</span></span>
<span id="cb253-7"><a href="principal-component-analysis-1.html#cb253-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-8"><a href="principal-component-analysis-1.html#cb253-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Example 1 &quot;mtcars&quot;</span></span>
<span id="cb253-9"><a href="principal-component-analysis-1.html#cb253-9" aria-hidden="true" tabindex="-1"></a>mtcars.pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(mtcars[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">11</span>)], <span class="at">center =</span> <span class="cn">TRUE</span>,<span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb253-10"><a href="principal-component-analysis-1.html#cb253-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-11"><a href="principal-component-analysis-1.html#cb253-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtcars.pca)</span>
<span id="cb253-12"><a href="principal-component-analysis-1.html#cb253-12" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mtcars.pca)</span>
<span id="cb253-13"><a href="principal-component-analysis-1.html#cb253-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-14"><a href="principal-component-analysis-1.html#cb253-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb253-15"><a href="principal-component-analysis-1.html#cb253-15" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">&quot;vqv/ggbiplot&quot;</span>)</span>
<span id="cb253-16"><a href="principal-component-analysis-1.html#cb253-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbiplot)</span>
<span id="cb253-17"><a href="principal-component-analysis-1.html#cb253-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-18"><a href="principal-component-analysis-1.html#cb253-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(mtcars.pca)</span>
<span id="cb253-19"><a href="principal-component-analysis-1.html#cb253-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(mtcars.pca, <span class="at">labels=</span><span class="fu">rownames</span>(mtcars))</span>
<span id="cb253-20"><a href="principal-component-analysis-1.html#cb253-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-21"><a href="principal-component-analysis-1.html#cb253-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(mtcars.pca,<span class="at">ellipse=</span><span class="cn">TRUE</span>,<span class="at">choices=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>),   <span class="at">labels=</span><span class="fu">rownames</span>(mtcars), <span class="at">groups=</span>mtcars.country)</span>
<span id="cb253-22"><a href="principal-component-analysis-1.html#cb253-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(mtcars.pca,<span class="at">ellipse=</span><span class="cn">TRUE</span>,<span class="at">circle=</span><span class="cn">TRUE</span>, <span class="at">labels=</span><span class="fu">rownames</span>(mtcars), <span class="at">groups=</span>mtcars.country)</span>
<span id="cb253-23"><a href="principal-component-analysis-1.html#cb253-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(mtcars.pca,<span class="at">ellipse=</span><span class="cn">TRUE</span>,<span class="at">obs.scale =</span> <span class="dv">1</span>, <span class="at">var.scale =</span> <span class="dv">1</span>,  <span class="at">labels=</span><span class="fu">rownames</span>(mtcars), <span class="at">groups=</span>mtcars.country)</span>
<span id="cb253-24"><a href="principal-component-analysis-1.html#cb253-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(mtcars.pca,<span class="at">ellipse=</span><span class="cn">TRUE</span>,<span class="at">obs.scale =</span> <span class="dv">1</span>, <span class="at">var.scale =</span> <span class="dv">1</span>,<span class="at">var.axes=</span><span class="cn">FALSE</span>,   <span class="at">labels=</span><span class="fu">rownames</span>(mtcars), <span class="at">groups=</span>mtcars.country)</span>
<span id="cb253-25"><a href="principal-component-analysis-1.html#cb253-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-26"><a href="principal-component-analysis-1.html#cb253-26" aria-hidden="true" tabindex="-1"></a><span class="do">### Example 2 &quot;USArrests&quot;</span></span>
<span id="cb253-27"><a href="principal-component-analysis-1.html#cb253-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-28"><a href="principal-component-analysis-1.html#cb253-28" aria-hidden="true" tabindex="-1"></a>?USArrests               <span class="co"># Violent Crime Rates by US State</span></span>
<span id="cb253-29"><a href="principal-component-analysis-1.html#cb253-29" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(USArrests)</span>
<span id="cb253-30"><a href="principal-component-analysis-1.html#cb253-30" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(USArrests)</span>
<span id="cb253-31"><a href="principal-component-analysis-1.html#cb253-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-32"><a href="principal-component-analysis-1.html#cb253-32" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(USArrests,<span class="dv">2</span>,mean)   <span class="co"># finding mean of all </span></span>
<span id="cb253-33"><a href="principal-component-analysis-1.html#cb253-33" aria-hidden="true" tabindex="-1"></a><span class="co"># big variance between samples, need to standartize</span></span>
<span id="cb253-34"><a href="principal-component-analysis-1.html#cb253-34" aria-hidden="true" tabindex="-1"></a>pca.out<span class="ot">&lt;-</span><span class="fu">prcomp</span>(USArrests,<span class="at">scale=</span><span class="cn">TRUE</span>)</span>
<span id="cb253-35"><a href="principal-component-analysis-1.html#cb253-35" aria-hidden="true" tabindex="-1"></a>pca.out</span>
<span id="cb253-36"><a href="principal-component-analysis-1.html#cb253-36" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca.out)</span>
<span id="cb253-37"><a href="principal-component-analysis-1.html#cb253-37" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pca.out)</span>
<span id="cb253-38"><a href="principal-component-analysis-1.html#cb253-38" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pca.out,<span class="at">scale =</span> <span class="dv">0</span>, <span class="at">cex=</span><span class="fl">0.65</span>)</span></code></pre></div>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="principal-component-analysis-1.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Principal component analysis</span></span>
<span id="cb254-2"><a href="principal-component-analysis-1.html#cb254-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-3"><a href="principal-component-analysis-1.html#cb254-3" aria-hidden="true" tabindex="-1"></a>states<span class="ot">=</span><span class="fu">row.names</span>(USArrests)</span>
<span id="cb254-4"><a href="principal-component-analysis-1.html#cb254-4" aria-hidden="true" tabindex="-1"></a>states</span>
<span id="cb254-5"><a href="principal-component-analysis-1.html#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(USArrests)</span>
<span id="cb254-6"><a href="principal-component-analysis-1.html#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(USArrests, <span class="dv">2</span>, mean)</span>
<span id="cb254-7"><a href="principal-component-analysis-1.html#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(USArrests, <span class="dv">2</span>, var)</span>
<span id="cb254-8"><a href="principal-component-analysis-1.html#cb254-8" aria-hidden="true" tabindex="-1"></a>pr.out<span class="ot">=</span><span class="fu">prcomp</span>(USArrests, <span class="at">scale=</span><span class="cn">TRUE</span>)</span>
<span id="cb254-9"><a href="principal-component-analysis-1.html#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pr.out)</span>
<span id="cb254-10"><a href="principal-component-analysis-1.html#cb254-10" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>center</span>
<span id="cb254-11"><a href="principal-component-analysis-1.html#cb254-11" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>scale</span>
<span id="cb254-12"><a href="principal-component-analysis-1.html#cb254-12" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>rotation</span>
<span id="cb254-13"><a href="principal-component-analysis-1.html#cb254-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pr.out<span class="sc">$</span>x)</span>
<span id="cb254-14"><a href="principal-component-analysis-1.html#cb254-14" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pr.out, <span class="at">scale=</span><span class="dv">0</span>)</span>
<span id="cb254-15"><a href="principal-component-analysis-1.html#cb254-15" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>rotation<span class="ot">=</span><span class="sc">-</span>pr.out<span class="sc">$</span>rotation</span>
<span id="cb254-16"><a href="principal-component-analysis-1.html#cb254-16" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>x<span class="ot">=</span><span class="sc">-</span>pr.out<span class="sc">$</span>x</span>
<span id="cb254-17"><a href="principal-component-analysis-1.html#cb254-17" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pr.out, <span class="at">scale=</span><span class="dv">0</span>)</span>
<span id="cb254-18"><a href="principal-component-analysis-1.html#cb254-18" aria-hidden="true" tabindex="-1"></a>pr.out<span class="sc">$</span>sdev</span>
<span id="cb254-19"><a href="principal-component-analysis-1.html#cb254-19" aria-hidden="true" tabindex="-1"></a>pr.var<span class="ot">=</span>pr.out<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb254-20"><a href="principal-component-analysis-1.html#cb254-20" aria-hidden="true" tabindex="-1"></a>pr.var</span>
<span id="cb254-21"><a href="principal-component-analysis-1.html#cb254-21" aria-hidden="true" tabindex="-1"></a>pve<span class="ot">=</span>pr.var<span class="sc">/</span><span class="fu">sum</span>(pr.var)</span>
<span id="cb254-22"><a href="principal-component-analysis-1.html#cb254-22" aria-hidden="true" tabindex="-1"></a>pve</span>
<span id="cb254-23"><a href="principal-component-analysis-1.html#cb254-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pve, <span class="at">xlab=</span><span class="st">&quot;Principal Component&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Proportion of Variance Explained&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb254-24"><a href="principal-component-analysis-1.html#cb254-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cumsum</span>(pve), <span class="at">xlab=</span><span class="st">&quot;Principal Component&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Cumulative Proportion of Variance Explained&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb254-25"><a href="principal-component-analysis-1.html#cb254-25" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">8</span>,<span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb254-26"><a href="principal-component-analysis-1.html#cb254-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cumsum</span>(a)</span>
<span id="cb254-27"><a href="principal-component-analysis-1.html#cb254-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-28"><a href="principal-component-analysis-1.html#cb254-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-29"><a href="principal-component-analysis-1.html#cb254-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Лабораторная работа 2 к главе 10: Кластеризация</span></span>
<span id="cb254-30"><a href="principal-component-analysis-1.html#cb254-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-31"><a href="principal-component-analysis-1.html#cb254-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Кластеризация по методу К средних</span></span>
<span id="cb254-32"><a href="principal-component-analysis-1.html#cb254-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-33"><a href="principal-component-analysis-1.html#cb254-33" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb254-34"><a href="principal-component-analysis-1.html#cb254-34" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">50</span><span class="sc">*</span><span class="dv">2</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb254-35"><a href="principal-component-analysis-1.html#cb254-35" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">1</span>]<span class="ot">=</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">1</span>]<span class="sc">+</span><span class="dv">3</span></span>
<span id="cb254-36"><a href="principal-component-analysis-1.html#cb254-36" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">2</span>]<span class="ot">=</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">2</span>]<span class="sc">-</span><span class="dv">4</span></span>
<span id="cb254-37"><a href="principal-component-analysis-1.html#cb254-37" aria-hidden="true" tabindex="-1"></a>km.out<span class="ot">=</span><span class="fu">kmeans</span>(x,<span class="dv">2</span>,<span class="at">nstart=</span><span class="dv">20</span>)</span>
<span id="cb254-38"><a href="principal-component-analysis-1.html#cb254-38" aria-hidden="true" tabindex="-1"></a>km.out<span class="sc">$</span>cluster</span>
<span id="cb254-39"><a href="principal-component-analysis-1.html#cb254-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>(km.out<span class="sc">$</span>cluster<span class="sc">+</span><span class="dv">1</span>), <span class="at">main=</span><span class="st">&quot;K-Means Clustering Results with K=2&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb254-40"><a href="principal-component-analysis-1.html#cb254-40" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb254-41"><a href="principal-component-analysis-1.html#cb254-41" aria-hidden="true" tabindex="-1"></a>km.out<span class="ot">=</span><span class="fu">kmeans</span>(x,<span class="dv">3</span>,<span class="at">nstart=</span><span class="dv">20</span>)</span>
<span id="cb254-42"><a href="principal-component-analysis-1.html#cb254-42" aria-hidden="true" tabindex="-1"></a>km.out</span>
<span id="cb254-43"><a href="principal-component-analysis-1.html#cb254-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>(km.out<span class="sc">$</span>cluster<span class="sc">+</span><span class="dv">1</span>), <span class="at">main=</span><span class="st">&quot;K-Means Clustering Results with K=3&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb254-44"><a href="principal-component-analysis-1.html#cb254-44" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb254-45"><a href="principal-component-analysis-1.html#cb254-45" aria-hidden="true" tabindex="-1"></a>km.out<span class="ot">=</span><span class="fu">kmeans</span>(x,<span class="dv">3</span>,<span class="at">nstart=</span><span class="dv">1</span>)</span>
<span id="cb254-46"><a href="principal-component-analysis-1.html#cb254-46" aria-hidden="true" tabindex="-1"></a>km.out<span class="sc">$</span>tot.withinss</span>
<span id="cb254-47"><a href="principal-component-analysis-1.html#cb254-47" aria-hidden="true" tabindex="-1"></a>km.out<span class="ot">=</span><span class="fu">kmeans</span>(x,<span class="dv">3</span>,<span class="at">nstart=</span><span class="dv">20</span>)</span>
<span id="cb254-48"><a href="principal-component-analysis-1.html#cb254-48" aria-hidden="true" tabindex="-1"></a>km.out<span class="sc">$</span>tot.withinss</span>
<span id="cb254-49"><a href="principal-component-analysis-1.html#cb254-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-50"><a href="principal-component-analysis-1.html#cb254-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Иерархическая кластеризация</span></span>
<span id="cb254-51"><a href="principal-component-analysis-1.html#cb254-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-52"><a href="principal-component-analysis-1.html#cb254-52" aria-hidden="true" tabindex="-1"></a>hc.complete<span class="ot">=</span><span class="fu">hclust</span>(<span class="fu">dist</span>(x), <span class="at">method=</span><span class="st">&quot;complete&quot;</span>)</span>
<span id="cb254-53"><a href="principal-component-analysis-1.html#cb254-53" aria-hidden="true" tabindex="-1"></a>hc.average<span class="ot">=</span><span class="fu">hclust</span>(<span class="fu">dist</span>(x), <span class="at">method=</span><span class="st">&quot;average&quot;</span>)</span>
<span id="cb254-54"><a href="principal-component-analysis-1.html#cb254-54" aria-hidden="true" tabindex="-1"></a>hc.single<span class="ot">=</span><span class="fu">hclust</span>(<span class="fu">dist</span>(x), <span class="at">method=</span><span class="st">&quot;single&quot;</span>)</span>
<span id="cb254-55"><a href="principal-component-analysis-1.html#cb254-55" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb254-56"><a href="principal-component-analysis-1.html#cb254-56" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc.complete,<span class="at">main=</span><span class="st">&quot;Complete Linkage&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">sub=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">9</span>)</span>
<span id="cb254-57"><a href="principal-component-analysis-1.html#cb254-57" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc.average, <span class="at">main=</span><span class="st">&quot;Average Linkage&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">sub=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">9</span>)</span>
<span id="cb254-58"><a href="principal-component-analysis-1.html#cb254-58" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc.single, <span class="at">main=</span><span class="st">&quot;Single Linkage&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">sub=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">9</span>)</span>
<span id="cb254-59"><a href="principal-component-analysis-1.html#cb254-59" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(hc.complete, <span class="dv">2</span>)</span>
<span id="cb254-60"><a href="principal-component-analysis-1.html#cb254-60" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(hc.average, <span class="dv">2</span>)</span>
<span id="cb254-61"><a href="principal-component-analysis-1.html#cb254-61" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(hc.single, <span class="dv">2</span>)</span>
<span id="cb254-62"><a href="principal-component-analysis-1.html#cb254-62" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(hc.single, <span class="dv">4</span>)</span>
<span id="cb254-63"><a href="principal-component-analysis-1.html#cb254-63" aria-hidden="true" tabindex="-1"></a>xsc<span class="ot">=</span><span class="fu">scale</span>(x)</span>
<span id="cb254-64"><a href="principal-component-analysis-1.html#cb254-64" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(<span class="fu">dist</span>(xsc), <span class="at">method=</span><span class="st">&quot;complete&quot;</span>), <span class="at">main=</span><span class="st">&quot;Hierarchical Clustering with Scaled Features&quot;</span>)</span>
<span id="cb254-65"><a href="principal-component-analysis-1.html#cb254-65" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">30</span><span class="sc">*</span><span class="dv">3</span>), <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb254-66"><a href="principal-component-analysis-1.html#cb254-66" aria-hidden="true" tabindex="-1"></a>dd<span class="ot">=</span><span class="fu">as.dist</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">cor</span>(<span class="fu">t</span>(x)))</span>
<span id="cb254-67"><a href="principal-component-analysis-1.html#cb254-67" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(dd, <span class="at">method=</span><span class="st">&quot;complete&quot;</span>), <span class="at">main=</span><span class="st">&quot;Complete Linkage with Correlation-Based Distance&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">sub=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb254-68"><a href="principal-component-analysis-1.html#cb254-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-69"><a href="principal-component-analysis-1.html#cb254-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-70"><a href="principal-component-analysis-1.html#cb254-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Лабораторная работа 3 к главе 10: Анализ данных NCI60</span></span>
<span id="cb254-71"><a href="principal-component-analysis-1.html#cb254-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-72"><a href="principal-component-analysis-1.html#cb254-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Данные NCI60</span></span>
<span id="cb254-73"><a href="principal-component-analysis-1.html#cb254-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-74"><a href="principal-component-analysis-1.html#cb254-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb254-75"><a href="principal-component-analysis-1.html#cb254-75" aria-hidden="true" tabindex="-1"></a>nci.labs<span class="ot">=</span>NCI60<span class="sc">$</span>labs</span>
<span id="cb254-76"><a href="principal-component-analysis-1.html#cb254-76" aria-hidden="true" tabindex="-1"></a>nci.data<span class="ot">=</span>NCI60<span class="sc">$</span>data</span>
<span id="cb254-77"><a href="principal-component-analysis-1.html#cb254-77" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(nci.data)</span>
<span id="cb254-78"><a href="principal-component-analysis-1.html#cb254-78" aria-hidden="true" tabindex="-1"></a>nci.labs[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb254-79"><a href="principal-component-analysis-1.html#cb254-79" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(nci.labs)</span>
<span id="cb254-80"><a href="principal-component-analysis-1.html#cb254-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-81"><a href="principal-component-analysis-1.html#cb254-81" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA в приложении к данным NCI60</span></span>
<span id="cb254-82"><a href="principal-component-analysis-1.html#cb254-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-83"><a href="principal-component-analysis-1.html#cb254-83" aria-hidden="true" tabindex="-1"></a>pr.out<span class="ot">=</span><span class="fu">prcomp</span>(nci.data, <span class="at">scale=</span><span class="cn">TRUE</span>)</span>
<span id="cb254-84"><a href="principal-component-analysis-1.html#cb254-84" aria-hidden="true" tabindex="-1"></a>Cols<span class="ot">=</span><span class="cf">function</span>(vec){</span>
<span id="cb254-85"><a href="principal-component-analysis-1.html#cb254-85" aria-hidden="true" tabindex="-1"></a>    cols<span class="ot">=</span><span class="fu">rainbow</span>(<span class="fu">length</span>(<span class="fu">unique</span>(vec)))</span>
<span id="cb254-86"><a href="principal-component-analysis-1.html#cb254-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(vec))])</span>
<span id="cb254-87"><a href="principal-component-analysis-1.html#cb254-87" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb254-88"><a href="principal-component-analysis-1.html#cb254-88" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb254-89"><a href="principal-component-analysis-1.html#cb254-89" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pr.out<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col=</span><span class="fu">Cols</span>(nci.labs), <span class="at">pch=</span><span class="dv">19</span>,<span class="at">xlab=</span><span class="st">&quot;Z1&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Z2&quot;</span>)</span>
<span id="cb254-90"><a href="principal-component-analysis-1.html#cb254-90" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pr.out<span class="sc">$</span>x[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)], <span class="at">col=</span><span class="fu">Cols</span>(nci.labs), <span class="at">pch=</span><span class="dv">19</span>,<span class="at">xlab=</span><span class="st">&quot;Z1&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Z3&quot;</span>)</span>
<span id="cb254-91"><a href="principal-component-analysis-1.html#cb254-91" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pr.out)</span>
<span id="cb254-92"><a href="principal-component-analysis-1.html#cb254-92" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pr.out)</span>
<span id="cb254-93"><a href="principal-component-analysis-1.html#cb254-93" aria-hidden="true" tabindex="-1"></a>pve<span class="ot">=</span><span class="dv">100</span><span class="sc">*</span>pr.out<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sum</span>(pr.out<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb254-94"><a href="principal-component-analysis-1.html#cb254-94" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb254-95"><a href="principal-component-analysis-1.html#cb254-95" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pve,  <span class="at">type=</span><span class="st">&quot;o&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PVE&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Principal Component&quot;</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb254-96"><a href="principal-component-analysis-1.html#cb254-96" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cumsum</span>(pve), <span class="at">type=</span><span class="st">&quot;o&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Cumulative PVE&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Principal Component&quot;</span>, <span class="at">col=</span><span class="st">&quot;brown3&quot;</span>)</span>
<span id="cb254-97"><a href="principal-component-analysis-1.html#cb254-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-98"><a href="principal-component-analysis-1.html#cb254-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Кластеризация наблюдений из нобора данных NCI60</span></span>
<span id="cb254-99"><a href="principal-component-analysis-1.html#cb254-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-100"><a href="principal-component-analysis-1.html#cb254-100" aria-hidden="true" tabindex="-1"></a>sd.data<span class="ot">=</span><span class="fu">scale</span>(nci.data)</span>
<span id="cb254-101"><a href="principal-component-analysis-1.html#cb254-101" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb254-102"><a href="principal-component-analysis-1.html#cb254-102" aria-hidden="true" tabindex="-1"></a>data.dist<span class="ot">=</span><span class="fu">dist</span>(sd.data)</span>
<span id="cb254-103"><a href="principal-component-analysis-1.html#cb254-103" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(data.dist), <span class="at">labels=</span>nci.labs, <span class="at">main=</span><span class="st">&quot;Complete Linkage&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">sub=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb254-104"><a href="principal-component-analysis-1.html#cb254-104" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(data.dist, <span class="at">method=</span><span class="st">&quot;average&quot;</span>), <span class="at">labels=</span>nci.labs, <span class="at">main=</span><span class="st">&quot;Average Linkage&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">sub=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb254-105"><a href="principal-component-analysis-1.html#cb254-105" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(data.dist, <span class="at">method=</span><span class="st">&quot;single&quot;</span>), <span class="at">labels=</span>nci.labs,  <span class="at">main=</span><span class="st">&quot;Single Linkage&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">sub=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb254-106"><a href="principal-component-analysis-1.html#cb254-106" aria-hidden="true" tabindex="-1"></a>hc.out<span class="ot">=</span><span class="fu">hclust</span>(<span class="fu">dist</span>(sd.data))</span>
<span id="cb254-107"><a href="principal-component-analysis-1.html#cb254-107" aria-hidden="true" tabindex="-1"></a>hc.clusters<span class="ot">=</span><span class="fu">cutree</span>(hc.out,<span class="dv">4</span>)</span>
<span id="cb254-108"><a href="principal-component-analysis-1.html#cb254-108" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(hc.clusters,nci.labs)</span>
<span id="cb254-109"><a href="principal-component-analysis-1.html#cb254-109" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb254-110"><a href="principal-component-analysis-1.html#cb254-110" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc.out, <span class="at">labels=</span>nci.labs)</span>
<span id="cb254-111"><a href="principal-component-analysis-1.html#cb254-111" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">139</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb254-112"><a href="principal-component-analysis-1.html#cb254-112" aria-hidden="true" tabindex="-1"></a>hc.out</span>
<span id="cb254-113"><a href="principal-component-analysis-1.html#cb254-113" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb254-114"><a href="principal-component-analysis-1.html#cb254-114" aria-hidden="true" tabindex="-1"></a>km.out<span class="ot">=</span><span class="fu">kmeans</span>(sd.data, <span class="dv">4</span>, <span class="at">nstart=</span><span class="dv">20</span>)</span>
<span id="cb254-115"><a href="principal-component-analysis-1.html#cb254-115" aria-hidden="true" tabindex="-1"></a>km.clusters<span class="ot">=</span>km.out<span class="sc">$</span>cluster</span>
<span id="cb254-116"><a href="principal-component-analysis-1.html#cb254-116" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(km.clusters,hc.clusters)</span>
<span id="cb254-117"><a href="principal-component-analysis-1.html#cb254-117" aria-hidden="true" tabindex="-1"></a>hc.out<span class="ot">=</span><span class="fu">hclust</span>(<span class="fu">dist</span>(pr.out<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]))</span>
<span id="cb254-118"><a href="principal-component-analysis-1.html#cb254-118" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc.out, <span class="at">labels=</span>nci.labs, <span class="at">main=</span><span class="st">&quot;Hier. Clust. on First Five Score Vectors&quot;</span>)</span>
<span id="cb254-119"><a href="principal-component-analysis-1.html#cb254-119" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">cutree</span>(hc.out,<span class="dv">4</span>), nci.labs)</span></code></pre></div>

<div id="t-sne---stochastic-neighbor-embedding" class="section level3" number="38.2.1">
<h3><span class="header-section-number">38.2.1</span> t-SNE - Stochastic Neighbor Embedding</h3>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="principal-component-analysis-1.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rtsne)</span>
<span id="cb255-2"><a href="principal-component-analysis-1.html#cb255-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-3"><a href="principal-component-analysis-1.html#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data loading</span></span>
<span id="cb255-4"><a href="principal-component-analysis-1.html#cb255-4" aria-hidden="true" tabindex="-1"></a>train<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;~/github/dar/012_t-SNE/DATA/train.csv&quot;</span>)</span>
<span id="cb255-5"><a href="principal-component-analysis-1.html#cb255-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-6"><a href="principal-component-analysis-1.html#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(train)[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb255-7"><a href="principal-component-analysis-1.html#cb255-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(train)</span>
<span id="cb255-8"><a href="principal-component-analysis-1.html#cb255-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-9"><a href="principal-component-analysis-1.html#cb255-9" aria-hidden="true" tabindex="-1"></a><span class="do">## get labels as factors</span></span>
<span id="cb255-10"><a href="principal-component-analysis-1.html#cb255-10" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> train<span class="sc">$</span>label</span>
<span id="cb255-11"><a href="principal-component-analysis-1.html#cb255-11" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>label<span class="ot">&lt;-</span><span class="fu">as.factor</span>(train<span class="sc">$</span>label)</span>
<span id="cb255-12"><a href="principal-component-analysis-1.html#cb255-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-13"><a href="principal-component-analysis-1.html#cb255-13" aria-hidden="true" tabindex="-1"></a><span class="do">## for plotting</span></span>
<span id="cb255-14"><a href="principal-component-analysis-1.html#cb255-14" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">=</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(<span class="fu">unique</span>(train<span class="sc">$</span>label)))</span>
<span id="cb255-15"><a href="principal-component-analysis-1.html#cb255-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(colors) <span class="ot">=</span> <span class="fu">unique</span>(train<span class="sc">$</span>label)</span>
<span id="cb255-16"><a href="principal-component-analysis-1.html#cb255-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-17"><a href="principal-component-analysis-1.html#cb255-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Executing the algorithm on curated data</span></span>
<span id="cb255-18"><a href="principal-component-analysis-1.html#cb255-18" aria-hidden="true" tabindex="-1"></a>tsne <span class="ot">&lt;-</span> <span class="fu">Rtsne</span>(train[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">dims =</span> <span class="dv">2</span>, <span class="at">perplexity=</span><span class="dv">30</span>, <span class="at">verbose=</span><span class="cn">TRUE</span>, <span class="at">max_iter =</span> <span class="dv">500</span>)</span>
<span id="cb255-19"><a href="principal-component-analysis-1.html#cb255-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-20"><a href="principal-component-analysis-1.html#cb255-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Execution time</span></span>
<span id="cb255-21"><a href="principal-component-analysis-1.html#cb255-21" aria-hidden="true" tabindex="-1"></a>exeTimeTsne<span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">Rtsne</span>(train[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">dims =</span> <span class="dv">2</span>, <span class="at">perplexity=</span><span class="dv">30</span>, <span class="at">verbose=</span><span class="cn">TRUE</span>, <span class="at">max_iter =</span> <span class="dv">500</span>))</span>
<span id="cb255-22"><a href="principal-component-analysis-1.html#cb255-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-23"><a href="principal-component-analysis-1.html#cb255-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting</span></span>
<span id="cb255-24"><a href="principal-component-analysis-1.html#cb255-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tsne<span class="sc">$</span>Y, <span class="at">t=</span><span class="st">&#39;n&#39;</span>, <span class="at">main=</span><span class="st">&quot;tsne&quot;</span>)</span>
<span id="cb255-25"><a href="principal-component-analysis-1.html#cb255-25" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(tsne<span class="sc">$</span>Y, <span class="at">labels=</span>train<span class="sc">$</span>label, <span class="at">col=</span>colors[train<span class="sc">$</span>label])</span></code></pre></div>
<p><strong>Sources</strong></p>
<p><a href="https://www.analyticsvidhya.com/blog/2017/01/t-sne-implementation-r-python/" class="uri">https://www.analyticsvidhya.com/blog/2017/01/t-sne-implementation-r-python/</a></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="principal-component-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="learning-vector-quantization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/44_pca.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
