<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 45 Bayesian inference | R statistics</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 45 Bayesian inference | R statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 45 Bayesian inference | R statistics" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Mark Goldberg" />


<meta name="date" content="2021-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-markov-process.html"/>
<link rel="next" href="naive-bayes-classifiers.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html"><i class="fa fa-check"></i><b>2</b> Statistics R functions reference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#get-data"><i class="fa fa-check"></i><b>2.1</b> Get data</a></li>
<li class="chapter" data-level="2.2" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#data-inspection"><i class="fa fa-check"></i><b>2.2</b> Data inspection</a></li>
<li class="chapter" data-level="2.3" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#plots"><i class="fa fa-check"></i><b>2.3</b> Plots</a></li>
<li class="chapter" data-level="2.4" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#analysis-of-the-distribution"><i class="fa fa-check"></i><b>2.4</b> Analysis of the distribution</a></li>
<li class="chapter" data-level="2.5" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#distributions"><i class="fa fa-check"></i><b>2.5</b> Distributions</a></li>
<li class="chapter" data-level="2.6" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#t-test"><i class="fa fa-check"></i><b>2.6</b> t-Test</a></li>
<li class="chapter" data-level="2.7" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#anova"><i class="fa fa-check"></i><b>2.7</b> ANOVA</a></li>
<li class="chapter" data-level="2.8" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#machine-learning-functions-reference"><i class="fa fa-check"></i><b>2.8</b> Machine Learning Functions Reference</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#linear-regression"><i class="fa fa-check"></i><b>2.8.1</b> Linear Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="combinatorics.html"><a href="combinatorics.html"><i class="fa fa-check"></i><b>3</b> Combinatorics</a></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Probability</a></li>
<li class="chapter" data-level="5" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>5</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="basic-statistics.html"><a href="basic-statistics.html#definitions"><i class="fa fa-check"></i><b>5.1</b> Definitions</a></li>
<li class="chapter" data-level="5.2" data-path="basic-statistics.html"><a href="basic-statistics.html#probability-1"><i class="fa fa-check"></i><b>5.2</b> Probability</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-distributions.html"><a href="statistical-distributions.html"><i class="fa fa-check"></i><b>6</b> Statistical distributions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistical-distributions.html"><a href="statistical-distributions.html#normal-distribution"><i class="fa fa-check"></i><b>6.1</b> Normal Distribution</a></li>
<li class="chapter" data-level="6.2" data-path="statistical-distributions.html"><a href="statistical-distributions.html#bernoulli-distribution"><i class="fa fa-check"></i><b>6.2</b> Bernoulli Distribution</a></li>
<li class="chapter" data-level="6.3" data-path="statistical-distributions.html"><a href="statistical-distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>6.3</b> Binomial Distribution</a></li>
<li class="chapter" data-level="6.4" data-path="statistical-distributions.html"><a href="statistical-distributions.html#beta-distribution"><i class="fa fa-check"></i><b>6.4</b> Beta distribution</a></li>
<li class="chapter" data-level="6.5" data-path="statistical-distributions.html"><a href="statistical-distributions.html#geometric-distribution"><i class="fa fa-check"></i><b>6.5</b> Geometric Distribution</a></li>
<li class="chapter" data-level="6.6" data-path="statistical-distributions.html"><a href="statistical-distributions.html#uniform-distributions"><i class="fa fa-check"></i><b>6.6</b> Uniform Distributions</a></li>
<li class="chapter" data-level="6.7" data-path="statistical-distributions.html"><a href="statistical-distributions.html#poisson-distribution"><i class="fa fa-check"></i><b>6.7</b> Poisson Distribution</a></li>
<li class="chapter" data-level="6.8" data-path="statistical-distributions.html"><a href="statistical-distributions.html#exponential-distribution"><i class="fa fa-check"></i><b>6.8</b> Exponential Distribution</a></li>
<li class="chapter" data-level="6.9" data-path="statistical-distributions.html"><a href="statistical-distributions.html#chi-squared-distribution"><i class="fa fa-check"></i><b>6.9</b> Chi-squared Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html"><i class="fa fa-check"></i><b>7</b> Primary data analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#analysis-of-sample-distribution"><i class="fa fa-check"></i><b>7.1</b> Analysis of sample distribution</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#histogram"><i class="fa fa-check"></i><b>7.1.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#handling-missing-data"><i class="fa fa-check"></i><b>7.2</b> Handling missing data</a></li>
<li class="chapter" data-level="7.3" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#dealing-with-outliers"><i class="fa fa-check"></i><b>7.3</b> Dealing with outliers</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-normalization.html"><a href="data-normalization.html"><i class="fa fa-check"></i><b>8</b> Data normalization</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-normalization.html"><a href="data-normalization.html#normality-test"><i class="fa fa-check"></i><b>8.1</b> Normality test</a></li>
<li class="chapter" data-level="8.2" data-path="data-normalization.html"><a href="data-normalization.html#finding-confidence-intervals"><i class="fa fa-check"></i><b>8.2</b> Finding Confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="primary-data-analysis-case-studies.html"><a href="primary-data-analysis-case-studies.html"><i class="fa fa-check"></i><b>9</b> Primary data analysis - Case studies</a></li>
<li class="chapter" data-level="10" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>10</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-theory"><i class="fa fa-check"></i><b>10.1</b> Hypothesis testing theory</a></li>
<li class="chapter" data-level="10.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-test-practice"><i class="fa fa-check"></i><b>10.2</b> Hypothesis test (Practice)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="t-procedures.html"><a href="t-procedures.html"><i class="fa fa-check"></i><b>11</b> t-Procedures</a>
<ul>
<li class="chapter" data-level="11.1" data-path="t-procedures.html"><a href="t-procedures.html#t-test-and-normal-distribution"><i class="fa fa-check"></i><b>11.1</b> t-test and normal distribution</a></li>
<li class="chapter" data-level="11.2" data-path="t-procedures.html"><a href="t-procedures.html#one-sample-t-test"><i class="fa fa-check"></i><b>11.2</b> One-sample t-test</a></li>
<li class="chapter" data-level="11.3" data-path="t-procedures.html"><a href="t-procedures.html#practical-example-t-test-in-r"><i class="fa fa-check"></i><b>11.3</b> Practical example: t-test in R</a></li>
<li class="chapter" data-level="11.4" data-path="t-procedures.html"><a href="t-procedures.html#two-samples-t-test"><i class="fa fa-check"></i><b>11.4</b> Two samples t-test</a></li>
<li class="chapter" data-level="11.5" data-path="t-procedures.html"><a href="t-procedures.html#compare-students-t-and-normal-distributions"><i class="fa fa-check"></i><b>11.5</b> Compare Student’s t and normal distributions</a></li>
<li class="chapter" data-level="11.6" data-path="t-procedures.html"><a href="t-procedures.html#non-parametric-tests"><i class="fa fa-check"></i><b>11.6</b> Non-parametric tests</a></li>
<li class="chapter" data-level="11.7" data-path="t-procedures.html"><a href="t-procedures.html#mann-whitney-u-rank-sum-test"><i class="fa fa-check"></i><b>11.7</b> Mann-Whitney U Rank Sum Test</a></li>
<li class="chapter" data-level="11.8" data-path="t-procedures.html"><a href="t-procedures.html#wilcoxon-test"><i class="fa fa-check"></i><b>11.8</b> Wilcoxon test</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="tests-for-categorical-variables.html"><a href="tests-for-categorical-variables.html"><i class="fa fa-check"></i><b>12</b> Tests for categorical variables</a>
<ul>
<li class="chapter" data-level="12.1" data-path="tests-for-categorical-variables.html"><a href="tests-for-categorical-variables.html#chi-squared-tests"><i class="fa fa-check"></i><b>12.1</b> Chi-squared tests</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multiple-testing.html"><a href="multiple-testing.html"><i class="fa fa-check"></i><b>13</b> Multiple testing</a>
<ul>
<li class="chapter" data-level="13.1" data-path="multiple-testing.html"><a href="multiple-testing.html#the-bonferroni-correction"><i class="fa fa-check"></i><b>13.1</b> The Bonferroni correction</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sources.html"><a href="sources.html"><i class="fa fa-check"></i><b>14</b> Sources</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sources.html"><a href="sources.html#t-test-1"><i class="fa fa-check"></i><b>14.1</b> t-test</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="sources.html"><a href="sources.html#two-tailed-test"><i class="fa fa-check"></i><b>14.1.1</b> Two-tailed test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="wilcoxon-signed-rank-test.html"><a href="wilcoxon-signed-rank-test.html"><i class="fa fa-check"></i><b>15</b> Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="16" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>16</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="16.1" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html#one-way-anova"><i class="fa fa-check"></i><b>16.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="16.2" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html#sources-1"><i class="fa fa-check"></i><b>16.2</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="t-test-anova-difference.html"><a href="t-test-anova-difference.html"><i class="fa fa-check"></i><b>17</b> t-test ANOVA difference</a></li>
<li class="chapter" data-level="18" data-path="chi-squared-test.html"><a href="chi-squared-test.html"><i class="fa fa-check"></i><b>18</b> Chi-squared test</a>
<ul>
<li class="chapter" data-level="18.1" data-path="chi-squared-test.html"><a href="chi-squared-test.html#multinomial-goodness-of-fit"><i class="fa fa-check"></i><b>18.1</b> Multinomial Goodness of Fit</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html"><i class="fa fa-check"></i><b>19</b> Non-parametric Methods</a>
<ul>
<li class="chapter" data-level="19.1" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#sign-test"><i class="fa fa-check"></i><b>19.1</b> Sign Test</a></li>
<li class="chapter" data-level="19.2" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#wilcoxon-signed-rank-test-1"><i class="fa fa-check"></i><b>19.2</b> Wilcoxon Signed-Rank Test</a></li>
<li class="chapter" data-level="19.3" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#mann-whitney-wilcoxon-test"><i class="fa fa-check"></i><b>19.3</b> Mann-Whitney-Wilcoxon Test</a></li>
<li class="chapter" data-level="19.4" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>19.4</b> Kruskal-Wallis Test</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>20</b> Correlation</a></li>
<li class="chapter" data-level="21" data-path="methods-and-algorithms-of-machine-learning.html"><a href="methods-and-algorithms-of-machine-learning.html"><i class="fa fa-check"></i><b>21</b> Methods and algorithms of machine learning</a></li>
<li class="chapter" data-level="22" data-path="split-data-into-train-and-test-subsets.html"><a href="split-data-into-train-and-test-subsets.html"><i class="fa fa-check"></i><b>22</b> Split data into train and test subsets</a></li>
<li class="chapter" data-level="23" data-path="estimate-model-accuracy.html"><a href="estimate-model-accuracy.html"><i class="fa fa-check"></i><b>23</b> Estimate model accuracy</a>
<ul>
<li class="chapter" data-level="23.1" data-path="estimate-model-accuracy.html"><a href="estimate-model-accuracy.html#continuous-variables"><i class="fa fa-check"></i><b>23.1</b> Continuous variables</a></li>
<li class="chapter" data-level="23.2" data-path="estimate-model-accuracy.html"><a href="estimate-model-accuracy.html#discret-variables"><i class="fa fa-check"></i><b>23.2</b> Discret variables</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="model-evaluation.html"><a href="model-evaluation.html"><i class="fa fa-check"></i><b>24</b> Model evaluation</a></li>
<li class="chapter" data-level="25" data-path="cross-validation-and-bootstrep.html"><a href="cross-validation-and-bootstrep.html"><i class="fa fa-check"></i><b>25</b> Cross-validation and Bootstrep</a></li>
<li class="chapter" data-level="26" data-path="linear-regression-1.html"><a href="linear-regression-1.html"><i class="fa fa-check"></i><b>26</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="26.1" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-regression---theory"><i class="fa fa-check"></i><b>26.1</b> Linear regression - theory</a></li>
<li class="chapter" data-level="26.2" data-path="linear-regression-1.html"><a href="linear-regression-1.html#generate-random-data-set-for-the-linear-model"><i class="fa fa-check"></i><b>26.2</b> Generate random data set for the linear model</a></li>
<li class="chapter" data-level="26.3" data-path="linear-regression-1.html"><a href="linear-regression-1.html#practical-example"><i class="fa fa-check"></i><b>26.3</b> Practical example</a></li>
<li class="chapter" data-level="26.4" data-path="linear-regression-1.html"><a href="linear-regression-1.html#mean-squared-error-mse"><i class="fa fa-check"></i><b>26.4</b> Mean squared error (MSE)</a></li>
<li class="chapter" data-level="26.5" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-model-in-r"><i class="fa fa-check"></i><b>26.5</b> Linear model in R</a></li>
<li class="chapter" data-level="26.6" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-regression-model-for-multiple-parameters"><i class="fa fa-check"></i><b>26.6</b> Linear regression model for multiple parameters</a></li>
<li class="chapter" data-level="26.7" data-path="linear-regression-1.html"><a href="linear-regression-1.html#choosing-explanatory-variables-for-the-model"><i class="fa fa-check"></i><b>26.7</b> Choosing explanatory variables for the model</a></li>
<li class="chapter" data-level="26.8" data-path="linear-regression-1.html"><a href="linear-regression-1.html#assessment-of-model-performance-for-categorical-data."><i class="fa fa-check"></i><b>26.8</b> Assessment of model performance for categorical data.</a></li>
<li class="chapter" data-level="26.9" data-path="linear-regression-1.html"><a href="linear-regression-1.html#confidence-intervals-for-linear-model"><i class="fa fa-check"></i><b>26.9</b> Confidence intervals for linear model</a></li>
<li class="chapter" data-level="26.10" data-path="linear-regression-1.html"><a href="linear-regression-1.html#practical-examples-for-linear-model-regression"><i class="fa fa-check"></i><b>26.10</b> Practical examples for linear model regression</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html"><i class="fa fa-check"></i><b>27</b> Linear regression complex cases</a>
<ul>
<li class="chapter" data-level="27.1" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#cars"><i class="fa fa-check"></i><b>27.1</b> Cars</a></li>
<li class="chapter" data-level="27.2" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#linear-regression-modeling-compair-with-knn"><i class="fa fa-check"></i><b>27.2</b> Linear regression modeling, compair with kNN</a></li>
<li class="chapter" data-level="27.3" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#more-complex-example"><i class="fa fa-check"></i><b>27.3</b> More complex example</a></li>
<li class="chapter" data-level="27.4" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#next-part"><i class="fa fa-check"></i><b>27.4</b> NEXT part</a></li>
<li class="chapter" data-level="27.5" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#next-part-1"><i class="fa fa-check"></i><b>27.5</b> NEXT Part</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>28</b> Nonlinear regression</a></li>
<li class="chapter" data-level="29" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>29</b> Multiple linear regression</a></li>
<li class="chapter" data-level="30" data-path="spline-model.html"><a href="spline-model.html"><i class="fa fa-check"></i><b>30</b> Spline model</a>
<ul>
<li class="chapter" data-level="30.1" data-path="spline-model.html"><a href="spline-model.html#splines"><i class="fa fa-check"></i><b>30.1</b> Splines</a></li>
<li class="chapter" data-level="30.2" data-path="spline-model.html"><a href="spline-model.html#area-under-the-curve-using-spline-method"><i class="fa fa-check"></i><b>30.2</b> Area under the curve using spline method</a></li>
<li class="chapter" data-level="30.3" data-path="spline-model.html"><a href="spline-model.html#set-data-using-given-function-and-predict-curve-using-spline-method"><i class="fa fa-check"></i><b>30.3</b> Set data using given function and predict curve using spline method</a></li>
<li class="chapter" data-level="30.4" data-path="spline-model.html"><a href="spline-model.html#generate-dataset-from-a-given-function"><i class="fa fa-check"></i><b>30.4</b> Generate dataset from a given function</a></li>
<li class="chapter" data-level="30.5" data-path="spline-model.html"><a href="spline-model.html#split-data-for-train-and-test"><i class="fa fa-check"></i><b>30.5</b> Split data for train and test</a></li>
<li class="chapter" data-level="30.6" data-path="spline-model.html"><a href="spline-model.html#diagram-of-the-given-function-and-generated-datasets"><i class="fa fa-check"></i><b>30.6</b> Diagram of the given function and generated datasets</a></li>
<li class="chapter" data-level="30.7" data-path="spline-model.html"><a href="spline-model.html#build-a-model-using-splines"><i class="fa fa-check"></i><b>30.7</b> Build a model using splines</a></li>
<li class="chapter" data-level="30.8" data-path="spline-model.html"><a href="spline-model.html#diagram-of-mse-for-train-and-test-data"><i class="fa fa-check"></i><b>30.8</b> Diagram of MSE for train and test data</a></li>
<li class="chapter" data-level="30.9" data-path="spline-model.html"><a href="spline-model.html#build-optimal-model-and-plot-for-the-model"><i class="fa fa-check"></i><b>30.9</b> Build optimal model and plot for the model</a></li>
<li class="chapter" data-level="30.10" data-path="spline-model.html"><a href="spline-model.html#bibliograpy"><i class="fa fa-check"></i><b>30.10</b> Bibliograpy</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>31</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="31.1" data-path="logistic-regression.html"><a href="logistic-regression.html#confusion-matrix"><i class="fa fa-check"></i><b>31.1</b> Confusion matrix</a></li>
<li class="chapter" data-level="31.2" data-path="logistic-regression.html"><a href="logistic-regression.html#next-part-2"><i class="fa fa-check"></i><b>31.2</b> Next part</a></li>
<li class="chapter" data-level="31.3" data-path="logistic-regression.html"><a href="logistic-regression.html#next-part-3"><i class="fa fa-check"></i><b>31.3</b> NExt part</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="models-for-binary-data.html"><a href="models-for-binary-data.html"><i class="fa fa-check"></i><b>32</b> Models for binary Data</a></li>
<li class="chapter" data-level="33" data-path="support-vector-machine.html"><a href="support-vector-machine.html"><i class="fa fa-check"></i><b>33</b> Support Vector Machine</a></li>
<li class="chapter" data-level="34" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>34</b> Clustering</a>
<ul>
<li class="chapter" data-level="34.1" data-path="clustering.html"><a href="clustering.html#finding-distances-using-factoextra"><i class="fa fa-check"></i><b>34.1</b> Finding distances using factoextra</a></li>
<li class="chapter" data-level="34.2" data-path="clustering.html"><a href="clustering.html#example-of-choosing-clustering-model"><i class="fa fa-check"></i><b>34.2</b> Example of choosing clustering model</a></li>
<li class="chapter" data-level="34.3" data-path="clustering.html"><a href="clustering.html#k-means-clustering"><i class="fa fa-check"></i><b>34.3</b> K-means clustering</a></li>
<li class="chapter" data-level="34.4" data-path="clustering.html"><a href="clustering.html#k-means"><i class="fa fa-check"></i><b>34.4</b> k-Means</a></li>
<li class="chapter" data-level="34.5" data-path="clustering.html"><a href="clustering.html#hierarchical-clustering"><i class="fa fa-check"></i><b>34.5</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="34.6" data-path="clustering.html"><a href="clustering.html#knn"><i class="fa fa-check"></i><b>34.6</b> KNN</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>35</b> Regularization</a></li>
<li class="chapter" data-level="36" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>36</b> Factor analysis</a></li>
<li class="chapter" data-level="37" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>37</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="38" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html"><i class="fa fa-check"></i><b>38</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="38.1" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html#basic-statistics-1"><i class="fa fa-check"></i><b>38.1</b> Basic statistics</a></li>
<li class="chapter" data-level="38.2" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html#basic-linear-algebra-matrices"><i class="fa fa-check"></i><b>38.2</b> Basic linear algebra (matrices)</a>
<ul>
<li class="chapter" data-level="38.2.1" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html#t-sne---stochastic-neighbor-embedding"><i class="fa fa-check"></i><b>38.2.1</b> t-SNE - Stochastic Neighbor Embedding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="39" data-path="learning-vector-quantization.html"><a href="learning-vector-quantization.html"><i class="fa fa-check"></i><b>39</b> Learning Vector Quantization</a></li>
<li class="chapter" data-level="40" data-path="tree-based-models.html"><a href="tree-based-models.html"><i class="fa fa-check"></i><b>40</b> Tree-based models</a>
<ul>
<li class="chapter" data-level="40.1" data-path="tree-based-models.html"><a href="tree-based-models.html#classification-tree-example"><i class="fa fa-check"></i><b>40.1</b> Classification Tree example</a></li>
<li class="chapter" data-level="40.2" data-path="tree-based-models.html"><a href="tree-based-models.html#regression-tree-example"><i class="fa fa-check"></i><b>40.2</b> Regression Tree example</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>41</b> Random forest</a></li>
<li class="chapter" data-level="42" data-path="gradient-boosted-trees.html"><a href="gradient-boosted-trees.html"><i class="fa fa-check"></i><b>42</b> Gradient boosted trees</a></li>
<li class="chapter" data-level="43" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>43</b> Markov Chain Monte Carlo (MCMC)</a></li>
<li class="chapter" data-level="44" data-path="simple-markov-process.html"><a href="simple-markov-process.html"><i class="fa fa-check"></i><b>44</b> Simple Markov process</a>
<ul>
<li class="chapter" data-level="44.0.1" data-path="simple-markov-process.html"><a href="simple-markov-process.html#sources-2"><i class="fa fa-check"></i><b>44.0.1</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="45" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>45</b> Bayesian inference</a>
<ul>
<li class="chapter" data-level="45.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#simple-model-with-one-binary-parameter"><i class="fa fa-check"></i><b>45.1</b> Simple model with one binary parameter</a></li>
<li class="chapter" data-level="45.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#grid-approximation"><i class="fa fa-check"></i><b>45.2</b> Grid approximation</a></li>
<li class="chapter" data-level="45.3" data-path="bayesian-inference.html"><a href="bayesian-inference.html#grid-approximation-1"><i class="fa fa-check"></i><b>45.3</b> Grid approximation</a></li>
<li class="chapter" data-level="45.4" data-path="bayesian-inference.html"><a href="bayesian-inference.html#model-of-birth-weights-using-normal-distribution"><i class="fa fa-check"></i><b>45.4</b> Model of birth weights using normal distribution</a></li>
<li class="chapter" data-level="45.5" data-path="bayesian-inference.html"><a href="bayesian-inference.html#a-bayesian-model-of-zombie-iq"><i class="fa fa-check"></i><b>45.5</b> A Bayesian model of Zombie IQ</a></li>
<li class="chapter" data-level="45.6" data-path="bayesian-inference.html"><a href="bayesian-inference.html#the-best-models"><i class="fa fa-check"></i><b>45.6</b> The BEST models</a></li>
</ul></li>
<li class="chapter" data-level="46" data-path="naive-bayes-classifiers.html"><a href="naive-bayes-classifiers.html"><i class="fa fa-check"></i><b>46</b> Naive Bayes classifiers</a></li>
<li class="chapter" data-level="47" data-path="modeling-with-r-caret.html"><a href="modeling-with-r-caret.html"><i class="fa fa-check"></i><b>47</b> Modeling with R caret</a></li>
<li class="chapter" data-level="48" data-path="modeling-with-r-tensorflow.html"><a href="modeling-with-r-tensorflow.html"><i class="fa fa-check"></i><b>48</b> Modeling with R Tensorflow</a></li>
<li class="chapter" data-level="49" data-path="perceptron.html"><a href="perceptron.html"><i class="fa fa-check"></i><b>49</b> Perceptron</a></li>
<li class="chapter" data-level="50" data-path="deeplearning-r-h2o.html"><a href="deeplearning-r-h2o.html"><i class="fa fa-check"></i><b>50</b> Deeplearning R H2O</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-inference" class="section level1" number="45">
<h1><span class="header-section-number">Chapter 45</span> Bayesian inference</h1>
<p><strong>Bayesian data analysis</strong> the use of Bayesian inference to learn from data.</p>
<p><strong>Bayesian inference</strong> is a method for figuring out unobservable quantities
given known facts that uses probability to describe the uncertainty over what
the values of the unknown quantities could be.</p>
<p><strong>Bayesian inference</strong> is conditioning on data, in order to learn about parameter values.</p>
<p><strong>Bayesian inference</strong> is a method of statistical inference in which Bayes’
theorem is used to update the probability for a hypothesis as more evidence or
information becomes available.</p>
<p><strong>Bayes’ theorem</strong><br />
<span class="math display">\[P( \theta | D ) = frac{P( D | \theta) \pdot P( \theta)}{\sum{P( D | \theta) \pdot P( \theta ) }}\]</span></p>
<p><span class="math inline">\(\theta\)</span> - Parameter values<br />
<span class="math inline">\(D\)</span> - New data<br />
<span class="math inline">\(P(D | \theta)\)</span> - Likelihood (the relative) probability of the data given different parameter value.<br />
<span class="math inline">\(P( \theta )\)</span> - Prior<br />
<span class="math inline">\(\sum{P( D | \theta) \pdot P( \theta ) }\)</span> - The total sum of the likelihod weighted by the prior.</p>
<ul>
<li>A <strong>prior</strong> is a probability distribution that represents what the model knows before seeing the data.<br />
</li>
<li>A <strong>posterior</strong> is a probability distribution that represents what the model knows after having seen the data.</li>
</ul>
<p><strong>Bayesian inference components</strong>:</p>
<ul>
<li>Data<br />
</li>
<li>Bayesian Model:<br />
</li>
<li>Generative model (<code>dbinom</code>, <code>dnorm</code>, <code>poisson</code> etc.)<br />
</li>
<li>Priors<br />
</li>
<li>Computational methods:<br />
</li>
<li>Rejection sampling<br />
</li>
<li>Grid approximation<br />
</li>
<li>Markov Chain Monte Carlo (MCMC)</li>
</ul>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="bayesian-inference.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization function of Bayesian inference for binary data </span></span>
<span id="cb285-2"><a href="bayesian-inference.html#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggjoy)</span>
<span id="cb285-3"><a href="bayesian-inference.html#cb285-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb285-4"><a href="bayesian-inference.html#cb285-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb285-5"><a href="bayesian-inference.html#cb285-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb285-6"><a href="bayesian-inference.html#cb285-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-7"><a href="bayesian-inference.html#cb285-7" aria-hidden="true" tabindex="-1"></a><span class="co"># prop_model function to visualize bayesian posterior distributions</span></span>
<span id="cb285-8"><a href="bayesian-inference.html#cb285-8" aria-hidden="true" tabindex="-1"></a>prop_model <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> <span class="fu">c</span>(), <span class="at">prior_prop =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">n_draws =</span> <span class="dv">10000</span>, <span class="at">show_plot =</span> <span class="cn">TRUE</span>) </span>
<span id="cb285-9"><a href="bayesian-inference.html#cb285-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb285-10"><a href="bayesian-inference.html#cb285-10" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(data)</span>
<span id="cb285-11"><a href="bayesian-inference.html#cb285-11" aria-hidden="true" tabindex="-1"></a>    proportion_success <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">1</span>)</span>
<span id="cb285-12"><a href="bayesian-inference.html#cb285-12" aria-hidden="true" tabindex="-1"></a>    data_indices <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">length</span>(data), <span class="at">length.out =</span> <span class="fu">min</span>(<span class="fu">length</span>(data) <span class="sc">+</span> </span>
<span id="cb285-13"><a href="bayesian-inference.html#cb285-13" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="dv">1</span>, <span class="dv">20</span>)))</span>
<span id="cb285-14"><a href="bayesian-inference.html#cb285-14" aria-hidden="true" tabindex="-1"></a>    post_curves <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(data_indices, <span class="cf">function</span>(i) {</span>
<span id="cb285-15"><a href="bayesian-inference.html#cb285-15" aria-hidden="true" tabindex="-1"></a>        value <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(i <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;Prior&quot;</span>, <span class="fu">ifelse</span>(data[i], <span class="st">&quot;Success&quot;</span>, <span class="st">&quot;Failure&quot;</span>))</span>
<span id="cb285-16"><a href="bayesian-inference.html#cb285-16" aria-hidden="true" tabindex="-1"></a>        label <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;n=&quot;</span>, i)</span>
<span id="cb285-17"><a href="bayesian-inference.html#cb285-17" aria-hidden="true" tabindex="-1"></a>        probability <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(proportion_success, prior_prop[<span class="dv">1</span>] <span class="sc">+</span> </span>
<span id="cb285-18"><a href="bayesian-inference.html#cb285-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">sum</span>(data[<span class="fu">seq_len</span>(i)]), prior_prop[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">sum</span>(<span class="sc">!</span>data[<span class="fu">seq_len</span>(i)]))</span>
<span id="cb285-19"><a href="bayesian-inference.html#cb285-19" aria-hidden="true" tabindex="-1"></a>        probability <span class="ot">&lt;-</span> probability<span class="sc">/</span><span class="fu">max</span>(probability)</span>
<span id="cb285-20"><a href="bayesian-inference.html#cb285-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tibble</span>(value, label, proportion_success, probability)</span>
<span id="cb285-21"><a href="bayesian-inference.html#cb285-21" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb285-22"><a href="bayesian-inference.html#cb285-22" aria-hidden="true" tabindex="-1"></a>    post_curves<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">fct_rev</span>(<span class="fu">factor</span>(post_curves<span class="sc">$</span>label, <span class="at">levels =</span> <span class="fu">paste0</span>(<span class="st">&quot;n=&quot;</span>, </span>
<span id="cb285-23"><a href="bayesian-inference.html#cb285-23" aria-hidden="true" tabindex="-1"></a>                                                                           data_indices)))</span>
<span id="cb285-24"><a href="bayesian-inference.html#cb285-24" aria-hidden="true" tabindex="-1"></a>    post_curves<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">factor</span>(post_curves<span class="sc">$</span>value, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span>, </span>
<span id="cb285-25"><a href="bayesian-inference.html#cb285-25" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">&quot;Success&quot;</span>, <span class="st">&quot;Failure&quot;</span>))</span>
<span id="cb285-26"><a href="bayesian-inference.html#cb285-26" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(post_curves, <span class="fu">aes</span>(<span class="at">x =</span> proportion_success, <span class="at">y =</span> label, </span>
<span id="cb285-27"><a href="bayesian-inference.html#cb285-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">height =</span> probability, <span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_joy</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, </span>
<span id="cb285-28"><a href="bayesian-inference.html#cb285-28" aria-hidden="true" tabindex="-1"></a>                                                                                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">panel_scaling =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb285-29"><a href="bayesian-inference.html#cb285-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_discrete</span>(<span class="st">&quot;&quot;</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Underlying proportion of success&quot;</span>) <span class="sc">+</span> </span>
<span id="cb285-30"><a href="bayesian-inference.html#cb285-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">hcl</span>(<span class="dv">120</span> <span class="sc">*</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">0</span> <span class="sc">+</span> <span class="dv">15</span>, <span class="dv">100</span>, <span class="dv">65</span>), </span>
<span id="cb285-31"><a href="bayesian-inference.html#cb285-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Prior   &quot;</span>, <span class="st">&quot;Success   &quot;</span>, </span>
<span id="cb285-32"><a href="bayesian-inference.html#cb285-32" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">&quot;Failure   &quot;</span>)) <span class="sc">+</span> <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">18</span>) <span class="sc">+</span> </span>
<span id="cb285-33"><a href="bayesian-inference.html#cb285-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb285-34"><a href="bayesian-inference.html#cb285-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (show_plot) {</span>
<span id="cb285-35"><a href="bayesian-inference.html#cb285-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(p)</span>
<span id="cb285-36"><a href="bayesian-inference.html#cb285-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb285-37"><a href="bayesian-inference.html#cb285-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">invisible</span>(<span class="fu">rbeta</span>(n_draws, prior_prop[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">sum</span>(data), prior_prop[<span class="dv">2</span>] <span class="sc">+</span> </span>
<span id="cb285-38"><a href="bayesian-inference.html#cb285-38" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">sum</span>(<span class="sc">!</span>data)))</span>
<span id="cb285-39"><a href="bayesian-inference.html#cb285-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="simple-model-with-one-binary-parameter" class="section level2" number="45.1">
<h2><span class="header-section-number">45.1</span> Simple model with one binary parameter</h2>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="bayesian-inference.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 50 random binary data with P(1)=0.75</span></span>
<span id="cb286-2"><a href="bayesian-inference.html#cb286-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.25</span>), <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb286-3"><a href="bayesian-inference.html#cb286-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-4"><a href="bayesian-inference.html#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize posteriors</span></span>
<span id="cb286-5"><a href="bayesian-inference.html#cb286-5" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">prop_model</span>(data)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="bayesian-inference.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View posterior</span></span>
<span id="cb287-2"><a href="bayesian-inference.html#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(posterior)</span></code></pre></div>
<pre><code>## [1] 0.6885118 0.9954317 0.9157077 0.8484793 0.8414593 0.8479106</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="bayesian-inference.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Center of the posterior</span></span>
<span id="cb289-2"><a href="bayesian-inference.html#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(posterior)</span></code></pre></div>
<pre><code>## [1] 0.8518252</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="bayesian-inference.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The credible interval (CI)</span></span>
<span id="cb291-2"><a href="bayesian-inference.html#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(posterior, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span></code></pre></div>
<pre><code>##        5%       95% 
## 0.6327662 0.9674745</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="bayesian-inference.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of successes &gt; 0.3</span></span>
<span id="cb293-2"><a href="bayesian-inference.html#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(posterior <span class="sc">&gt;</span> <span class="fl">0.3</span>) <span class="sc">/</span> <span class="fu">length</span>(posterior)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p><strong>Generate binomial data</strong></p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="bayesian-inference.html#cb295-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.42</span>     <span class="co"># probability of success</span></span>
<span id="cb295-2"><a href="bayesian-inference.html#cb295-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>      <span class="co"># number of observations</span></span>
<span id="cb295-3"><a href="bayesian-inference.html#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create logical vector, TRUE if numeric value from uniform distribution &lt; p</span></span>
<span id="cb295-4"><a href="bayesian-inference.html#cb295-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb295-5"><a href="bayesian-inference.html#cb295-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb295-6"><a href="bayesian-inference.html#cb295-6" aria-hidden="true" tabindex="-1"></a>    data[i] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>) <span class="sc">&lt;</span> p</span>
<span id="cb295-7"><a href="bayesian-inference.html#cb295-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb295-8"><a href="bayesian-inference.html#cb295-8" aria-hidden="true" tabindex="-1"></a><span class="co"># convert logical to numeric 0/1</span></span>
<span id="cb295-9"><a href="bayesian-inference.html#cb295-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data)</span>
<span id="cb295-10"><a href="bayesian-inference.html#cb295-10" aria-hidden="true" tabindex="-1"></a>data</span></code></pre></div>
<pre><code>##   [1] 0 1 0 1 0 0 0 0 1 1 1 0 1 0 0 0 0 0 1 1 0 1 0 0 0 1 0 0 1 0 0 1 0 0 1 0 0 1 1 1 1 0 1 1
##  [45] 0 0 0 1 1 0 0 0 1 0 1 0 0 0 0 1 0 1 0 1 0 0 0 0 1 0 0 0 0 0 1 1 0 0 0 1 0 0 0 0 1 1 0 0
##  [89] 0 0 0 0 0 0 1 0 0 0 0 1</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="bayesian-inference.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the same vector using rbinom distribution</span></span>
<span id="cb297-2"><a href="bayesian-inference.html#cb297-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span>      <span class="co"># number of observations</span></span>
<span id="cb297-3"><a href="bayesian-inference.html#cb297-3" aria-hidden="true" tabindex="-1"></a>size <span class="ot">=</span> <span class="dv">1</span>     <span class="co"># 0 - fail, 1 - success, for 1 trial</span></span>
<span id="cb297-4"><a href="bayesian-inference.html#cb297-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fl">0.42</span>     <span class="co"># probability of success</span></span>
<span id="cb297-5"><a href="bayesian-inference.html#cb297-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(n, size, p)</span></code></pre></div>
<pre><code>##   [1] 0 0 0 1 0 0 0 0 0 1 1 0 0 0 0 0 0 1 0 0 1 1 0 1 0 1 0 0 0 0 1 1 0 1 0 0 0 0 1 0 0 0 0 0
##  [45] 1 1 1 1 1 0 1 0 0 0 0 0 1 0 0 0 0 1 0 0 1 1 1 1 0 0 0 1 1 0 0 0 1 1 1 1 1 1 0 1 1 1 0 1
##  [89] 1 1 0 0 1 0 0 0 0 1 1 0</code></pre>
</div>
<div id="grid-approximation" class="section level2" number="45.2">
<h2><span class="header-section-number">45.2</span> Grid approximation</h2>
<p>To get more visitors to your website you are considering paying for an ad to be
<strong>shown 100 times</strong> on a popular social media site.<br />
According to the social media site, their ads get <strong>clicked on 10% of the time</strong>.
How many visitors could your site get?</p>
<p>We can fix % of clicks as 0.1 but we do not know exactly how many clicks people
do (uncertain). We suggest the % of clicks is uniformly distributed between 0 and 20.</p>
<p>Define model:<br />
<span class="math inline">\(n_{ads} = 100\)</span>
<span class="math inline">\(p_{clicks} ~ Uniform(0.0, 0.2)\)</span>
<span class="math inline">\(p_{visitors} ~ Binomial(n_{ads}, p_{clicks})\)</span></p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="bayesian-inference.html#cb299-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span>          <span class="co"># number of simulations</span></span>
<span id="cb299-2"><a href="bayesian-inference.html#cb299-2" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span>   <span class="co"># number of shown ads</span></span>
<span id="cb299-3"><a href="bayesian-inference.html#cb299-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-4"><a href="bayesian-inference.html#cb299-4" aria-hidden="true" tabindex="-1"></a><span class="co"># probability that add will be clicked (assume uniform [0,0.2])</span></span>
<span id="cb299-5"><a href="bayesian-inference.html#cb299-5" aria-hidden="true" tabindex="-1"></a>p_clicks <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="fl">0.0</span>, <span class="at">max =</span> <span class="fl">0.2</span>)  </span>
<span id="cb299-6"><a href="bayesian-inference.html#cb299-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-7"><a href="bayesian-inference.html#cb299-7" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL: We assume that the binomial distribution is a reasonable generative model</span></span>
<span id="cb299-8"><a href="bayesian-inference.html#cb299-8" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, </span>
<span id="cb299-9"><a href="bayesian-inference.html#cb299-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> n_ads_shown, </span>
<span id="cb299-10"><a href="bayesian-inference.html#cb299-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> p_clicks)</span>
<span id="cb299-11"><a href="bayesian-inference.html#cb299-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-12"><a href="bayesian-inference.html#cb299-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the prior model simulation</span></span>
<span id="cb299-13"><a href="bayesian-inference.html#cb299-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb299-14"><a href="bayesian-inference.html#cb299-14" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> n_visitors, <span class="at">y =</span> p_clicks)</span>
<span id="cb299-15"><a href="bayesian-inference.html#cb299-15" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(n_visitors, p_clicks)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb299-16"><a href="bayesian-inference.html#cb299-16" aria-hidden="true" tabindex="-1"></a>ggExtra<span class="sc">::</span><span class="fu">ggMarginal</span>(p, <span class="at">type =</span> <span class="st">&quot;histogram&quot;</span>,  <span class="at">bins =</span> <span class="dv">18</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
<p><strong>Generate posterior distribution</strong></p>
<p>After the first day of showing ads we registered that <strong>13 people</strong> clicked and
<strong>visited</strong> site when the ad was shown 100 times.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="bayesian-inference.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior distribution binomial model with uniform clicks</span></span>
<span id="cb300-2"><a href="bayesian-inference.html#cb300-2" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(p_clicks, n_visitors)</span>
<span id="cb300-3"><a href="bayesian-inference.html#cb300-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-4"><a href="bayesian-inference.html#cb300-4" aria-hidden="true" tabindex="-1"></a><span class="co"># To get posterior we subset from prior 13 visitors</span></span>
<span id="cb300-5"><a href="bayesian-inference.html#cb300-5" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">13</span>, ]</span>
<span id="cb300-6"><a href="bayesian-inference.html#cb300-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(posterior)</span></code></pre></div>
<pre><code>##       p_clicks n_visitors
## 39  0.13318400         13
## 57  0.15608873         13
## 64  0.09112852         13
## 75  0.11852016         13
## 76  0.12653570         13
## 106 0.10590670         13</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="bayesian-inference.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize posterior</span></span>
<span id="cb302-2"><a href="bayesian-inference.html#cb302-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(posterior, <span class="fu">aes</span>(n_visitors, p_clicks)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb302-3"><a href="bayesian-inference.html#cb302-3" aria-hidden="true" tabindex="-1"></a>ggExtra<span class="sc">::</span><span class="fu">ggMarginal</span>(p, <span class="at">type =</span> <span class="st">&quot;histogram&quot;</span>,  <span class="at">bins =</span> <span class="dv">18</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
<p>For the next iteration we make <strong>prior from posterior</strong> and include new data for
subsetting from prior to get posterior.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="bayesian-inference.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign posterior to prior for the next iteration</span></span>
<span id="cb303-2"><a href="bayesian-inference.html#cb303-2" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> posterior</span>
<span id="cb303-3"><a href="bayesian-inference.html#cb303-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-4"><a href="bayesian-inference.html#cb303-4" aria-hidden="true" tabindex="-1"></a><span class="co"># next iteration posterior ~ f(prior)</span></span>
<span id="cb303-5"><a href="bayesian-inference.html#cb303-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span>  <span class="fu">nrow</span>(prior)</span>
<span id="cb303-6"><a href="bayesian-inference.html#cb303-6" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb303-7"><a href="bayesian-inference.html#cb303-7" aria-hidden="true" tabindex="-1"></a>prior<span class="sc">$</span>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, </span>
<span id="cb303-8"><a href="bayesian-inference.html#cb303-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> n_ads_shown, </span>
<span id="cb303-9"><a href="bayesian-inference.html#cb303-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> prior<span class="sc">$</span>p_clicks)</span>
<span id="cb303-10"><a href="bayesian-inference.html#cb303-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-11"><a href="bayesian-inference.html#cb303-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of prior distributions</span></span>
<span id="cb303-12"><a href="bayesian-inference.html#cb303-12" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prior, <span class="fu">aes</span>(n_visitors, p_clicks)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb303-13"><a href="bayesian-inference.html#cb303-13" aria-hidden="true" tabindex="-1"></a>ggExtra<span class="sc">::</span><span class="fu">ggMarginal</span>(p, <span class="at">type =</span> <span class="st">&quot;histogram&quot;</span>,  <span class="at">bins =</span> <span class="dv">18</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
<p>Use result of the model for prediction:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="bayesian-inference.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability that you will get 5 or more visitors.</span></span>
<span id="cb304-2"><a href="bayesian-inference.html#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(prior<span class="sc">$</span>n_visitors <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">/</span> <span class="fu">length</span>(prior<span class="sc">$</span>n_visitors)</span></code></pre></div>
<pre><code>## [1] 0.9889606</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="bayesian-inference.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Median number of visitors</span></span>
<span id="cb306-2"><a href="bayesian-inference.html#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(prior<span class="sc">$</span>n_visitors)</span></code></pre></div>
<pre><code>## [1] 13</code></pre>
<p><strong>Updated model</strong>
We will change prior distribution with knowledge we learn from people that the
number of clicks are 5% and sometimes 2 or 8%.
We will use <strong>beta distribution</strong> to setup number of clicks to update prior in
our model.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="bayesian-inference.html#cb308-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb308-2"><a href="bayesian-inference.html#cb308-2" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb308-3"><a href="bayesian-inference.html#cb308-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-4"><a href="bayesian-inference.html#cb308-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the prior on proportion_clicks</span></span>
<span id="cb308-5"><a href="bayesian-inference.html#cb308-5" aria-hidden="true" tabindex="-1"></a>p_clicks <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, <span class="at">shape1 =</span> <span class="dv">5</span>, <span class="at">shape2 =</span> <span class="dv">95</span>)</span>
<span id="cb308-6"><a href="bayesian-inference.html#cb308-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-7"><a href="bayesian-inference.html#cb308-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Updated model</span></span>
<span id="cb308-8"><a href="bayesian-inference.html#cb308-8" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n,</span>
<span id="cb308-9"><a href="bayesian-inference.html#cb308-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> n_ads_shown, </span>
<span id="cb308-10"><a href="bayesian-inference.html#cb308-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> p_clicks)</span>
<span id="cb308-11"><a href="bayesian-inference.html#cb308-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-12"><a href="bayesian-inference.html#cb308-12" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(p_clicks, n_visitors)</span>
<span id="cb308-13"><a href="bayesian-inference.html#cb308-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-14"><a href="bayesian-inference.html#cb308-14" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">13</span>, ]</span>
<span id="cb308-15"><a href="bayesian-inference.html#cb308-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-16"><a href="bayesian-inference.html#cb308-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots the prior and the posterior</span></span>
<span id="cb308-17"><a href="bayesian-inference.html#cb308-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb308-18"><a href="bayesian-inference.html#cb308-18" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(prior<span class="sc">$</span>p_clicks, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>))</span>
<span id="cb308-19"><a href="bayesian-inference.html#cb308-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>p_clicks, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<p>We tested for video banner and now we would like to compair distributions for:
- video ads (13 out of 100 clicked)<br />
- text ads (6 out of a 100 clicked).</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="bayesian-inference.html#cb309-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb309-2"><a href="bayesian-inference.html#cb309-2" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb309-3"><a href="bayesian-inference.html#cb309-3" aria-hidden="true" tabindex="-1"></a>p_clicks <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="fl">0.0</span>, <span class="at">max =</span> <span class="fl">0.2</span>)</span>
<span id="cb309-4"><a href="bayesian-inference.html#cb309-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-5"><a href="bayesian-inference.html#cb309-5" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, </span>
<span id="cb309-6"><a href="bayesian-inference.html#cb309-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> n_ads_shown, </span>
<span id="cb309-7"><a href="bayesian-inference.html#cb309-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> p_clicks)</span>
<span id="cb309-8"><a href="bayesian-inference.html#cb309-8" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(p_clicks, n_visitors)</span>
<span id="cb309-9"><a href="bayesian-inference.html#cb309-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-10"><a href="bayesian-inference.html#cb309-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the posteriors for video and text ads</span></span>
<span id="cb309-11"><a href="bayesian-inference.html#cb309-11" aria-hidden="true" tabindex="-1"></a>posterior_video <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">13</span>, ]</span>
<span id="cb309-12"><a href="bayesian-inference.html#cb309-12" aria-hidden="true" tabindex="-1"></a>posterior_text <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">6</span>, ]</span>
<span id="cb309-13"><a href="bayesian-inference.html#cb309-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-14"><a href="bayesian-inference.html#cb309-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb309-15"><a href="bayesian-inference.html#cb309-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the posteriors</span></span>
<span id="cb309-16"><a href="bayesian-inference.html#cb309-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior_video<span class="sc">$</span>p_clicks, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>))</span>
<span id="cb309-17"><a href="bayesian-inference.html#cb309-17" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior_text<span class="sc">$</span>p_clicks, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="bayesian-inference.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine data into dataframe</span></span>
<span id="cb310-2"><a href="bayesian-inference.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sizes of distrib. the same (4000) to fit to dataframe</span></span>
<span id="cb310-3"><a href="bayesian-inference.html#cb310-3" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">video_prop =</span> posterior_video<span class="sc">$</span>p_clicks[<span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>],</span>
<span id="cb310-4"><a href="bayesian-inference.html#cb310-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">text_prop =</span> posterior_text<span class="sc">$</span>p_clicks[<span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>])</span>
<span id="cb310-5"><a href="bayesian-inference.html#cb310-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-6"><a href="bayesian-inference.html#cb310-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior difference: video_prop - text_prop</span></span>
<span id="cb310-7"><a href="bayesian-inference.html#cb310-7" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>prop_diff <span class="ot">&lt;-</span> posterior<span class="sc">$</span>video_prop <span class="sc">-</span> posterior<span class="sc">$</span>text_prop</span>
<span id="cb310-8"><a href="bayesian-inference.html#cb310-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-9"><a href="bayesian-inference.html#cb310-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the median of prop_diff</span></span>
<span id="cb310-10"><a href="bayesian-inference.html#cb310-10" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(posterior<span class="sc">$</span>prop_diff)</span></code></pre></div>
<pre><code>## [1] 0.06535207</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="bayesian-inference.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the proportion</span></span>
<span id="cb312-2"><a href="bayesian-inference.html#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(posterior<span class="sc">$</span>prop_diff <span class="sc">&gt;</span> <span class="fl">0.0</span>)</span></code></pre></div>
<pre><code>## [1] 0.94825</code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="bayesian-inference.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize prop_diff</span></span>
<span id="cb314-2"><a href="bayesian-inference.html#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>prop_diff)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-111-2.png" width="672" /></p>
<p><strong>Decision analysis</strong></p>
<p>Our analysis indicated that <em>the video ads are clicked more often</em>.<br />
We would like to estimate probable profit <em>video ads</em> vs <em>text ads</em> if we know:</p>
<ul>
<li>Each visitor spends $2.53 on average on our website.<br />
</li>
<li>Video ad costs us $0.25 per click.<br />
</li>
<li>Text ad costs us $0.05 per click.</li>
</ul>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="bayesian-inference.html#cb315-1" aria-hidden="true" tabindex="-1"></a>visitor_spend <span class="ot">&lt;-</span> <span class="fl">2.53</span></span>
<span id="cb315-2"><a href="bayesian-inference.html#cb315-2" aria-hidden="true" tabindex="-1"></a>video_cost <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb315-3"><a href="bayesian-inference.html#cb315-3" aria-hidden="true" tabindex="-1"></a>text_cost <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb315-4"><a href="bayesian-inference.html#cb315-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-5"><a href="bayesian-inference.html#cb315-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the column posterior$video_profit</span></span>
<span id="cb315-6"><a href="bayesian-inference.html#cb315-6" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>video_profit <span class="ot">&lt;-</span> posterior<span class="sc">$</span>video_prop <span class="sc">*</span> visitor_spend <span class="sc">-</span> video_cost</span>
<span id="cb315-7"><a href="bayesian-inference.html#cb315-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-8"><a href="bayesian-inference.html#cb315-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the column posterior$text_profit</span></span>
<span id="cb315-9"><a href="bayesian-inference.html#cb315-9" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>text_profit <span class="ot">&lt;-</span> posterior<span class="sc">$</span>text_prop <span class="sc">*</span> visitor_spend <span class="sc">-</span> text_cost</span>
<span id="cb315-10"><a href="bayesian-inference.html#cb315-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-11"><a href="bayesian-inference.html#cb315-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(posterior)</span></code></pre></div>
<pre><code>##   video_prop  text_prop  prop_diff video_profit text_profit
## 1  0.1591797 0.04933518 0.10984449  0.152724569  0.07481801
## 2  0.1639834 0.13350068 0.03048271  0.164877969  0.28775671
## 3  0.1342420 0.04359866 0.09064333  0.089632257  0.06030462
## 4  0.1007833 0.03186180 0.06892146  0.004981632  0.03061034
## 5  0.1434389 0.12331007 0.02012884  0.112900432  0.26197447
## 6  0.1953154 0.14542950 0.04988593  0.244148032  0.31793663</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="bayesian-inference.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the video_profit and text_profit columns</span></span>
<span id="cb317-2"><a href="bayesian-inference.html#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb317-3"><a href="bayesian-inference.html#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>video_profit)</span>
<span id="cb317-4"><a href="bayesian-inference.html#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>text_profit)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="bayesian-inference.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Difference between video and text ad profits</span></span>
<span id="cb318-2"><a href="bayesian-inference.html#cb318-2" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>profit_diff <span class="ot">&lt;-</span> posterior<span class="sc">$</span>video_profit <span class="sc">-</span> posterior<span class="sc">$</span>text_profit</span>
<span id="cb318-3"><a href="bayesian-inference.html#cb318-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-4"><a href="bayesian-inference.html#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize posterior$profit_diff</span></span>
<span id="cb318-5"><a href="bayesian-inference.html#cb318-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>profit_diff)</span>
<span id="cb318-6"><a href="bayesian-inference.html#cb318-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-7"><a href="bayesian-inference.html#cb318-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate a &quot;best guess&quot; for the difference in profits</span></span>
<span id="cb318-8"><a href="bayesian-inference.html#cb318-8" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(posterior<span class="sc">$</span>profit_diff)</span></code></pre></div>
<pre><code>## [1] -0.03465928</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="bayesian-inference.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability that text ads are better than video ads</span></span>
<span id="cb320-2"><a href="bayesian-inference.html#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(posterior<span class="sc">$</span>profit_diff <span class="sc">&lt;</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.63525</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-112-2.png" width="672" />
Our analysis showed that text ads will bring probably more profit but the result
is too uncertain and we need more data for making the correct decision.</p>
<p><strong>Another model for another case</strong></p>
<p>We would like to put up an ad on the site and pay for it per day.<br />
The site admin promise that we will get 19 clicks per day.<br />
How many daily clicks should we expect on average?<br />
We are going to use <strong>Poisson distribution</strong> for our new model which correspond
to <em>number of successes in a period of time</em>.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="bayesian-inference.html#cb322-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb322-2"><a href="bayesian-inference.html#cb322-2" aria-hidden="true" tabindex="-1"></a>mean_clicks <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">80</span>) <span class="co"># uniform dist between 0 and 80 clicks</span></span>
<span id="cb322-3"><a href="bayesian-inference.html#cb322-3" aria-hidden="true" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb322-4"><a href="bayesian-inference.html#cb322-4" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> n, mean_clicks)</span>
<span id="cb322-5"><a href="bayesian-inference.html#cb322-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-6"><a href="bayesian-inference.html#cb322-6" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mean_clicks, n_visitors)</span>
<span id="cb322-7"><a href="bayesian-inference.html#cb322-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-8"><a href="bayesian-inference.html#cb322-8" aria-hidden="true" tabindex="-1"></a><span class="co"># first day trial showed 13 clicks</span></span>
<span id="cb322-9"><a href="bayesian-inference.html#cb322-9" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">13</span>, ]</span>
<span id="cb322-10"><a href="bayesian-inference.html#cb322-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-11"><a href="bayesian-inference.html#cb322-11" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize prior and posterior</span></span>
<span id="cb322-12"><a href="bayesian-inference.html#cb322-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb322-13"><a href="bayesian-inference.html#cb322-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(prior<span class="sc">$</span>mean_clicks)</span>
<span id="cb322-14"><a href="bayesian-inference.html#cb322-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>mean_clicks)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
</div>
<div id="grid-approximation-1" class="section level2" number="45.3">
<h2><span class="header-section-number">45.3</span> Grid approximation</h2>
<p>The following example shows how we can build the previous model more effective.<br />
We calculating the <strong>distribution</strong> using <code>dbinom</code> instead of <strong>simulating</strong>
using <code>rbinom</code>.<br />
We can directly include condition in our model using <code>dbinom</code> instead of <code>rbinom</code>.</p>
<p>Instead of using resul of our trial <em>13 visitors after showing ads 100 times</em> we
can condition for all posible number of visitors <code>seq(0,100)</code>.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="bayesian-inference.html#cb323-1" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb323-2"><a href="bayesian-inference.html#cb323-2" aria-hidden="true" tabindex="-1"></a>p_clicks <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb323-3"><a href="bayesian-inference.html#cb323-3" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="co"># instead of 13 we get for all possible n visitors</span></span>
<span id="cb323-4"><a href="bayesian-inference.html#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb323-5"><a href="bayesian-inference.html#cb323-5" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(n_visitors,</span>
<span id="cb323-6"><a href="bayesian-inference.html#cb323-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> n_ads_shown, </span>
<span id="cb323-7"><a href="bayesian-inference.html#cb323-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">prob =</span> p_clicks)</span>
<span id="cb323-8"><a href="bayesian-inference.html#cb323-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(prob)</span></code></pre></div>
<pre><code>## [1] 0.0000265614 0.0002951267 0.0016231966 0.0058916025 0.0158745955 0.0338658038</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="bayesian-inference.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the distribution</span></span>
<span id="cb325-2"><a href="bayesian-inference.html#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n_visitors, prob, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
<p><strong>Calculating a joint distribution</strong></p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="bayesian-inference.html#cb326-1" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb326-2"><a href="bayesian-inference.html#cb326-2" aria-hidden="true" tabindex="-1"></a>p_clicks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb326-3"><a href="bayesian-inference.html#cb326-3" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb326-4"><a href="bayesian-inference.html#cb326-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-5"><a href="bayesian-inference.html#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a grid over all the parameter combinations you need to evaluate</span></span>
<span id="cb326-6"><a href="bayesian-inference.html#cb326-6" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">proportion_clicks =</span> p_clicks,</span>
<span id="cb326-7"><a href="bayesian-inference.html#cb326-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n_visitors =</span> n_visitors)</span>
<span id="cb326-8"><a href="bayesian-inference.html#cb326-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-9"><a href="bayesian-inference.html#cb326-9" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>prior <span class="ot">&lt;-</span> <span class="fu">dunif</span>(pars<span class="sc">$</span>proportion_clicks, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fl">0.2</span>)</span>
<span id="cb326-10"><a href="bayesian-inference.html#cb326-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-11"><a href="bayesian-inference.html#cb326-11" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(pars<span class="sc">$</span>n_visitors, </span>
<span id="cb326-12"><a href="bayesian-inference.html#cb326-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> n_ads_shown, </span>
<span id="cb326-13"><a href="bayesian-inference.html#cb326-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prob =</span> pars<span class="sc">$</span>proportion_clicks)</span>
<span id="cb326-14"><a href="bayesian-inference.html#cb326-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-15"><a href="bayesian-inference.html#cb326-15" aria-hidden="true" tabindex="-1"></a><span class="do">### According to Bayes&#39; theorem:</span></span>
<span id="cb326-16"><a href="bayesian-inference.html#cb326-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined probability by the rule of probabilities multiplication</span></span>
<span id="cb326-17"><a href="bayesian-inference.html#cb326-17" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>likelihood <span class="sc">*</span> pars<span class="sc">$</span>prior</span>
<span id="cb326-18"><a href="bayesian-inference.html#cb326-18" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize to the total number to get sum of all probabilities eq 1</span></span>
<span id="cb326-19"><a href="bayesian-inference.html#cb326-19" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>probability <span class="sc">/</span> <span class="fu">sum</span>(pars<span class="sc">$</span>probability)</span>
<span id="cb326-20"><a href="bayesian-inference.html#cb326-20" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb326-21"><a href="bayesian-inference.html#cb326-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-22"><a href="bayesian-inference.html#cb326-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Conditioning on the data for n_visitors == 6  </span></span>
<span id="cb326-23"><a href="bayesian-inference.html#cb326-23" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> pars[pars<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">6</span>, ]</span>
<span id="cb326-24"><a href="bayesian-inference.html#cb326-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-25"><a href="bayesian-inference.html#cb326-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize again to get sum of all probabilities eq 1</span></span>
<span id="cb326-26"><a href="bayesian-inference.html#cb326-26" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>probability <span class="sc">/</span> <span class="fu">sum</span>(pars<span class="sc">$</span>probability)</span>
<span id="cb326-27"><a href="bayesian-inference.html#cb326-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-28"><a href="bayesian-inference.html#cb326-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the posterior pars$probability</span></span>
<span id="cb326-29"><a href="bayesian-inference.html#cb326-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pars<span class="sc">$</span>proportion_clicks, pars<span class="sc">$</span>probability, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
<p>We can directly condition and change <code>n_visitors &lt;- 6</code>. In this case we do not
need to subset by <code>pars[pars$n_visitors == 6, ]</code>. Result will be the same.</p>
</div>
<div id="model-of-birth-weights-using-normal-distribution" class="section level2" number="45.4">
<h2><span class="header-section-number">45.4</span> Model of birth weights using normal distribution</h2>
<p>Let’s assume that the Normal distribution is a decent model of birth weight data.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="bayesian-inference.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign mu and sigma</span></span>
<span id="cb327-2"><a href="bayesian-inference.html#cb327-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">3500</span>   <span class="co"># central value (mean weight)</span></span>
<span id="cb327-3"><a href="bayesian-inference.html#cb327-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">600</span>    <span class="co"># deviation</span></span>
<span id="cb327-4"><a href="bayesian-inference.html#cb327-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-5"><a href="bayesian-inference.html#cb327-5" aria-hidden="true" tabindex="-1"></a>weight_dist <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100000</span>, <span class="at">mean =</span> m, <span class="at">sd =</span> s)</span>
<span id="cb327-6"><a href="bayesian-inference.html#cb327-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(weight_dist, <span class="dv">60</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6000</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
<p>We calculating the <strong>distribution</strong> using <code>dnorm</code> instead of <strong>simulating</strong> using <code>rnorm</code>.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="bayesian-inference.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create weight</span></span>
<span id="cb328-2"><a href="bayesian-inference.html#cb328-2" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6000</span>, <span class="at">by =</span> <span class="dv">100</span>)  <span class="co"># 100 g increment</span></span>
<span id="cb328-3"><a href="bayesian-inference.html#cb328-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-4"><a href="bayesian-inference.html#cb328-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate likelihood</span></span>
<span id="cb328-5"><a href="bayesian-inference.html#cb328-5" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(weight, m, s)</span>
<span id="cb328-6"><a href="bayesian-inference.html#cb328-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-7"><a href="bayesian-inference.html#cb328-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the distribution of weight</span></span>
<span id="cb328-8"><a href="bayesian-inference.html#cb328-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weight, likelihood, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-117-1.png" width="672" /></p>
<p>Here is a small data set with the birth weights of six newborn babies in grams.<br />
<code>c(3164, 3362, 4435, 3542, 3578, 4529)</code></p>
<p>Mark: What to do with the data? Should we condition it to get posterior?</p>
</div>
<div id="a-bayesian-model-of-zombie-iq" class="section level2" number="45.5">
<h2><span class="header-section-number">45.5</span> A Bayesian model of Zombie IQ</h2>
<p>Check video</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="bayesian-inference.html#cb329-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">23</span>, <span class="dv">20</span>, <span class="dv">17</span>, <span class="dv">23</span>)</span>
<span id="cb329-2"><a href="bayesian-inference.html#cb329-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">8</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb329-3"><a href="bayesian-inference.html#cb329-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.3</span>)</span>
<span id="cb329-4"><a href="bayesian-inference.html#cb329-4" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mu =</span> mu, <span class="at">sigma =</span> sigma)</span>
<span id="cb329-5"><a href="bayesian-inference.html#cb329-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-6"><a href="bayesian-inference.html#cb329-6" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>mu_prior    <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(pars<span class="sc">$</span>mu,    <span class="at">mean =</span> <span class="dv">18</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb329-7"><a href="bayesian-inference.html#cb329-7" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>sigma_prior <span class="ot">&lt;-</span> <span class="fu">dunif</span>(pars<span class="sc">$</span>sigma, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)</span>
<span id="cb329-8"><a href="bayesian-inference.html#cb329-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-9"><a href="bayesian-inference.html#cb329-9" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>prior <span class="ot">&lt;-</span> pars<span class="sc">$</span>mu_prior <span class="sc">*</span> pars<span class="sc">$</span>sigma_prior</span>
<span id="cb329-10"><a href="bayesian-inference.html#cb329-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-11"><a href="bayesian-inference.html#cb329-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pars)) {</span>
<span id="cb329-12"><a href="bayesian-inference.html#cb329-12" aria-hidden="true" tabindex="-1"></a>    likelihoods <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(temp, pars<span class="sc">$</span>mu[i], pars<span class="sc">$</span>sigma[i])</span>
<span id="cb329-13"><a href="bayesian-inference.html#cb329-13" aria-hidden="true" tabindex="-1"></a>    pars<span class="sc">$</span>likelihood[i] <span class="ot">&lt;-</span> <span class="fu">prod</span>(likelihoods)</span>
<span id="cb329-14"><a href="bayesian-inference.html#cb329-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb329-15"><a href="bayesian-inference.html#cb329-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-16"><a href="bayesian-inference.html#cb329-16" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>likelihood <span class="sc">*</span> pars<span class="sc">$</span>prior</span>
<span id="cb329-17"><a href="bayesian-inference.html#cb329-17" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>probability <span class="sc">/</span> <span class="fu">sum</span>(pars<span class="sc">$</span>probability)</span>
<span id="cb329-18"><a href="bayesian-inference.html#cb329-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-19"><a href="bayesian-inference.html#cb329-19" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pars), <span class="at">size =</span> <span class="dv">10000</span>, </span>
<span id="cb329-20"><a href="bayesian-inference.html#cb329-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> pars<span class="sc">$</span>probability)</span>
<span id="cb329-21"><a href="bayesian-inference.html#cb329-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sample_indices)</span></code></pre></div>
<pre><code>## [1] 524 705 478 749 298 296</code></pre>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="bayesian-inference.html#cb331-1" aria-hidden="true" tabindex="-1"></a>pars_sample <span class="ot">&lt;-</span> pars[sample_indices, <span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>)]</span>
<span id="cb331-2"><a href="bayesian-inference.html#cb331-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pars_sample)</span></code></pre></div>
<pre><code>##       mu sigma
## 524 22.0   3.4
## 705 22.5   4.6
## 478 21.5   3.1
## 749 22.0   4.9
## 298 21.5   1.9
## 296 20.5   1.9</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="bayesian-inference.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pars_sample<span class="sc">$</span>mu, <span class="dv">30</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/bi-432-1.png" width="672" /></p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="bayesian-inference.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(pars_sample<span class="sc">$</span>mu, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span></code></pre></div>
<pre><code>##   5%  95% 
## 17.5 22.5</code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="bayesian-inference.html#cb336-1" aria-hidden="true" tabindex="-1"></a>pred_temp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> pars_sample<span class="sc">$</span>mu, <span class="at">sd =</span> pars_sample<span class="sc">$</span>sigma)</span>
<span id="cb336-2"><a href="bayesian-inference.html#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pred_temp, <span class="dv">30</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/bi-432-2.png" width="672" /></p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="bayesian-inference.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of 18C</span></span>
<span id="cb337-2"><a href="bayesian-inference.html#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pred_temp <span class="sc">&gt;=</span> <span class="dv">18</span>) <span class="sc">/</span> <span class="fu">length</span>(pred_temp)</span></code></pre></div>
<pre><code>## [1] 0.7315</code></pre>
<p>for the model of temperature but use zombies IQs instead.
Define model:<br />
<span class="math inline">\(\mu = Normal(mean:18, sd:5)\)</span>
<span class="math inline">\(\sigma = Uniform(min:0, max:10)\)</span>
<span class="math inline">\(temp = 19,23,...\)</span>
How much we can learn about the mean zombie IQ from this data.
We need to calculate the probability of each parameter combination in pars.<br />
Use Bayes Theorem to calculate these probabilities and assign them to
<code>pars$probability</code> to complete the model.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="bayesian-inference.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The IQ of a bunch of zombies</span></span>
<span id="cb339-2"><a href="bayesian-inference.html#cb339-2" aria-hidden="true" tabindex="-1"></a>iq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">44</span>, <span class="dv">34</span>, <span class="dv">18</span>, <span class="dv">51</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="dv">49</span>, <span class="dv">48</span>, <span class="dv">46</span>)</span>
<span id="cb339-3"><a href="bayesian-inference.html#cb339-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-4"><a href="bayesian-inference.html#cb339-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the parameter grid</span></span>
<span id="cb339-5"><a href="bayesian-inference.html#cb339-5" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mu =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="at">length.out =</span> <span class="dv">100</span>), </span>
<span id="cb339-6"><a href="bayesian-inference.html#cb339-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sigma =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">50</span>, <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb339-7"><a href="bayesian-inference.html#cb339-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-8"><a href="bayesian-inference.html#cb339-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining and calculating the prior density for each parameter combination</span></span>
<span id="cb339-9"><a href="bayesian-inference.html#cb339-9" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>mu_prior <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(pars<span class="sc">$</span>mu, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span>
<span id="cb339-10"><a href="bayesian-inference.html#cb339-10" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>sigma_prior <span class="ot">&lt;-</span> <span class="fu">dunif</span>(pars<span class="sc">$</span>sigma, <span class="at">min =</span> <span class="fl">0.1</span>, <span class="at">max =</span> <span class="dv">50</span>)</span>
<span id="cb339-11"><a href="bayesian-inference.html#cb339-11" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>prior <span class="ot">&lt;-</span> pars<span class="sc">$</span>mu_prior <span class="sc">*</span> pars<span class="sc">$</span>sigma_prior</span>
<span id="cb339-12"><a href="bayesian-inference.html#cb339-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-13"><a href="bayesian-inference.html#cb339-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the likelihood for each parameter combination</span></span>
<span id="cb339-14"><a href="bayesian-inference.html#cb339-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pars)) {</span>
<span id="cb339-15"><a href="bayesian-inference.html#cb339-15" aria-hidden="true" tabindex="-1"></a>  likelihoods <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(iq, pars<span class="sc">$</span>mu[i], pars<span class="sc">$</span>sigma[i])</span>
<span id="cb339-16"><a href="bayesian-inference.html#cb339-16" aria-hidden="true" tabindex="-1"></a>  pars<span class="sc">$</span>likelihood[i] <span class="ot">&lt;-</span> <span class="fu">prod</span>(likelihoods)</span>
<span id="cb339-17"><a href="bayesian-inference.html#cb339-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb339-18"><a href="bayesian-inference.html#cb339-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-19"><a href="bayesian-inference.html#cb339-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability of each parameter combination</span></span>
<span id="cb339-20"><a href="bayesian-inference.html#cb339-20" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>likelihood <span class="sc">*</span> pars<span class="sc">$</span>prior <span class="sc">/</span> <span class="fu">sum</span>(pars<span class="sc">$</span>likelihood <span class="sc">*</span> pars<span class="sc">$</span>prior)</span></code></pre></div>
<p>Calculate new parameters.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="bayesian-inference.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pars)</span></code></pre></div>
<pre><code>##         mu sigma    mu_prior sigma_prior        prior likelihood probability
## 1 0.000000   0.1 0.002419707  0.02004008 4.849113e-05          0           0
## 2 1.515152   0.1 0.002456367  0.02004008 4.922578e-05          0           0
## 3 3.030303   0.1 0.002493009  0.02004008 4.996010e-05          0           0
## 4 4.545455   0.1 0.002529617  0.02004008 5.069373e-05          0           0
## 5 6.060606   0.1 0.002566174  0.02004008 5.142633e-05          0           0
## 6 7.575758   0.1 0.002602661  0.02004008 5.215754e-05          0           0</code></pre>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="bayesian-inference.html#cb342-1" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(pars), <span class="at">size =</span> <span class="dv">10000</span>,</span>
<span id="cb342-2"><a href="bayesian-inference.html#cb342-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> pars<span class="sc">$</span>probability)</span>
<span id="cb342-3"><a href="bayesian-inference.html#cb342-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sample_indices)</span></code></pre></div>
<pre><code>## [1] 2429 2729 2631 3333 2732 2030</code></pre>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="bayesian-inference.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample from pars to calculate some new measures</span></span>
<span id="cb344-2"><a href="bayesian-inference.html#cb344-2" aria-hidden="true" tabindex="-1"></a>pars_sample <span class="ot">&lt;-</span> pars[sample_indices, <span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>)]</span>
<span id="cb344-3"><a href="bayesian-inference.html#cb344-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-4"><a href="bayesian-inference.html#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate quantiles</span></span>
<span id="cb344-5"><a href="bayesian-inference.html#cb344-5" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(pars_sample<span class="sc">$</span>mu, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##     2.5%      50%    97.5% 
## 34.84848 42.42424 50.00000</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="bayesian-inference.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pars_sample)</span></code></pre></div>
<pre><code>##            mu    sigma
## 2429 42.42424 12.19697
## 2729 42.42424 13.70909
## 2631 45.45455 13.20505
## 3333 48.48485 16.73333
## 2732 46.96970 13.70909
## 2030 43.93939 10.18081</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="bayesian-inference.html#cb348-1" aria-hidden="true" tabindex="-1"></a>pred_iq <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, </span>
<span id="cb348-2"><a href="bayesian-inference.html#cb348-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">mean =</span> pars_sample<span class="sc">$</span>mu, </span>
<span id="cb348-3"><a href="bayesian-inference.html#cb348-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sd =</span> pars_sample<span class="sc">$</span>sigma)</span>
<span id="cb348-4"><a href="bayesian-inference.html#cb348-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-5"><a href="bayesian-inference.html#cb348-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability that zombi has IQ &gt; 60</span></span>
<span id="cb348-6"><a href="bayesian-inference.html#cb348-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pred_iq <span class="sc">&gt;=</span> <span class="dv">60</span>) <span class="sc">/</span> <span class="fu">length</span>(pred_iq)</span></code></pre></div>
<pre><code>## [1] 0.0837</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="bayesian-inference.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb350-2"><a href="bayesian-inference.html#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the mean IQ</span></span>
<span id="cb350-3"><a href="bayesian-inference.html#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pars_sample<span class="sc">$</span>mu, <span class="dv">100</span>)</span>
<span id="cb350-4"><a href="bayesian-inference.html#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize pred_iq</span></span>
<span id="cb350-5"><a href="bayesian-inference.html#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pred_iq)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
</div>
<div id="the-best-models" class="section level2" number="45.6">
<h2><span class="header-section-number">45.6</span> The BEST models</h2>
<p>The t-test is a classical statistical procedure used to compare the
means of two data sets.</p>
<p>In 2013 John Kruschke developed a souped-up Bayesian version of the
t-test he named <strong>BEST</strong> (standing for <strong>B</strong>ayesian <strong>E</strong>stimation <strong>S</strong>upersedes
the <strong>t</strong>-test).</p>
<p>We would like to compair IQ of two groups of 10 patiens on different diets (a and b).</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="bayesian-inference.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The IQ of patients.</span></span>
<span id="cb351-2"><a href="bayesian-inference.html#cb351-2" aria-hidden="true" tabindex="-1"></a>iq_a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">44</span>, <span class="dv">34</span>, <span class="dv">18</span>, <span class="dv">51</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="dv">49</span>, <span class="dv">48</span>, <span class="dv">46</span>)</span>
<span id="cb351-3"><a href="bayesian-inference.html#cb351-3" aria-hidden="true" tabindex="-1"></a>iq_b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">44</span>, <span class="dv">52</span>, <span class="dv">42</span>, <span class="dv">66</span>, <span class="dv">53</span>, <span class="dv">42</span>, <span class="dv">55</span>, <span class="dv">57</span>, <span class="dv">56</span>, <span class="dv">51</span>)</span>
<span id="cb351-4"><a href="bayesian-inference.html#cb351-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-5"><a href="bayesian-inference.html#cb351-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean difference in IQ between the two groups</span></span>
<span id="cb351-6"><a href="bayesian-inference.html#cb351-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(iq_b) <span class="sc">-</span> <span class="fu">mean</span>(iq_a)</span></code></pre></div>
<pre><code>## [1] 9.3</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="bayesian-inference.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(BEST)</span>
<span id="cb353-2"><a href="bayesian-inference.html#cb353-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-3"><a href="bayesian-inference.html#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the BEST model to the data from both groups</span></span>
<span id="cb353-4"><a href="bayesian-inference.html#cb353-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(BEST)</span>
<span id="cb353-5"><a href="bayesian-inference.html#cb353-5" aria-hidden="true" tabindex="-1"></a>best_posterior <span class="ot">&lt;-</span> BEST<span class="sc">::</span><span class="fu">BESTmcmc</span>(iq_b, iq_a)</span></code></pre></div>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="bayesian-inference.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the model result</span></span>
<span id="cb354-2"><a href="bayesian-inference.html#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(best_posterior)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
<p>The Bayesian model behind BEST assumes that the generative model for
the data is a <strong>t-distribution</strong>; a more flexible distribution than the normal
distribution as it assumes that data points might be outliers to some degree.
This makes BEST’s estimate of the mean difference robust to outliers in the data.</p>
<p><strong>Sources</strong></p>
<p><a href="https://learn.datacamp.com/courses/fundamentals-of-bayesian-data-analysis-in-r">Fundamentals of Bayesian Data Analysis in R on Datacamp</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-markov-process.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="naive-bayes-classifiers.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/70_bayesian_inference.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
