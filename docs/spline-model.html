<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 30 Spline model | R statistics</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 30 Spline model | R statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 30 Spline model | R statistics" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Mark Goldberg" />


<meta name="date" content="2021-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple-linear-regression.html"/>
<link rel="next" href="logistic-regression.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html"><i class="fa fa-check"></i><b>2</b> Statistics R functions reference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#get-data"><i class="fa fa-check"></i><b>2.1</b> Get data</a></li>
<li class="chapter" data-level="2.2" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#data-inspection"><i class="fa fa-check"></i><b>2.2</b> Data inspection</a></li>
<li class="chapter" data-level="2.3" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#plots"><i class="fa fa-check"></i><b>2.3</b> Plots</a></li>
<li class="chapter" data-level="2.4" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#analysis-of-the-distribution"><i class="fa fa-check"></i><b>2.4</b> Analysis of the distribution</a></li>
<li class="chapter" data-level="2.5" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#distributions"><i class="fa fa-check"></i><b>2.5</b> Distributions</a></li>
<li class="chapter" data-level="2.6" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#t-test"><i class="fa fa-check"></i><b>2.6</b> t-Test</a></li>
<li class="chapter" data-level="2.7" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#anova"><i class="fa fa-check"></i><b>2.7</b> ANOVA</a></li>
<li class="chapter" data-level="2.8" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#machine-learning-functions-reference"><i class="fa fa-check"></i><b>2.8</b> Machine Learning Functions Reference</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#linear-regression"><i class="fa fa-check"></i><b>2.8.1</b> Linear Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="combinatorics.html"><a href="combinatorics.html"><i class="fa fa-check"></i><b>3</b> Combinatorics</a></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Probability</a></li>
<li class="chapter" data-level="5" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>5</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="basic-statistics.html"><a href="basic-statistics.html#definitions"><i class="fa fa-check"></i><b>5.1</b> Definitions</a></li>
<li class="chapter" data-level="5.2" data-path="basic-statistics.html"><a href="basic-statistics.html#probability-1"><i class="fa fa-check"></i><b>5.2</b> Probability</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-distributions.html"><a href="statistical-distributions.html"><i class="fa fa-check"></i><b>6</b> Statistical distributions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistical-distributions.html"><a href="statistical-distributions.html#normal-distribution"><i class="fa fa-check"></i><b>6.1</b> Normal Distribution</a></li>
<li class="chapter" data-level="6.2" data-path="statistical-distributions.html"><a href="statistical-distributions.html#bernoulli-distribution"><i class="fa fa-check"></i><b>6.2</b> Bernoulli Distribution</a></li>
<li class="chapter" data-level="6.3" data-path="statistical-distributions.html"><a href="statistical-distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>6.3</b> Binomial Distribution</a></li>
<li class="chapter" data-level="6.4" data-path="statistical-distributions.html"><a href="statistical-distributions.html#beta-distribution"><i class="fa fa-check"></i><b>6.4</b> Beta distribution</a></li>
<li class="chapter" data-level="6.5" data-path="statistical-distributions.html"><a href="statistical-distributions.html#geometric-distribution"><i class="fa fa-check"></i><b>6.5</b> Geometric Distribution</a></li>
<li class="chapter" data-level="6.6" data-path="statistical-distributions.html"><a href="statistical-distributions.html#uniform-distributions"><i class="fa fa-check"></i><b>6.6</b> Uniform Distributions</a></li>
<li class="chapter" data-level="6.7" data-path="statistical-distributions.html"><a href="statistical-distributions.html#poisson-distribution"><i class="fa fa-check"></i><b>6.7</b> Poisson Distribution</a></li>
<li class="chapter" data-level="6.8" data-path="statistical-distributions.html"><a href="statistical-distributions.html#exponential-distribution"><i class="fa fa-check"></i><b>6.8</b> Exponential Distribution</a></li>
<li class="chapter" data-level="6.9" data-path="statistical-distributions.html"><a href="statistical-distributions.html#chi-squared-distribution"><i class="fa fa-check"></i><b>6.9</b> Chi-squared Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html"><i class="fa fa-check"></i><b>7</b> Primary data analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#analysis-of-sample-distribution"><i class="fa fa-check"></i><b>7.1</b> Analysis of sample distribution</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#histogram"><i class="fa fa-check"></i><b>7.1.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#handling-missing-data"><i class="fa fa-check"></i><b>7.2</b> Handling missing data</a></li>
<li class="chapter" data-level="7.3" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#dealing-with-outliers"><i class="fa fa-check"></i><b>7.3</b> Dealing with outliers</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-normalization.html"><a href="data-normalization.html"><i class="fa fa-check"></i><b>8</b> Data normalization</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-normalization.html"><a href="data-normalization.html#normality-test"><i class="fa fa-check"></i><b>8.1</b> Normality test</a></li>
<li class="chapter" data-level="8.2" data-path="data-normalization.html"><a href="data-normalization.html#finding-confidence-intervals"><i class="fa fa-check"></i><b>8.2</b> Finding Confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="primary-data-analysis-case-studies.html"><a href="primary-data-analysis-case-studies.html"><i class="fa fa-check"></i><b>9</b> Primary data analysis - Case studies</a></li>
<li class="chapter" data-level="10" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>10</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-theory"><i class="fa fa-check"></i><b>10.1</b> Hypothesis testing theory</a></li>
<li class="chapter" data-level="10.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-test-practice"><i class="fa fa-check"></i><b>10.2</b> Hypothesis test (Practice)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="t-procedures.html"><a href="t-procedures.html"><i class="fa fa-check"></i><b>11</b> t-Procedures</a>
<ul>
<li class="chapter" data-level="11.1" data-path="t-procedures.html"><a href="t-procedures.html#t-test-and-normal-distribution"><i class="fa fa-check"></i><b>11.1</b> t-test and normal distribution</a></li>
<li class="chapter" data-level="11.2" data-path="t-procedures.html"><a href="t-procedures.html#one-sample-t-test"><i class="fa fa-check"></i><b>11.2</b> One-sample t-test</a></li>
<li class="chapter" data-level="11.3" data-path="t-procedures.html"><a href="t-procedures.html#practical-example-t-test-in-r"><i class="fa fa-check"></i><b>11.3</b> Practical example: t-test in R</a></li>
<li class="chapter" data-level="11.4" data-path="t-procedures.html"><a href="t-procedures.html#two-samples-t-test"><i class="fa fa-check"></i><b>11.4</b> Two samples t-test</a></li>
<li class="chapter" data-level="11.5" data-path="t-procedures.html"><a href="t-procedures.html#compare-students-t-and-normal-distributions"><i class="fa fa-check"></i><b>11.5</b> Compare Student’s t and normal distributions</a></li>
<li class="chapter" data-level="11.6" data-path="t-procedures.html"><a href="t-procedures.html#non-parametric-tests"><i class="fa fa-check"></i><b>11.6</b> Non-parametric tests</a></li>
<li class="chapter" data-level="11.7" data-path="t-procedures.html"><a href="t-procedures.html#mann-whitney-u-rank-sum-test"><i class="fa fa-check"></i><b>11.7</b> Mann-Whitney U Rank Sum Test</a></li>
<li class="chapter" data-level="11.8" data-path="t-procedures.html"><a href="t-procedures.html#wilcoxon-test"><i class="fa fa-check"></i><b>11.8</b> Wilcoxon test</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="tests-for-categorical-variables.html"><a href="tests-for-categorical-variables.html"><i class="fa fa-check"></i><b>12</b> Tests for categorical variables</a>
<ul>
<li class="chapter" data-level="12.1" data-path="tests-for-categorical-variables.html"><a href="tests-for-categorical-variables.html#chi-squared-tests"><i class="fa fa-check"></i><b>12.1</b> Chi-squared tests</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multiple-testing.html"><a href="multiple-testing.html"><i class="fa fa-check"></i><b>13</b> Multiple testing</a>
<ul>
<li class="chapter" data-level="13.1" data-path="multiple-testing.html"><a href="multiple-testing.html#the-bonferroni-correction"><i class="fa fa-check"></i><b>13.1</b> The Bonferroni correction</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sources.html"><a href="sources.html"><i class="fa fa-check"></i><b>14</b> Sources</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sources.html"><a href="sources.html#t-test-1"><i class="fa fa-check"></i><b>14.1</b> t-test</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="sources.html"><a href="sources.html#two-tailed-test"><i class="fa fa-check"></i><b>14.1.1</b> Two-tailed test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="wilcoxon-signed-rank-test.html"><a href="wilcoxon-signed-rank-test.html"><i class="fa fa-check"></i><b>15</b> Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="16" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>16</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="16.1" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html#one-way-anova"><i class="fa fa-check"></i><b>16.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="16.2" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html#sources-1"><i class="fa fa-check"></i><b>16.2</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="t-test-anova-difference.html"><a href="t-test-anova-difference.html"><i class="fa fa-check"></i><b>17</b> t-test ANOVA difference</a></li>
<li class="chapter" data-level="18" data-path="chi-squared-test.html"><a href="chi-squared-test.html"><i class="fa fa-check"></i><b>18</b> Chi-squared test</a>
<ul>
<li class="chapter" data-level="18.1" data-path="chi-squared-test.html"><a href="chi-squared-test.html#multinomial-goodness-of-fit"><i class="fa fa-check"></i><b>18.1</b> Multinomial Goodness of Fit</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html"><i class="fa fa-check"></i><b>19</b> Non-parametric Methods</a>
<ul>
<li class="chapter" data-level="19.1" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#sign-test"><i class="fa fa-check"></i><b>19.1</b> Sign Test</a></li>
<li class="chapter" data-level="19.2" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#wilcoxon-signed-rank-test-1"><i class="fa fa-check"></i><b>19.2</b> Wilcoxon Signed-Rank Test</a></li>
<li class="chapter" data-level="19.3" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#mann-whitney-wilcoxon-test"><i class="fa fa-check"></i><b>19.3</b> Mann-Whitney-Wilcoxon Test</a></li>
<li class="chapter" data-level="19.4" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>19.4</b> Kruskal-Wallis Test</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>20</b> Correlation</a></li>
<li class="chapter" data-level="21" data-path="methods-and-algorithms-of-machine-learning.html"><a href="methods-and-algorithms-of-machine-learning.html"><i class="fa fa-check"></i><b>21</b> Methods and algorithms of machine learning</a></li>
<li class="chapter" data-level="22" data-path="split-data-into-train-and-test-subsets.html"><a href="split-data-into-train-and-test-subsets.html"><i class="fa fa-check"></i><b>22</b> Split data into train and test subsets</a></li>
<li class="chapter" data-level="23" data-path="estimate-model-accuracy.html"><a href="estimate-model-accuracy.html"><i class="fa fa-check"></i><b>23</b> Estimate model accuracy</a>
<ul>
<li class="chapter" data-level="23.1" data-path="estimate-model-accuracy.html"><a href="estimate-model-accuracy.html#continuous-variables"><i class="fa fa-check"></i><b>23.1</b> Continuous variables</a></li>
<li class="chapter" data-level="23.2" data-path="estimate-model-accuracy.html"><a href="estimate-model-accuracy.html#discret-variables"><i class="fa fa-check"></i><b>23.2</b> Discret variables</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="model-evaluation.html"><a href="model-evaluation.html"><i class="fa fa-check"></i><b>24</b> Model evaluation</a></li>
<li class="chapter" data-level="25" data-path="cross-validation-and-bootstrep.html"><a href="cross-validation-and-bootstrep.html"><i class="fa fa-check"></i><b>25</b> Cross-validation and Bootstrep</a></li>
<li class="chapter" data-level="26" data-path="linear-regression-1.html"><a href="linear-regression-1.html"><i class="fa fa-check"></i><b>26</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="26.1" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-regression---theory"><i class="fa fa-check"></i><b>26.1</b> Linear regression - theory</a></li>
<li class="chapter" data-level="26.2" data-path="linear-regression-1.html"><a href="linear-regression-1.html#generate-random-data-set-for-the-linear-model"><i class="fa fa-check"></i><b>26.2</b> Generate random data set for the linear model</a></li>
<li class="chapter" data-level="26.3" data-path="linear-regression-1.html"><a href="linear-regression-1.html#practical-example"><i class="fa fa-check"></i><b>26.3</b> Practical example</a></li>
<li class="chapter" data-level="26.4" data-path="linear-regression-1.html"><a href="linear-regression-1.html#mean-squared-error-mse"><i class="fa fa-check"></i><b>26.4</b> Mean squared error (MSE)</a></li>
<li class="chapter" data-level="26.5" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-model-in-r"><i class="fa fa-check"></i><b>26.5</b> Linear model in R</a></li>
<li class="chapter" data-level="26.6" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-regression-model-for-multiple-parameters"><i class="fa fa-check"></i><b>26.6</b> Linear regression model for multiple parameters</a></li>
<li class="chapter" data-level="26.7" data-path="linear-regression-1.html"><a href="linear-regression-1.html#choosing-explanatory-variables-for-the-model"><i class="fa fa-check"></i><b>26.7</b> Choosing explanatory variables for the model</a></li>
<li class="chapter" data-level="26.8" data-path="linear-regression-1.html"><a href="linear-regression-1.html#assessment-of-model-performance-for-categorical-data."><i class="fa fa-check"></i><b>26.8</b> Assessment of model performance for categorical data.</a></li>
<li class="chapter" data-level="26.9" data-path="linear-regression-1.html"><a href="linear-regression-1.html#confidence-intervals-for-linear-model"><i class="fa fa-check"></i><b>26.9</b> Confidence intervals for linear model</a></li>
<li class="chapter" data-level="26.10" data-path="linear-regression-1.html"><a href="linear-regression-1.html#practical-examples-for-linear-model-regression"><i class="fa fa-check"></i><b>26.10</b> Practical examples for linear model regression</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html"><i class="fa fa-check"></i><b>27</b> Linear regression complex cases</a>
<ul>
<li class="chapter" data-level="27.1" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#cars"><i class="fa fa-check"></i><b>27.1</b> Cars</a></li>
<li class="chapter" data-level="27.2" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#linear-regression-modeling-compair-with-knn"><i class="fa fa-check"></i><b>27.2</b> Linear regression modeling, compair with kNN</a></li>
<li class="chapter" data-level="27.3" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#more-complex-example"><i class="fa fa-check"></i><b>27.3</b> More complex example</a></li>
<li class="chapter" data-level="27.4" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#next-part"><i class="fa fa-check"></i><b>27.4</b> NEXT part</a></li>
<li class="chapter" data-level="27.5" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#next-part-1"><i class="fa fa-check"></i><b>27.5</b> NEXT Part</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>28</b> Nonlinear regression</a></li>
<li class="chapter" data-level="29" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>29</b> Multiple linear regression</a></li>
<li class="chapter" data-level="30" data-path="spline-model.html"><a href="spline-model.html"><i class="fa fa-check"></i><b>30</b> Spline model</a>
<ul>
<li class="chapter" data-level="30.1" data-path="spline-model.html"><a href="spline-model.html#splines"><i class="fa fa-check"></i><b>30.1</b> Splines</a></li>
<li class="chapter" data-level="30.2" data-path="spline-model.html"><a href="spline-model.html#area-under-the-curve-using-spline-method"><i class="fa fa-check"></i><b>30.2</b> Area under the curve using spline method</a></li>
<li class="chapter" data-level="30.3" data-path="spline-model.html"><a href="spline-model.html#set-data-using-given-function-and-predict-curve-using-spline-method"><i class="fa fa-check"></i><b>30.3</b> Set data using given function and predict curve using spline method</a></li>
<li class="chapter" data-level="30.4" data-path="spline-model.html"><a href="spline-model.html#generate-dataset-from-a-given-function"><i class="fa fa-check"></i><b>30.4</b> Generate dataset from a given function</a></li>
<li class="chapter" data-level="30.5" data-path="spline-model.html"><a href="spline-model.html#split-data-for-train-and-test"><i class="fa fa-check"></i><b>30.5</b> Split data for train and test</a></li>
<li class="chapter" data-level="30.6" data-path="spline-model.html"><a href="spline-model.html#diagram-of-the-given-function-and-generated-datasets"><i class="fa fa-check"></i><b>30.6</b> Diagram of the given function and generated datasets</a></li>
<li class="chapter" data-level="30.7" data-path="spline-model.html"><a href="spline-model.html#build-a-model-using-splines"><i class="fa fa-check"></i><b>30.7</b> Build a model using splines</a></li>
<li class="chapter" data-level="30.8" data-path="spline-model.html"><a href="spline-model.html#diagram-of-mse-for-train-and-test-data"><i class="fa fa-check"></i><b>30.8</b> Diagram of MSE for train and test data</a></li>
<li class="chapter" data-level="30.9" data-path="spline-model.html"><a href="spline-model.html#build-optimal-model-and-plot-for-the-model"><i class="fa fa-check"></i><b>30.9</b> Build optimal model and plot for the model</a></li>
<li class="chapter" data-level="30.10" data-path="spline-model.html"><a href="spline-model.html#bibliograpy"><i class="fa fa-check"></i><b>30.10</b> Bibliograpy</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>31</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="31.1" data-path="logistic-regression.html"><a href="logistic-regression.html#confusion-matrix"><i class="fa fa-check"></i><b>31.1</b> Confusion matrix</a></li>
<li class="chapter" data-level="31.2" data-path="logistic-regression.html"><a href="logistic-regression.html#next-part-2"><i class="fa fa-check"></i><b>31.2</b> Next part</a></li>
<li class="chapter" data-level="31.3" data-path="logistic-regression.html"><a href="logistic-regression.html#next-part-3"><i class="fa fa-check"></i><b>31.3</b> NExt part</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="models-for-binary-data.html"><a href="models-for-binary-data.html"><i class="fa fa-check"></i><b>32</b> Models for binary Data</a></li>
<li class="chapter" data-level="33" data-path="support-vector-machine.html"><a href="support-vector-machine.html"><i class="fa fa-check"></i><b>33</b> Support Vector Machine</a></li>
<li class="chapter" data-level="34" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>34</b> Clustering</a>
<ul>
<li class="chapter" data-level="34.1" data-path="clustering.html"><a href="clustering.html#finding-distances-using-factoextra"><i class="fa fa-check"></i><b>34.1</b> Finding distances using factoextra</a></li>
<li class="chapter" data-level="34.2" data-path="clustering.html"><a href="clustering.html#example-of-choosing-clustering-model"><i class="fa fa-check"></i><b>34.2</b> Example of choosing clustering model</a></li>
<li class="chapter" data-level="34.3" data-path="clustering.html"><a href="clustering.html#k-means-clustering"><i class="fa fa-check"></i><b>34.3</b> K-means clustering</a></li>
<li class="chapter" data-level="34.4" data-path="clustering.html"><a href="clustering.html#k-means"><i class="fa fa-check"></i><b>34.4</b> k-Means</a></li>
<li class="chapter" data-level="34.5" data-path="clustering.html"><a href="clustering.html#hierarchical-clustering"><i class="fa fa-check"></i><b>34.5</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="34.6" data-path="clustering.html"><a href="clustering.html#knn"><i class="fa fa-check"></i><b>34.6</b> KNN</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>35</b> Regularization</a></li>
<li class="chapter" data-level="36" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>36</b> Factor analysis</a></li>
<li class="chapter" data-level="37" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>37</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="38" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html"><i class="fa fa-check"></i><b>38</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="38.1" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html#basic-statistics-1"><i class="fa fa-check"></i><b>38.1</b> Basic statistics</a></li>
<li class="chapter" data-level="38.2" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html#basic-linear-algebra-matrices"><i class="fa fa-check"></i><b>38.2</b> Basic linear algebra (matrices)</a>
<ul>
<li class="chapter" data-level="38.2.1" data-path="principal-component-analysis-1.html"><a href="principal-component-analysis-1.html#t-sne---stochastic-neighbor-embedding"><i class="fa fa-check"></i><b>38.2.1</b> t-SNE - Stochastic Neighbor Embedding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="39" data-path="learning-vector-quantization.html"><a href="learning-vector-quantization.html"><i class="fa fa-check"></i><b>39</b> Learning Vector Quantization</a></li>
<li class="chapter" data-level="40" data-path="tree-based-models.html"><a href="tree-based-models.html"><i class="fa fa-check"></i><b>40</b> Tree-based models</a>
<ul>
<li class="chapter" data-level="40.1" data-path="tree-based-models.html"><a href="tree-based-models.html#classification-tree-example"><i class="fa fa-check"></i><b>40.1</b> Classification Tree example</a></li>
<li class="chapter" data-level="40.2" data-path="tree-based-models.html"><a href="tree-based-models.html#regression-tree-example"><i class="fa fa-check"></i><b>40.2</b> Regression Tree example</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>41</b> Random forest</a></li>
<li class="chapter" data-level="42" data-path="gradient-boosted-trees.html"><a href="gradient-boosted-trees.html"><i class="fa fa-check"></i><b>42</b> Gradient boosted trees</a></li>
<li class="chapter" data-level="43" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>43</b> Markov Chain Monte Carlo (MCMC)</a></li>
<li class="chapter" data-level="44" data-path="simple-markov-process.html"><a href="simple-markov-process.html"><i class="fa fa-check"></i><b>44</b> Simple Markov process</a>
<ul>
<li class="chapter" data-level="44.0.1" data-path="simple-markov-process.html"><a href="simple-markov-process.html#sources-2"><i class="fa fa-check"></i><b>44.0.1</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="45" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>45</b> Bayesian inference</a>
<ul>
<li class="chapter" data-level="45.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#simple-model-with-one-binary-parameter"><i class="fa fa-check"></i><b>45.1</b> Simple model with one binary parameter</a></li>
<li class="chapter" data-level="45.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#grid-approximation"><i class="fa fa-check"></i><b>45.2</b> Grid approximation</a></li>
<li class="chapter" data-level="45.3" data-path="bayesian-inference.html"><a href="bayesian-inference.html#grid-approximation-1"><i class="fa fa-check"></i><b>45.3</b> Grid approximation</a></li>
<li class="chapter" data-level="45.4" data-path="bayesian-inference.html"><a href="bayesian-inference.html#model-of-birth-weights-using-normal-distribution"><i class="fa fa-check"></i><b>45.4</b> Model of birth weights using normal distribution</a></li>
<li class="chapter" data-level="45.5" data-path="bayesian-inference.html"><a href="bayesian-inference.html#a-bayesian-model-of-zombie-iq"><i class="fa fa-check"></i><b>45.5</b> A Bayesian model of Zombie IQ</a></li>
<li class="chapter" data-level="45.6" data-path="bayesian-inference.html"><a href="bayesian-inference.html#the-best-models"><i class="fa fa-check"></i><b>45.6</b> The BEST models</a></li>
</ul></li>
<li class="chapter" data-level="46" data-path="naive-bayes-classifiers.html"><a href="naive-bayes-classifiers.html"><i class="fa fa-check"></i><b>46</b> Naive Bayes classifiers</a></li>
<li class="chapter" data-level="47" data-path="modeling-with-r-caret.html"><a href="modeling-with-r-caret.html"><i class="fa fa-check"></i><b>47</b> Modeling with R caret</a></li>
<li class="chapter" data-level="48" data-path="modeling-with-r-tensorflow.html"><a href="modeling-with-r-tensorflow.html"><i class="fa fa-check"></i><b>48</b> Modeling with R Tensorflow</a></li>
<li class="chapter" data-level="49" data-path="perceptron.html"><a href="perceptron.html"><i class="fa fa-check"></i><b>49</b> Perceptron</a></li>
<li class="chapter" data-level="50" data-path="deeplearning-r-h2o.html"><a href="deeplearning-r-h2o.html"><i class="fa fa-check"></i><b>50</b> Deeplearning R H2O</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spline-model" class="section level1" number="30">
<h1><span class="header-section-number">Chapter 30</span> Spline model</h1>
<div id="splines" class="section level2" number="30.1">
<h2><span class="header-section-number">30.1</span> Splines</h2>
</div>
<div id="area-under-the-curve-using-spline-method" class="section level2" number="30.2">
<h2><span class="header-section-number">30.2</span> Area under the curve using spline method</h2>
<p>Area under the plasma drug concentration-time curve
In the field of pharmacokinetics, the area under the curve (AUC) is the definite integral in a plot of drug concentration in blood plasma vs. time. In practice, the drug concentration is measured at certain discrete points in time and the trapezoidal rule is used to estimate AUC.
We can find spline curve and calculate area under the curve to improve the result and compair with trapezoidal method. The AUC represents the total drug exposure over time <a href="https://en.wikipedia.org/wiki/Area_under_the_curve_(pharmacokinetics)">(Wiki)</a>
.<br />
Data: Dependency of concentration (mg/L) from time (h).<br />
Aim: Plot curve and calculate the area under the curve</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="spline-model.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MESS)</span>
<span id="cb203-2"><a href="spline-model.html#cb203-2" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">24</span>,<span class="dv">36</span>,<span class="dv">48</span>,<span class="dv">72</span>)</span>
<span id="cb203-3"><a href="spline-model.html#cb203-3" aria-hidden="true" tabindex="-1"></a>conc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.36</span>,<span class="fl">9.35</span>,<span class="fl">17.18</span>,<span class="fl">25.78</span>,<span class="fl">29.78</span>,<span class="fl">26.63</span>,<span class="fl">19.4</span>,<span class="fl">13.26</span>,<span class="fl">5.88</span>,<span class="fl">2.56</span>,<span class="fl">0.49</span>)</span>
<span id="cb203-4"><a href="spline-model.html#cb203-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-5"><a href="spline-model.html#cb203-5" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">smooth.spline</span>(time, conc)</span>
<span id="cb203-6"><a href="spline-model.html#cb203-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-7"><a href="spline-model.html#cb203-7" aria-hidden="true" tabindex="-1"></a>predict.xy <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">x=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="fu">min</span>(time), <span class="at">to=</span><span class="fu">max</span>(time), <span class="at">by=</span>(<span class="fu">max</span>(time)<span class="sc">-</span><span class="fu">min</span>(time))<span class="sc">/</span>((<span class="fu">length</span>(time)<span class="sc">*</span><span class="dv">10</span>))))</span>
<span id="cb203-8"><a href="spline-model.html#cb203-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-9"><a href="spline-model.html#cb203-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(conc <span class="sc">~</span> time, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">xlab=</span><span class="st">&#39;Time, h&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Concentration, mg/L&#39;</span>)</span>
<span id="cb203-10"><a href="spline-model.html#cb203-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time, conc, <span class="at">col=</span><span class="st">&#39;green&#39;</span>)</span>
<span id="cb203-11"><a href="spline-model.html#cb203-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(predict.xy, <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="spline-model.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate area under the curve (auc)</span></span>
<span id="cb204-2"><a href="spline-model.html#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="co"># trapezoidal method</span></span>
<span id="cb204-3"><a href="spline-model.html#cb204-3" aria-hidden="true" tabindex="-1"></a>MESS<span class="sc">::</span><span class="fu">auc</span>(time, conc, <span class="at">from=</span><span class="fu">min</span>(time), <span class="at">to=</span><span class="fu">max</span>(time), <span class="at">type=</span><span class="st">&#39;linear&#39;</span>)</span></code></pre></div>
<pre><code>## [1] 721.9925</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="spline-model.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># spline with given data</span></span>
<span id="cb206-2"><a href="spline-model.html#cb206-2" aria-hidden="true" tabindex="-1"></a>MESS<span class="sc">::</span><span class="fu">auc</span>(time, conc, <span class="at">from=</span><span class="fu">min</span>(time), <span class="at">to=</span><span class="fu">max</span>(time), <span class="at">type=</span><span class="st">&#39;spline&#39;</span>)</span></code></pre></div>
<pre><code>## [1] 712.7034</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="spline-model.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># trapezoidal method with expanded set from predicted spline</span></span>
<span id="cb208-2"><a href="spline-model.html#cb208-2" aria-hidden="true" tabindex="-1"></a>MESS<span class="sc">::</span><span class="fu">auc</span>(predict.xy[[<span class="dv">1</span>]], <span class="at">from=</span><span class="fu">min</span>(time), <span class="at">to=</span><span class="fu">max</span>(time), predict.xy[[<span class="dv">2</span>]], <span class="at">type=</span><span class="st">&#39;linear&#39;</span>)</span></code></pre></div>
<pre><code>## [1] 712.4289</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="spline-model.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># spline from expanded with spline</span></span>
<span id="cb210-2"><a href="spline-model.html#cb210-2" aria-hidden="true" tabindex="-1"></a>MESS<span class="sc">::</span><span class="fu">auc</span>(predict.xy[[<span class="dv">1</span>]], <span class="at">from=</span><span class="fu">min</span>(time), <span class="at">to=</span><span class="fu">max</span>(time), predict.xy[[<span class="dv">2</span>]], <span class="at">type=</span><span class="st">&#39;spline&#39;</span>)</span></code></pre></div>
<pre><code>## [1] 712.7106</code></pre>
</div>
<div id="set-data-using-given-function-and-predict-curve-using-spline-method" class="section level2" number="30.3">
<h2><span class="header-section-number">30.3</span> Set data using given function and predict curve using spline method</h2>
<p>Aim: Generate random data with noise <span class="math inline">\(y = f(x) + \epsilon\)</span> from function <span class="math inline">\(f(x)=4-0.02x+0.0055x^2-4.9*10^{-5}x^3; \epsilon ~ N(0,1)\)</span><br />
Make a model using spline method.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="spline-model.html#cb212-1" aria-hidden="true" tabindex="-1"></a>my.seed <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb212-2"><a href="spline-model.html#cb212-2" aria-hidden="true" tabindex="-1"></a>n.all <span class="ot">&lt;-</span> <span class="dv">100</span>    <span class="co"># amount of elements</span></span>
<span id="cb212-3"><a href="spline-model.html#cb212-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-4"><a href="spline-model.html#cb212-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-5"><a href="spline-model.html#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set x values</span></span>
<span id="cb212-6"><a href="spline-model.html#cb212-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my.seed)</span>
<span id="cb212-7"><a href="spline-model.html#cb212-7" aria-hidden="true" tabindex="-1"></a>x.min <span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb212-8"><a href="spline-model.html#cb212-8" aria-hidden="true" tabindex="-1"></a>x.max <span class="ot">&lt;-</span> <span class="dv">105</span></span>
<span id="cb212-9"><a href="spline-model.html#cb212-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n.all, x.min, x.max) <span class="co"># set rundom x from 5 to 105 with n elements</span></span>
<span id="cb212-10"><a href="spline-model.html#cb212-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-11"><a href="spline-model.html#cb212-11" aria-hidden="true" tabindex="-1"></a><span class="co"># noise</span></span>
<span id="cb212-12"><a href="spline-model.html#cb212-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my.seed)</span>
<span id="cb212-13"><a href="spline-model.html#cb212-13" aria-hidden="true" tabindex="-1"></a>noise.sd <span class="ot">&lt;-</span><span class="dv">1</span>    <span class="co"># noise standard deviation</span></span>
<span id="cb212-14"><a href="spline-model.html#cb212-14" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>noise.sd, <span class="at">n=</span>n.all)</span>
<span id="cb212-15"><a href="spline-model.html#cb212-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-16"><a href="spline-model.html#cb212-16" aria-hidden="true" tabindex="-1"></a><span class="co"># subset train data</span></span>
<span id="cb212-17"><a href="spline-model.html#cb212-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my.seed)</span>
<span id="cb212-18"><a href="spline-model.html#cb212-18" aria-hidden="true" tabindex="-1"></a>train.percent <span class="ot">&lt;-</span> <span class="fl">0.85</span>   <span class="co"># percent of train data</span></span>
<span id="cb212-19"><a href="spline-model.html#cb212-19" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_along</span>(x), <span class="at">size=</span>(train.percent<span class="sc">*</span>n.all))</span>
<span id="cb212-20"><a href="spline-model.html#cb212-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-21"><a href="spline-model.html#cb212-21" aria-hidden="true" tabindex="-1"></a><span class="co"># true function y=f(x)</span></span>
<span id="cb212-22"><a href="spline-model.html#cb212-22" aria-hidden="true" tabindex="-1"></a>y.func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="dv">4</span> <span class="sc">-</span> <span class="fl">2e-02</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fl">5.5e-03</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="fl">4.9e-05</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>}</span>
<span id="cb212-23"><a href="spline-model.html#cb212-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-24"><a href="spline-model.html#cb212-24" aria-hidden="true" tabindex="-1"></a><span class="co"># for plot of true values</span></span>
<span id="cb212-25"><a href="spline-model.html#cb212-25" aria-hidden="true" tabindex="-1"></a>x.line <span class="ot">&lt;-</span> <span class="fu">seq</span>(x.min, x.max, <span class="at">length=</span>n.all)</span>
<span id="cb212-26"><a href="spline-model.html#cb212-26" aria-hidden="true" tabindex="-1"></a>y.line <span class="ot">&lt;-</span> <span class="fu">y.func</span>(x.line)</span>
<span id="cb212-27"><a href="spline-model.html#cb212-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-28"><a href="spline-model.html#cb212-28" aria-hidden="true" tabindex="-1"></a><span class="co"># true function with noise</span></span>
<span id="cb212-29"><a href="spline-model.html#cb212-29" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">y.func</span>(x) <span class="sc">+</span> noise</span>
<span id="cb212-30"><a href="spline-model.html#cb212-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-31"><a href="spline-model.html#cb212-31" aria-hidden="true" tabindex="-1"></a><span class="co"># train values</span></span>
<span id="cb212-32"><a href="spline-model.html#cb212-32" aria-hidden="true" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> x[inTrain]</span>
<span id="cb212-33"><a href="spline-model.html#cb212-33" aria-hidden="true" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> y[inTrain]</span>
<span id="cb212-34"><a href="spline-model.html#cb212-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-35"><a href="spline-model.html#cb212-35" aria-hidden="true" tabindex="-1"></a><span class="co"># test values</span></span>
<span id="cb212-36"><a href="spline-model.html#cb212-36" aria-hidden="true" tabindex="-1"></a>x.test <span class="ot">&lt;-</span> x[<span class="sc">-</span>inTrain]</span>
<span id="cb212-37"><a href="spline-model.html#cb212-37" aria-hidden="true" tabindex="-1"></a>y.test <span class="ot">&lt;-</span> y[<span class="sc">-</span>inTrain]</span>
<span id="cb212-38"><a href="spline-model.html#cb212-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-39"><a href="spline-model.html#cb212-39" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb212-40"><a href="spline-model.html#cb212-40" aria-hidden="true" tabindex="-1"></a>x.lim <span class="ot">&lt;-</span> <span class="fu">c</span>(x.min, x.max)</span>
<span id="cb212-41"><a href="spline-model.html#cb212-41" aria-hidden="true" tabindex="-1"></a>y.lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(y), <span class="fu">max</span>(y))</span>
<span id="cb212-42"><a href="spline-model.html#cb212-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-43"><a href="spline-model.html#cb212-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.train, y.train, </span>
<span id="cb212-44"><a href="spline-model.html#cb212-44" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="at">bg =</span> <span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb212-45"><a href="spline-model.html#cb212-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;X&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Y&#39;</span>, </span>
<span id="cb212-46"><a href="spline-model.html#cb212-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> x.lim, <span class="at">ylim =</span> y.lim, </span>
<span id="cb212-47"><a href="spline-model.html#cb212-47" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.2</span>, <span class="at">cex.lab =</span> <span class="fl">1.2</span>, <span class="at">cex.axis =</span> <span class="fl">1.2</span>)</span>
<span id="cb212-48"><a href="spline-model.html#cb212-48" aria-hidden="true" tabindex="-1"></a><span class="co"># test data</span></span>
<span id="cb212-49"><a href="spline-model.html#cb212-49" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x.test, y.test, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">bg =</span> <span class="st">&#39;red&#39;</span>, <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb212-50"><a href="spline-model.html#cb212-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-51"><a href="spline-model.html#cb212-51" aria-hidden="true" tabindex="-1"></a><span class="co"># true function</span></span>
<span id="cb212-52"><a href="spline-model.html#cb212-52" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x.line, y.line, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb212-53"><a href="spline-model.html#cb212-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-54"><a href="spline-model.html#cb212-54" aria-hidden="true" tabindex="-1"></a><span class="co"># legend</span></span>
<span id="cb212-55"><a href="spline-model.html#cb212-55" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;train&#39;</span>, <span class="st">&#39;test&#39;</span>, <span class="st">&#39;f(X)&#39;</span>),</span>
<span id="cb212-56"><a href="spline-model.html#cb212-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">16</span>, <span class="cn">NA</span>), </span>
<span id="cb212-57"><a href="spline-model.html#cb212-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="st">&#39;red&#39;</span>, <span class="st">&#39;black&#39;</span>),  </span>
<span id="cb212-58"><a href="spline-model.html#cb212-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-71-1.png" width="672" />
## Splain model
As a model of given data we will use splains with degree of freedom from 2 (line) to 60 (number of knots is equal 2/3 from number of values).</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="spline-model.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  build spline model with degrees of freedom df=6</span></span>
<span id="cb213-2"><a href="spline-model.html#cb213-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">smooth.spline</span>(<span class="at">x =</span> x.train, <span class="at">y =</span> y.train, <span class="at">df =</span> <span class="dv">6</span>)</span>
<span id="cb213-3"><a href="spline-model.html#cb213-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-4"><a href="spline-model.html#cb213-4" aria-hidden="true" tabindex="-1"></a><span class="co"># model values for calculation of errors</span></span>
<span id="cb213-5"><a href="spline-model.html#cb213-5" aria-hidden="true" tabindex="-1"></a>y.model.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="fu">data.frame</span>(<span class="at">x =</span> x.train))<span class="sc">$</span>y[, <span class="dv">1</span>]</span>
<span id="cb213-6"><a href="spline-model.html#cb213-6" aria-hidden="true" tabindex="-1"></a>y.model.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="fu">data.frame</span>(<span class="at">x =</span> x.test))<span class="sc">$</span>y[, <span class="dv">1</span>]</span>
<span id="cb213-7"><a href="spline-model.html#cb213-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-8"><a href="spline-model.html#cb213-8" aria-hidden="true" tabindex="-1"></a><span class="co"># sum of squared errors</span></span>
<span id="cb213-9"><a href="spline-model.html#cb213-9" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sum</span>((y.train <span class="sc">-</span> y.model.train)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(x.train),</span>
<span id="cb213-10"><a href="spline-model.html#cb213-10" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sum</span>((y.test <span class="sc">-</span> y.model.test)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(x.test))</span>
<span id="cb213-11"><a href="spline-model.html#cb213-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(MSE) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;train&#39;</span>, <span class="st">&#39;test&#39;</span>)</span>
<span id="cb213-12"><a href="spline-model.html#cb213-12" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(MSE, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## train  test 
##  0.71  1.00</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="spline-model.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  build models with degree of freedoms from df 2 to 60</span></span>
<span id="cb215-2"><a href="spline-model.html#cb215-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-3"><a href="spline-model.html#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="co"># максимальное число степеней свободы для модели сплайна</span></span>
<span id="cb215-4"><a href="spline-model.html#cb215-4" aria-hidden="true" tabindex="-1"></a>max.df <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb215-5"><a href="spline-model.html#cb215-5" aria-hidden="true" tabindex="-1"></a>tbl <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">df =</span> <span class="dv">2</span><span class="sc">:</span>max.df)   <span class="co"># таблица для записи ошибок</span></span>
<span id="cb215-6"><a href="spline-model.html#cb215-6" aria-hidden="true" tabindex="-1"></a>tbl<span class="sc">$</span>MSE.train <span class="ot">&lt;-</span> <span class="dv">0</span>                 <span class="co"># столбец: ошибки на обучающей выборке</span></span>
<span id="cb215-7"><a href="spline-model.html#cb215-7" aria-hidden="true" tabindex="-1"></a>tbl<span class="sc">$</span>MSE.test <span class="ot">&lt;-</span> <span class="dv">0</span>                  <span class="co"># столбец: ошибки на тестовой выборке</span></span>
<span id="cb215-8"><a href="spline-model.html#cb215-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-9"><a href="spline-model.html#cb215-9" aria-hidden="true" tabindex="-1"></a><span class="co"># for each degree of freedom</span></span>
<span id="cb215-10"><a href="spline-model.html#cb215-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>max.df) {</span>
<span id="cb215-11"><a href="spline-model.html#cb215-11" aria-hidden="true" tabindex="-1"></a>    mod <span class="ot">&lt;-</span> <span class="fu">smooth.spline</span>(<span class="at">x =</span> x.train, <span class="at">y =</span> y.train, <span class="at">df =</span> i)</span>
<span id="cb215-12"><a href="spline-model.html#cb215-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-13"><a href="spline-model.html#cb215-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># model for train and test data</span></span>
<span id="cb215-14"><a href="spline-model.html#cb215-14" aria-hidden="true" tabindex="-1"></a>    y.model.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="fu">data.frame</span>(<span class="at">x =</span> x.train))<span class="sc">$</span>y[, <span class="dv">1</span>]</span>
<span id="cb215-15"><a href="spline-model.html#cb215-15" aria-hidden="true" tabindex="-1"></a>    y.model.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="fu">data.frame</span>(<span class="at">x =</span> x.test))<span class="sc">$</span>y[, <span class="dv">1</span>]</span>
<span id="cb215-16"><a href="spline-model.html#cb215-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-17"><a href="spline-model.html#cb215-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># errors for train and learn data</span></span>
<span id="cb215-18"><a href="spline-model.html#cb215-18" aria-hidden="true" tabindex="-1"></a>    MSE <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sum</span>((y.train <span class="sc">-</span> y.model.train)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(x.train),</span>
<span id="cb215-19"><a href="spline-model.html#cb215-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">sum</span>((y.test <span class="sc">-</span> y.model.test)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(x.test))</span>
<span id="cb215-20"><a href="spline-model.html#cb215-20" aria-hidden="true" tabindex="-1"></a>    tbl[tbl<span class="sc">$</span>df <span class="sc">==</span> i, <span class="fu">c</span>(<span class="st">&#39;MSE.train&#39;</span>, <span class="st">&#39;MSE.test&#39;</span>)] <span class="ot">&lt;-</span> MSE</span>
<span id="cb215-21"><a href="spline-model.html#cb215-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb215-22"><a href="spline-model.html#cb215-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-23"><a href="spline-model.html#cb215-23" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tbl)</span></code></pre></div>
<pre><code>##   df MSE.train  MSE.test
## 1  2 3.6484333 3.3336892
## 2  3 1.5185881 1.1532857
## 3  4 0.8999800 0.8874002
## 4  5 0.7477105 0.9483290
## 5  6 0.7127908 1.0038393
## 6  7 0.7000429 1.0300354</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="spline-model.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Diagram: dependence of MSE from moedel flexibility</span></span>
<span id="cb217-2"><a href="spline-model.html#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> tbl<span class="sc">$</span>df, <span class="at">y =</span> tbl<span class="sc">$</span>MSE.test, </span>
<span id="cb217-3"><a href="spline-model.html#cb217-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb217-4"><a href="spline-model.html#cb217-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Degree of freedom&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;MSE&#39;</span>,</span>
<span id="cb217-5"><a href="spline-model.html#cb217-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(tbl<span class="sc">$</span>MSE.train, tbl<span class="sc">$</span>MSE.test), </span>
<span id="cb217-6"><a href="spline-model.html#cb217-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">max</span>(tbl<span class="sc">$</span>MSE.train, tbl<span class="sc">$</span>MSE.test)),</span>
<span id="cb217-7"><a href="spline-model.html#cb217-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.2</span>, <span class="at">cex.lab =</span> <span class="fl">1.2</span>, <span class="at">cex.axis =</span> <span class="fl">1.2</span>)</span>
<span id="cb217-8"><a href="spline-model.html#cb217-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-9"><a href="spline-model.html#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="co"># head of plot</span></span>
<span id="cb217-10"><a href="spline-model.html#cb217-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Dependence of MSE from degree of freedom&#39;</span>, <span class="at">side =</span> <span class="dv">3</span>)</span>
<span id="cb217-11"><a href="spline-model.html#cb217-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> tbl<span class="sc">$</span>df, <span class="at">y =</span> tbl<span class="sc">$</span>MSE.test, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">bg =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb217-12"><a href="spline-model.html#cb217-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> tbl<span class="sc">$</span>df, <span class="at">y =</span> tbl<span class="sc">$</span>MSE.train, <span class="at">col =</span> <span class="fu">grey</span>(<span class="fl">0.3</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb217-13"><a href="spline-model.html#cb217-13" aria-hidden="true" tabindex="-1"></a><span class="co"># неустранимая ошибка</span></span>
<span id="cb217-14"><a href="spline-model.html#cb217-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> noise.sd, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">grey</span>(<span class="fl">0.4</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb217-15"><a href="spline-model.html#cb217-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-16"><a href="spline-model.html#cb217-16" aria-hidden="true" tabindex="-1"></a><span class="co"># легенда</span></span>
<span id="cb217-17"><a href="spline-model.html#cb217-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;обучающая&#39;</span>, <span class="st">&#39;тестовая&#39;</span>),</span>
<span id="cb217-18"><a href="spline-model.html#cb217-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">16</span>), </span>
<span id="cb217-19"><a href="spline-model.html#cb217-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="st">&#39;red&#39;</span>),  </span>
<span id="cb217-20"><a href="spline-model.html#cb217-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb217-21"><a href="spline-model.html#cb217-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-22"><a href="spline-model.html#cb217-22" aria-hidden="true" tabindex="-1"></a><span class="co"># степени свободы у наименьшей ошибки на тестовой выборке</span></span>
<span id="cb217-23"><a href="spline-model.html#cb217-23" aria-hidden="true" tabindex="-1"></a>min.MSE.test <span class="ot">&lt;-</span> <span class="fu">min</span>(tbl<span class="sc">$</span>MSE.test)</span>
<span id="cb217-24"><a href="spline-model.html#cb217-24" aria-hidden="true" tabindex="-1"></a>df.min.MSE.test <span class="ot">&lt;-</span> tbl[tbl<span class="sc">$</span>MSE.test <span class="sc">==</span> min.MSE.test, <span class="st">&#39;df&#39;</span>]</span>
<span id="cb217-25"><a href="spline-model.html#cb217-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-26"><a href="spline-model.html#cb217-26" aria-hidden="true" tabindex="-1"></a><span class="co"># компромисс между точностью и простотой модели по графику</span></span>
<span id="cb217-27"><a href="spline-model.html#cb217-27" aria-hidden="true" tabindex="-1"></a>df.my.MSE.test <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb217-28"><a href="spline-model.html#cb217-28" aria-hidden="true" tabindex="-1"></a>my.MSE.test <span class="ot">&lt;-</span> tbl[tbl<span class="sc">$</span>df <span class="sc">==</span> df.my.MSE.test, <span class="st">&#39;MSE.test&#39;</span>]</span>
<span id="cb217-29"><a href="spline-model.html#cb217-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-30"><a href="spline-model.html#cb217-30" aria-hidden="true" tabindex="-1"></a><span class="co"># ставим точку на графике</span></span>
<span id="cb217-31"><a href="spline-model.html#cb217-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> df.my.MSE.test, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb217-32"><a href="spline-model.html#cb217-32" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> df.my.MSE.test, <span class="at">y =</span> my.MSE.test, <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb217-33"><a href="spline-model.html#cb217-33" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(df.my.MSE.test, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">at =</span> df.my.MSE.test, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="spline-model.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  График 3: Лучшая модель (компромисс между гибкостью и точностью) ############</span></span>
<span id="cb218-2"><a href="spline-model.html#cb218-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-3"><a href="spline-model.html#cb218-3" aria-hidden="true" tabindex="-1"></a>mod.MSE.test <span class="ot">&lt;-</span> <span class="fu">smooth.spline</span>(<span class="at">x =</span> x.train, <span class="at">y =</span> y.train, <span class="at">df =</span> df.my.MSE.test)</span>
<span id="cb218-4"><a href="spline-model.html#cb218-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-5"><a href="spline-model.html#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="co"># для гладких графиков модели</span></span>
<span id="cb218-6"><a href="spline-model.html#cb218-6" aria-hidden="true" tabindex="-1"></a>x.model.plot <span class="ot">&lt;-</span> <span class="fu">seq</span>(x.min, x.max, <span class="at">length =</span> <span class="dv">250</span>)</span>
<span id="cb218-7"><a href="spline-model.html#cb218-7" aria-hidden="true" tabindex="-1"></a>y.model.plot <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod.MSE.test, <span class="fu">data.frame</span>(<span class="at">x =</span> x.model.plot))<span class="sc">$</span>y[, <span class="dv">1</span>]</span>
<span id="cb218-8"><a href="spline-model.html#cb218-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-9"><a href="spline-model.html#cb218-9" aria-hidden="true" tabindex="-1"></a><span class="co"># убираем широкие поля рисунка</span></span>
<span id="cb218-10"><a href="spline-model.html#cb218-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb218-11"><a href="spline-model.html#cb218-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-12"><a href="spline-model.html#cb218-12" aria-hidden="true" tabindex="-1"></a><span class="co"># наименьшие/наибольшие значения по осям</span></span>
<span id="cb218-13"><a href="spline-model.html#cb218-13" aria-hidden="true" tabindex="-1"></a>x.lim <span class="ot">&lt;-</span> <span class="fu">c</span>(x.min, x.max)</span>
<span id="cb218-14"><a href="spline-model.html#cb218-14" aria-hidden="true" tabindex="-1"></a>y.lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(y), <span class="fu">max</span>(y))</span>
<span id="cb218-15"><a href="spline-model.html#cb218-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-16"><a href="spline-model.html#cb218-16" aria-hidden="true" tabindex="-1"></a><span class="co"># наблюдения с шумом (обучающая выборка)</span></span>
<span id="cb218-17"><a href="spline-model.html#cb218-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.train, y.train, </span>
<span id="cb218-18"><a href="spline-model.html#cb218-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="at">bg =</span> <span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb218-19"><a href="spline-model.html#cb218-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;X&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Y&#39;</span>, </span>
<span id="cb218-20"><a href="spline-model.html#cb218-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> x.lim, <span class="at">ylim =</span> y.lim, </span>
<span id="cb218-21"><a href="spline-model.html#cb218-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.2</span>, <span class="at">cex.lab =</span> <span class="fl">1.2</span>, <span class="at">cex.axis =</span> <span class="fl">1.2</span>)</span>
<span id="cb218-22"><a href="spline-model.html#cb218-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-23"><a href="spline-model.html#cb218-23" aria-hidden="true" tabindex="-1"></a><span class="co"># head of the plot</span></span>
<span id="cb218-24"><a href="spline-model.html#cb218-24" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Initial data and the best fit model&#39;</span>, <span class="at">side =</span> <span class="dv">3</span>)</span>
<span id="cb218-25"><a href="spline-model.html#cb218-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-26"><a href="spline-model.html#cb218-26" aria-hidden="true" tabindex="-1"></a><span class="co"># test values</span></span>
<span id="cb218-27"><a href="spline-model.html#cb218-27" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x.test, y.test, </span>
<span id="cb218-28"><a href="spline-model.html#cb218-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">bg =</span> <span class="st">&#39;red&#39;</span>, <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb218-29"><a href="spline-model.html#cb218-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-30"><a href="spline-model.html#cb218-30" aria-hidden="true" tabindex="-1"></a><span class="co"># true function</span></span>
<span id="cb218-31"><a href="spline-model.html#cb218-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x.line, y.line, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb218-32"><a href="spline-model.html#cb218-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-33"><a href="spline-model.html#cb218-33" aria-hidden="true" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb218-34"><a href="spline-model.html#cb218-34" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x.model.plot, y.model.plot, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb218-35"><a href="spline-model.html#cb218-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-36"><a href="spline-model.html#cb218-36" aria-hidden="true" tabindex="-1"></a><span class="co"># legend</span></span>
<span id="cb218-37"><a href="spline-model.html#cb218-37" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;train&#39;</span>, <span class="st">&#39;test&#39;</span>, <span class="st">&#39;f(X)&#39;</span>, <span class="st">&#39;model&#39;</span>),</span>
<span id="cb218-38"><a href="spline-model.html#cb218-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span>), </span>
<span id="cb218-39"><a href="spline-model.html#cb218-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="st">&#39;red&#39;</span>, <span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>),  </span>
<span id="cb218-40"><a href="spline-model.html#cb218-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-72-2.png" width="672" />
In interpolating problems, spline interpolation is often preferred to polynomial interpolation because it yields similar results, even when using low degree polynomials, while avoiding Runge’s phenomenon for higher degrees.</p>
<p>=======</p>
<p>In this example we will generate data from a given function and then build a model using splines and estimate quality of the model.</p>
</div>
<div id="generate-dataset-from-a-given-function" class="section level2" number="30.4">
<h2><span class="header-section-number">30.4</span> Generate dataset from a given function</h2>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="spline-model.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters to generate a dataset</span></span>
<span id="cb219-2"><a href="spline-model.html#cb219-2" aria-hidden="true" tabindex="-1"></a>n.all <span class="ot">&lt;-</span> <span class="dv">100</span>             <span class="co"># number of observations</span></span>
<span id="cb219-3"><a href="spline-model.html#cb219-3" aria-hidden="true" tabindex="-1"></a>train.percent <span class="ot">&lt;-</span> <span class="fl">0.85</span>    <span class="co"># portion of the data for training</span></span>
<span id="cb219-4"><a href="spline-model.html#cb219-4" aria-hidden="true" tabindex="-1"></a>res.sd <span class="ot">&lt;-</span> <span class="dv">1</span>              <span class="co"># standard deviation of noise</span></span>
<span id="cb219-5"><a href="spline-model.html#cb219-5" aria-hidden="true" tabindex="-1"></a>x.min <span class="ot">&lt;-</span> <span class="dv">5</span>               <span class="co"># min limit of the data</span></span>
<span id="cb219-6"><a href="spline-model.html#cb219-6" aria-hidden="true" tabindex="-1"></a>x.max <span class="ot">&lt;-</span> <span class="dv">105</span>             <span class="co"># max limit of the data</span></span>
<span id="cb219-7"><a href="spline-model.html#cb219-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-8"><a href="spline-model.html#cb219-8" aria-hidden="true" tabindex="-1"></a><span class="co"># generate x</span></span>
<span id="cb219-9"><a href="spline-model.html#cb219-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)       <span class="co"># to get reproducible results by randomizer</span></span>
<span id="cb219-10"><a href="spline-model.html#cb219-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(x.min, x.max, <span class="at">n =</span> n.all)</span>
<span id="cb219-11"><a href="spline-model.html#cb219-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-12"><a href="spline-model.html#cb219-12" aria-hidden="true" tabindex="-1"></a><span class="co"># noise from normal destibution</span></span>
<span id="cb219-13"><a href="spline-model.html#cb219-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb219-14"><a href="spline-model.html#cb219-14" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> res.sd, <span class="at">n =</span> n.all)</span>
<span id="cb219-15"><a href="spline-model.html#cb219-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-16"><a href="spline-model.html#cb219-16" aria-hidden="true" tabindex="-1"></a><span class="co"># generate y using a given function</span></span>
<span id="cb219-17"><a href="spline-model.html#cb219-17" aria-hidden="true" tabindex="-1"></a>y.func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="dv">4</span> <span class="sc">-</span> <span class="fl">2e-02</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fl">5.5e-03</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="fl">4.9e-05</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>}</span>
<span id="cb219-18"><a href="spline-model.html#cb219-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-19"><a href="spline-model.html#cb219-19" aria-hidden="true" tabindex="-1"></a><span class="co"># add noise</span></span>
<span id="cb219-20"><a href="spline-model.html#cb219-20" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">y.func</span>(x) <span class="sc">+</span> res</span></code></pre></div>
</div>
<div id="split-data-for-train-and-test" class="section level2" number="30.5">
<h2><span class="header-section-number">30.5</span> Split data for train and test</h2>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="spline-model.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split dataset for training and test</span></span>
<span id="cb220-2"><a href="spline-model.html#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb220-3"><a href="spline-model.html#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate vector of chosen x for train data</span></span>
<span id="cb220-4"><a href="spline-model.html#cb220-4" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_along</span>(x), <span class="at">size =</span> train.percent<span class="sc">*</span>n.all)</span>
<span id="cb220-5"><a href="spline-model.html#cb220-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-6"><a href="spline-model.html#cb220-6" aria-hidden="true" tabindex="-1"></a><span class="co"># train data set</span></span>
<span id="cb220-7"><a href="spline-model.html#cb220-7" aria-hidden="true" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> x[inTrain]</span>
<span id="cb220-8"><a href="spline-model.html#cb220-8" aria-hidden="true" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> y[inTrain]</span>
<span id="cb220-9"><a href="spline-model.html#cb220-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-10"><a href="spline-model.html#cb220-10" aria-hidden="true" tabindex="-1"></a><span class="co"># test data set</span></span>
<span id="cb220-11"><a href="spline-model.html#cb220-11" aria-hidden="true" tabindex="-1"></a>x.test <span class="ot">&lt;-</span> x[<span class="sc">-</span>inTrain]</span>
<span id="cb220-12"><a href="spline-model.html#cb220-12" aria-hidden="true" tabindex="-1"></a>y.test <span class="ot">&lt;-</span> y[<span class="sc">-</span>inTrain]</span></code></pre></div>
</div>
<div id="diagram-of-the-given-function-and-generated-datasets" class="section level2" number="30.6">
<h2><span class="header-section-number">30.6</span> Diagram of the given function and generated datasets</h2>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="spline-model.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lines of generated data for plot</span></span>
<span id="cb221-2"><a href="spline-model.html#cb221-2" aria-hidden="true" tabindex="-1"></a>x.line <span class="ot">&lt;-</span> <span class="fu">seq</span>(x.min, x.max, <span class="at">length =</span> n.all)</span>
<span id="cb221-3"><a href="spline-model.html#cb221-3" aria-hidden="true" tabindex="-1"></a>y.line <span class="ot">&lt;-</span> <span class="fu">y.func</span>(x.line)</span>
<span id="cb221-4"><a href="spline-model.html#cb221-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-5"><a href="spline-model.html#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT</span></span>
<span id="cb221-6"><a href="spline-model.html#cb221-6" aria-hidden="true" tabindex="-1"></a><span class="co"># generate plot by train data</span></span>
<span id="cb221-7"><a href="spline-model.html#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># reduce margins (optional)</span></span>
<span id="cb221-8"><a href="spline-model.html#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.train, y.train,</span>
<span id="cb221-9"><a href="spline-model.html#cb221-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&#39;Generated data and original function&#39;</span>,</span>
<span id="cb221-10"><a href="spline-model.html#cb221-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="at">bg =</span> <span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb221-11"><a href="spline-model.html#cb221-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;X&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Y&#39;</span>, </span>
<span id="cb221-12"><a href="spline-model.html#cb221-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(x.min, x.max),</span>
<span id="cb221-13"><a href="spline-model.html#cb221-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(y), <span class="fu">max</span>(y)), </span>
<span id="cb221-14"><a href="spline-model.html#cb221-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.2</span>, <span class="at">cex.lab =</span> <span class="fl">1.2</span>, <span class="at">cex.axis =</span> <span class="fl">1.2</span>)</span>
<span id="cb221-15"><a href="spline-model.html#cb221-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-16"><a href="spline-model.html#cb221-16" aria-hidden="true" tabindex="-1"></a><span class="co"># add points of test data</span></span>
<span id="cb221-17"><a href="spline-model.html#cb221-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x.test, y.test, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">bg =</span> <span class="st">&#39;red&#39;</span>, <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb221-18"><a href="spline-model.html#cb221-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-19"><a href="spline-model.html#cb221-19" aria-hidden="true" tabindex="-1"></a><span class="co"># add the given function</span></span>
<span id="cb221-20"><a href="spline-model.html#cb221-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x.line, y.line, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb221-21"><a href="spline-model.html#cb221-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-22"><a href="spline-model.html#cb221-22" aria-hidden="true" tabindex="-1"></a><span class="co"># add legend</span></span>
<span id="cb221-23"><a href="spline-model.html#cb221-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;train&#39;</span>, <span class="st">&#39;test&#39;</span>, <span class="st">&#39;f(X)&#39;</span>),</span>
<span id="cb221-24"><a href="spline-model.html#cb221-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">16</span>, <span class="cn">NA</span>), </span>
<span id="cb221-25"><a href="spline-model.html#cb221-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="st">&#39;red&#39;</span>, <span class="st">&#39;black&#39;</span>),  </span>
<span id="cb221-26"><a href="spline-model.html#cb221-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
</div>
<div id="build-a-model-using-splines" class="section level2" number="30.7">
<h2><span class="header-section-number">30.7</span> Build a model using splines</h2>
<p>We will compair sevaral models with degree of freedoms (df) from 2 to 40, where 2 correspond to a linear model.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="spline-model.html#cb222-1" aria-hidden="true" tabindex="-1"></a>max.df <span class="ot">&lt;-</span> <span class="dv">40</span>                       <span class="co"># max degree of freedom (df)</span></span>
<span id="cb222-2"><a href="spline-model.html#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb222-3"><a href="spline-model.html#cb222-3" aria-hidden="true" tabindex="-1"></a>tbl <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">df =</span> <span class="dv">2</span><span class="sc">:</span>max.df)   <span class="co"># data frame for writing errors</span></span>
<span id="cb222-4"><a href="spline-model.html#cb222-4" aria-hidden="true" tabindex="-1"></a>tbl<span class="sc">$</span>MSE.train <span class="ot">&lt;-</span> <span class="dv">0</span>                 <span class="co"># column 1: errors of train data</span></span>
<span id="cb222-5"><a href="spline-model.html#cb222-5" aria-hidden="true" tabindex="-1"></a>tbl<span class="sc">$</span>MSE.test <span class="ot">&lt;-</span> <span class="dv">0</span>                  <span class="co"># сcolumn 2: errors of test data</span></span>
<span id="cb222-6"><a href="spline-model.html#cb222-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-7"><a href="spline-model.html#cb222-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generate models using for cycle</span></span>
<span id="cb222-8"><a href="spline-model.html#cb222-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>max.df) {</span>
<span id="cb222-9"><a href="spline-model.html#cb222-9" aria-hidden="true" tabindex="-1"></a>    mod <span class="ot">&lt;-</span> <span class="fu">smooth.spline</span>(<span class="at">x =</span> x.train, <span class="at">y =</span> y.train, <span class="at">df =</span> i)</span>
<span id="cb222-10"><a href="spline-model.html#cb222-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb222-11"><a href="spline-model.html#cb222-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># predicted values for train and test data using built model</span></span>
<span id="cb222-12"><a href="spline-model.html#cb222-12" aria-hidden="true" tabindex="-1"></a>    y.model.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="fu">data.frame</span>(<span class="at">x =</span> x.train))<span class="sc">$</span>y[, <span class="dv">1</span>]</span>
<span id="cb222-13"><a href="spline-model.html#cb222-13" aria-hidden="true" tabindex="-1"></a>    y.model.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="fu">data.frame</span>(<span class="at">x =</span> x.test))<span class="sc">$</span>y[, <span class="dv">1</span>]</span>
<span id="cb222-14"><a href="spline-model.html#cb222-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb222-15"><a href="spline-model.html#cb222-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MSE errors for train and test data</span></span>
<span id="cb222-16"><a href="spline-model.html#cb222-16" aria-hidden="true" tabindex="-1"></a>    MSE <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sum</span>((y.train <span class="sc">-</span> y.model.train)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(x.train),</span>
<span id="cb222-17"><a href="spline-model.html#cb222-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">sum</span>((y.test <span class="sc">-</span> y.model.test)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(x.test))</span>
<span id="cb222-18"><a href="spline-model.html#cb222-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb222-19"><a href="spline-model.html#cb222-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># write errors to the previously created data frame</span></span>
<span id="cb222-20"><a href="spline-model.html#cb222-20" aria-hidden="true" tabindex="-1"></a>    tbl[tbl<span class="sc">$</span>df <span class="sc">==</span> i, <span class="fu">c</span>(<span class="st">&#39;MSE.train&#39;</span>, <span class="st">&#39;MSE.test&#39;</span>)] <span class="ot">&lt;-</span> MSE</span>
<span id="cb222-21"><a href="spline-model.html#cb222-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb222-22"><a href="spline-model.html#cb222-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-23"><a href="spline-model.html#cb222-23" aria-hidden="true" tabindex="-1"></a><span class="co"># view first rows of the table</span></span>
<span id="cb222-24"><a href="spline-model.html#cb222-24" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tbl, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##   df MSE.train  MSE.test
## 1  2 3.6484333 3.3336892
## 2  3 1.5185881 1.1532857
## 3  4 0.8999800 0.8874002
## 4  5 0.7477105 0.9483290</code></pre>
</div>
<div id="diagram-of-mse-for-train-and-test-data" class="section level2" number="30.8">
<h2><span class="header-section-number">30.8</span> Diagram of MSE for train and test data</h2>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="spline-model.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot MSE from our table</span></span>
<span id="cb224-2"><a href="spline-model.html#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> tbl<span class="sc">$</span>df, <span class="at">y =</span> tbl<span class="sc">$</span>MSE.test,</span>
<span id="cb224-3"><a href="spline-model.html#cb224-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Changes of MSE from degrees of freedom&quot;</span>,</span>
<span id="cb224-4"><a href="spline-model.html#cb224-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb224-5"><a href="spline-model.html#cb224-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;spline degree of freedom&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;MSE&#39;</span>,</span>
<span id="cb224-6"><a href="spline-model.html#cb224-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(tbl<span class="sc">$</span>MSE.train, tbl<span class="sc">$</span>MSE.test), </span>
<span id="cb224-7"><a href="spline-model.html#cb224-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">max</span>(tbl<span class="sc">$</span>MSE.train, tbl<span class="sc">$</span>MSE.test)),</span>
<span id="cb224-8"><a href="spline-model.html#cb224-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.2</span>, <span class="at">cex.lab =</span> <span class="fl">1.2</span>, <span class="at">cex.axis =</span> <span class="fl">1.2</span>)</span>
<span id="cb224-9"><a href="spline-model.html#cb224-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-10"><a href="spline-model.html#cb224-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add </span></span>
<span id="cb224-11"><a href="spline-model.html#cb224-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> tbl<span class="sc">$</span>df, <span class="at">y =</span> tbl<span class="sc">$</span>MSE.test,</span>
<span id="cb224-12"><a href="spline-model.html#cb224-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">bg =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb224-13"><a href="spline-model.html#cb224-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> tbl<span class="sc">$</span>df, <span class="at">y =</span> tbl<span class="sc">$</span>MSE.train, <span class="at">col =</span> <span class="fu">grey</span>(<span class="fl">0.3</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb224-14"><a href="spline-model.html#cb224-14" aria-hidden="true" tabindex="-1"></a><span class="co"># minimal MSE</span></span>
<span id="cb224-15"><a href="spline-model.html#cb224-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> res.sd, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">grey</span>(<span class="fl">0.4</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb224-16"><a href="spline-model.html#cb224-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-17"><a href="spline-model.html#cb224-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add legend</span></span>
<span id="cb224-18"><a href="spline-model.html#cb224-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;train&#39;</span>, <span class="st">&#39;test&#39;</span>),</span>
<span id="cb224-19"><a href="spline-model.html#cb224-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">16</span>), </span>
<span id="cb224-20"><a href="spline-model.html#cb224-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="st">&#39;red&#39;</span>),  </span>
<span id="cb224-21"><a href="spline-model.html#cb224-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb224-22"><a href="spline-model.html#cb224-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-23"><a href="spline-model.html#cb224-23" aria-hidden="true" tabindex="-1"></a><span class="co"># df of minimal MSE for test data</span></span>
<span id="cb224-24"><a href="spline-model.html#cb224-24" aria-hidden="true" tabindex="-1"></a>min.MSE.test <span class="ot">&lt;-</span> <span class="fu">min</span>(tbl<span class="sc">$</span>MSE.test)</span>
<span id="cb224-25"><a href="spline-model.html#cb224-25" aria-hidden="true" tabindex="-1"></a>df.min.MSE.test <span class="ot">&lt;-</span> tbl[tbl<span class="sc">$</span>MSE.test <span class="sc">==</span> min.MSE.test, <span class="st">&#39;df&#39;</span>]</span>
<span id="cb224-26"><a href="spline-model.html#cb224-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-27"><a href="spline-model.html#cb224-27" aria-hidden="true" tabindex="-1"></a><span class="co"># optimal df for precise model and maximal simplicity</span></span>
<span id="cb224-28"><a href="spline-model.html#cb224-28" aria-hidden="true" tabindex="-1"></a>df.my.MSE.test <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb224-29"><a href="spline-model.html#cb224-29" aria-hidden="true" tabindex="-1"></a>my.MSE.test <span class="ot">&lt;-</span> tbl[tbl<span class="sc">$</span>df <span class="sc">==</span> df.my.MSE.test, <span class="st">&#39;MSE.test&#39;</span>]</span>
<span id="cb224-30"><a href="spline-model.html#cb224-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-31"><a href="spline-model.html#cb224-31" aria-hidden="true" tabindex="-1"></a><span class="co"># show the optimal solution</span></span>
<span id="cb224-32"><a href="spline-model.html#cb224-32" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> df.my.MSE.test, </span>
<span id="cb224-33"><a href="spline-model.html#cb224-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb224-34"><a href="spline-model.html#cb224-34" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> df.my.MSE.test, <span class="at">y =</span> my.MSE.test, </span>
<span id="cb224-35"><a href="spline-model.html#cb224-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb224-36"><a href="spline-model.html#cb224-36" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(df.my.MSE.test, </span>
<span id="cb224-37"><a href="spline-model.html#cb224-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">at =</span> df.my.MSE.test, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
</div>
<div id="build-optimal-model-and-plot-for-the-model" class="section level2" number="30.9">
<h2><span class="header-section-number">30.9</span> Build optimal model and plot for the model</h2>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="spline-model.html#cb225-1" aria-hidden="true" tabindex="-1"></a>mod.MSE.test <span class="ot">&lt;-</span> <span class="fu">smooth.spline</span>(<span class="at">x =</span> x.train, <span class="at">y =</span> y.train, <span class="at">df =</span> df.my.MSE.test)</span>
<span id="cb225-2"><a href="spline-model.html#cb225-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-3"><a href="spline-model.html#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co"># predict data for 250 x&#39;s to get smoothed curve</span></span>
<span id="cb225-4"><a href="spline-model.html#cb225-4" aria-hidden="true" tabindex="-1"></a>x.model.plot <span class="ot">&lt;-</span> <span class="fu">seq</span>(x.min, x.max, <span class="at">length =</span> <span class="dv">250</span>)</span>
<span id="cb225-5"><a href="spline-model.html#cb225-5" aria-hidden="true" tabindex="-1"></a>y.model.plot <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod.MSE.test, <span class="fu">data.frame</span>(<span class="at">x =</span> x.model.plot))<span class="sc">$</span>y[, <span class="dv">1</span>]</span>
<span id="cb225-6"><a href="spline-model.html#cb225-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-7"><a href="spline-model.html#cb225-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot train data</span></span>
<span id="cb225-8"><a href="spline-model.html#cb225-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb225-9"><a href="spline-model.html#cb225-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.train, y.train,</span>
<span id="cb225-10"><a href="spline-model.html#cb225-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Initial data and the best fit model&quot;</span>,</span>
<span id="cb225-11"><a href="spline-model.html#cb225-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="at">bg =</span> <span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb225-12"><a href="spline-model.html#cb225-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;X&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Y&#39;</span>, </span>
<span id="cb225-13"><a href="spline-model.html#cb225-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(x.min, x.max),</span>
<span id="cb225-14"><a href="spline-model.html#cb225-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(y), <span class="fu">max</span>(y)), </span>
<span id="cb225-15"><a href="spline-model.html#cb225-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.2</span>, <span class="at">cex.lab =</span> <span class="fl">1.2</span>, <span class="at">cex.axis =</span> <span class="fl">1.2</span>)</span>
<span id="cb225-16"><a href="spline-model.html#cb225-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-17"><a href="spline-model.html#cb225-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add test data</span></span>
<span id="cb225-18"><a href="spline-model.html#cb225-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x.test, y.test, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">bg =</span> <span class="st">&#39;red&#39;</span>, <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb225-19"><a href="spline-model.html#cb225-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-20"><a href="spline-model.html#cb225-20" aria-hidden="true" tabindex="-1"></a><span class="co"># function</span></span>
<span id="cb225-21"><a href="spline-model.html#cb225-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x.line, y.line,<span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb225-22"><a href="spline-model.html#cb225-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-23"><a href="spline-model.html#cb225-23" aria-hidden="true" tabindex="-1"></a><span class="co"># add model</span></span>
<span id="cb225-24"><a href="spline-model.html#cb225-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x.model.plot, y.model.plot, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb225-25"><a href="spline-model.html#cb225-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-26"><a href="spline-model.html#cb225-26" aria-hidden="true" tabindex="-1"></a><span class="co"># legend</span></span>
<span id="cb225-27"><a href="spline-model.html#cb225-27" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;train&#39;</span>, <span class="st">&#39;test&#39;</span>, <span class="st">&#39;f(X)&#39;</span>, <span class="st">&#39;model&#39;</span>),</span>
<span id="cb225-28"><a href="spline-model.html#cb225-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span>), </span>
<span id="cb225-29"><a href="spline-model.html#cb225-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">grey</span>(<span class="fl">0.2</span>), <span class="st">&#39;red&#39;</span>, <span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>),  </span>
<span id="cb225-30"><a href="spline-model.html#cb225-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
</div>
<div id="bibliograpy" class="section level2" number="30.10">
<h2><span class="header-section-number">30.10</span> Bibliograpy</h2>
<p><a href="http://faculty.marshall.usc.edu/gareth-james/">An Introduction to Statistical Learning by Gareth James</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="logistic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/37_spline_model.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
