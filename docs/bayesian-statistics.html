<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 31 Bayesian Statistics | R statistics</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 31 Bayesian Statistics | R statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 31 Bayesian Statistics | R statistics" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Mark Goldberg" />


<meta name="date" content="2021-05-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="learning-vector-quantization.html"/>
<link rel="next" href="naive-bayes.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html"><i class="fa fa-check"></i><b>2</b> Statistics R functions reference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#get-data"><i class="fa fa-check"></i><b>2.1</b> Get data</a></li>
<li class="chapter" data-level="2.2" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#data-inspection"><i class="fa fa-check"></i><b>2.2</b> Data inspection</a></li>
<li class="chapter" data-level="2.3" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#plots"><i class="fa fa-check"></i><b>2.3</b> Plots</a></li>
<li class="chapter" data-level="2.4" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#analysis-of-the-distribution"><i class="fa fa-check"></i><b>2.4</b> Analysis of the distribution</a></li>
<li class="chapter" data-level="2.5" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#distributions"><i class="fa fa-check"></i><b>2.5</b> Distributions</a></li>
<li class="chapter" data-level="2.6" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#t-test"><i class="fa fa-check"></i><b>2.6</b> t-Test</a></li>
<li class="chapter" data-level="2.7" data-path="statistics-r-functions-reference.html"><a href="statistics-r-functions-reference.html#anova"><i class="fa fa-check"></i><b>2.7</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>3</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-statistics.html"><a href="basic-statistics.html#definitions"><i class="fa fa-check"></i><b>3.1</b> Definitions</a></li>
<li class="chapter" data-level="3.2" data-path="basic-statistics.html"><a href="basic-statistics.html#probability"><i class="fa fa-check"></i><b>3.2</b> Probability</a></li>
<li class="chapter" data-level="3.3" data-path="basic-statistics.html"><a href="basic-statistics.html#analysis-of-sample-distribution"><i class="fa fa-check"></i><b>3.3</b> Analysis of sample distribution</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basic-statistics.html"><a href="basic-statistics.html#histogram"><i class="fa fa-check"></i><b>3.3.1</b> Histogram</a></li>
<li class="chapter" data-level="3.3.2" data-path="basic-statistics.html"><a href="basic-statistics.html#outliers"><i class="fa fa-check"></i><b>3.3.2</b> Outliers</a></li>
<li class="chapter" data-level="3.3.3" data-path="basic-statistics.html"><a href="basic-statistics.html#normality"><i class="fa fa-check"></i><b>3.3.3</b> Normality</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basic-statistics.html"><a href="basic-statistics.html#confidence-interval"><i class="fa fa-check"></i><b>3.4</b> Confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="primary-data-analysis-case-studies.html"><a href="primary-data-analysis-case-studies.html"><i class="fa fa-check"></i><b>4</b> Primary data analysis - Case studies</a></li>
<li class="chapter" data-level="5" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html"><i class="fa fa-check"></i><b>5</b> Primary data analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#handling-missing-data"><i class="fa fa-check"></i><b>5.1</b> Handling missing data</a></li>
<li class="chapter" data-level="5.2" data-path="primary-data-analysis.html"><a href="primary-data-analysis.html#dealing-with-outliers"><i class="fa fa-check"></i><b>5.2</b> Dealing with outliers</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-normalization.html"><a href="data-normalization.html"><i class="fa fa-check"></i><b>6</b> Data normalization</a></li>
<li class="chapter" data-level="7" data-path="statistical-distributions.html"><a href="statistical-distributions.html"><i class="fa fa-check"></i><b>7</b> Statistical distributions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistical-distributions.html"><a href="statistical-distributions.html#normal-distribution"><i class="fa fa-check"></i><b>7.1</b> Normal Distribution</a></li>
<li class="chapter" data-level="7.2" data-path="statistical-distributions.html"><a href="statistical-distributions.html#bernoulli-distribution"><i class="fa fa-check"></i><b>7.2</b> Bernoulli Distribution</a></li>
<li class="chapter" data-level="7.3" data-path="statistical-distributions.html"><a href="statistical-distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>7.3</b> Binomial Distribution</a></li>
<li class="chapter" data-level="7.4" data-path="statistical-distributions.html"><a href="statistical-distributions.html#beta-distribution"><i class="fa fa-check"></i><b>7.4</b> Beta distribution</a></li>
<li class="chapter" data-level="7.5" data-path="statistical-distributions.html"><a href="statistical-distributions.html#geometric-distribution"><i class="fa fa-check"></i><b>7.5</b> Geometric Distribution</a></li>
<li class="chapter" data-level="7.6" data-path="statistical-distributions.html"><a href="statistical-distributions.html#uniform-distributions"><i class="fa fa-check"></i><b>7.6</b> Uniform Distributions</a></li>
<li class="chapter" data-level="7.7" data-path="statistical-distributions.html"><a href="statistical-distributions.html#poisson-distribution"><i class="fa fa-check"></i><b>7.7</b> Poisson Distribution</a></li>
<li class="chapter" data-level="7.8" data-path="statistical-distributions.html"><a href="statistical-distributions.html#exponential-distribution"><i class="fa fa-check"></i><b>7.8</b> Exponential Distribution</a></li>
<li class="chapter" data-level="7.9" data-path="statistical-distributions.html"><a href="statistical-distributions.html#chi-squared-distribution"><i class="fa fa-check"></i><b>7.9</b> Chi-squared Distribution</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>8</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-theory"><i class="fa fa-check"></i><b>8.1</b> Hypothesis testing theory</a></li>
<li class="chapter" data-level="8.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-test-practice"><i class="fa fa-check"></i><b>8.2</b> Hypothesis test (Practice)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="t-procedures.html"><a href="t-procedures.html"><i class="fa fa-check"></i><b>9</b> t-Procedures</a>
<ul>
<li class="chapter" data-level="9.1" data-path="t-procedures.html"><a href="t-procedures.html#t-test-and-normal-distribution"><i class="fa fa-check"></i><b>9.1</b> t-test and normal distribution</a></li>
<li class="chapter" data-level="9.2" data-path="t-procedures.html"><a href="t-procedures.html#one-sample-t-test"><i class="fa fa-check"></i><b>9.2</b> One-sample t-test</a></li>
<li class="chapter" data-level="9.3" data-path="t-procedures.html"><a href="t-procedures.html#practical-example-t-test-in-r"><i class="fa fa-check"></i><b>9.3</b> Practical example: t-test in R</a></li>
<li class="chapter" data-level="9.4" data-path="t-procedures.html"><a href="t-procedures.html#two-samples-t-test"><i class="fa fa-check"></i><b>9.4</b> Two samples t-test</a></li>
<li class="chapter" data-level="9.5" data-path="t-procedures.html"><a href="t-procedures.html#compare-students-t-and-normal-distributions"><i class="fa fa-check"></i><b>9.5</b> Compare Student’s t and normal distributions</a></li>
<li class="chapter" data-level="9.6" data-path="t-procedures.html"><a href="t-procedures.html#non-parametric-tests"><i class="fa fa-check"></i><b>9.6</b> Non-parametric tests</a></li>
<li class="chapter" data-level="9.7" data-path="t-procedures.html"><a href="t-procedures.html#mann-whitney-u-rank-sum-test"><i class="fa fa-check"></i><b>9.7</b> Mann-Whitney U Rank Sum Test</a></li>
<li class="chapter" data-level="9.8" data-path="t-procedures.html"><a href="t-procedures.html#wilcoxon-test"><i class="fa fa-check"></i><b>9.8</b> Wilcoxon test</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tests-for-categorical-variables.html"><a href="tests-for-categorical-variables.html"><i class="fa fa-check"></i><b>10</b> Tests for categorical variables</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tests-for-categorical-variables.html"><a href="tests-for-categorical-variables.html#chi-squared-tests"><i class="fa fa-check"></i><b>10.1</b> Chi-squared tests</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multiple-testing.html"><a href="multiple-testing.html"><i class="fa fa-check"></i><b>11</b> Multiple testing</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multiple-testing.html"><a href="multiple-testing.html#the-bonferroni-correction"><i class="fa fa-check"></i><b>11.1</b> The Bonferroni correction</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sources.html"><a href="sources.html"><i class="fa fa-check"></i><b>12</b> Sources</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sources.html"><a href="sources.html#t-test-1"><i class="fa fa-check"></i><b>12.1</b> t-test</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="sources.html"><a href="sources.html#two-tailed-test"><i class="fa fa-check"></i><b>12.1.1</b> Two-tailed test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>13</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html#one-way-anova"><i class="fa fa-check"></i><b>13.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="13.2" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html#sources-1"><i class="fa fa-check"></i><b>13.2</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="t-test-anova-difference.html"><a href="t-test-anova-difference.html"><i class="fa fa-check"></i><b>14</b> t-test ANOVA difference</a></li>
<li class="chapter" data-level="15" data-path="chi-squared-test.html"><a href="chi-squared-test.html"><i class="fa fa-check"></i><b>15</b> Chi-squared test</a>
<ul>
<li class="chapter" data-level="15.1" data-path="chi-squared-test.html"><a href="chi-squared-test.html#multinomial-goodness-of-fit"><i class="fa fa-check"></i><b>15.1</b> Multinomial Goodness of Fit</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html"><i class="fa fa-check"></i><b>16</b> Non-parametric Methods</a>
<ul>
<li class="chapter" data-level="16.1" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#sign-test"><i class="fa fa-check"></i><b>16.1</b> Sign Test</a></li>
<li class="chapter" data-level="16.2" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>16.2</b> Wilcoxon Signed-Rank Test</a></li>
<li class="chapter" data-level="16.3" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#mann-whitney-wilcoxon-test"><i class="fa fa-check"></i><b>16.3</b> Mann-Whitney-Wilcoxon Test</a></li>
<li class="chapter" data-level="16.4" data-path="non-parametric-methods.html"><a href="non-parametric-methods.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>16.4</b> Kruskal-Wallis Test</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="wilcoxon-signed-rank-test-1.html"><a href="wilcoxon-signed-rank-test-1.html"><i class="fa fa-check"></i><b>17</b> Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="18" data-path="support-vector-machine.html"><a href="support-vector-machine.html"><i class="fa fa-check"></i><b>18</b> Support Vector Machine</a></li>
<li class="chapter" data-level="19" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>19</b> Correlation</a></li>
<li class="chapter" data-level="20" data-path="methods-and-algorithms-of-machine-learning.html"><a href="methods-and-algorithms-of-machine-learning.html"><i class="fa fa-check"></i><b>20</b> Methods and algorithms of machine learning</a></li>
<li class="chapter" data-level="21" data-path="machine-learning-functions-reference.html"><a href="machine-learning-functions-reference.html"><i class="fa fa-check"></i><b>21</b> Machine Learning Functions Reference</a>
<ul>
<li class="chapter" data-level="21.1" data-path="machine-learning-functions-reference.html"><a href="machine-learning-functions-reference.html#linear-regression"><i class="fa fa-check"></i><b>21.1</b> Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="split-data-into-train-and-test-subsets.html"><a href="split-data-into-train-and-test-subsets.html"><i class="fa fa-check"></i><b>22</b> Split data into train and test subsets</a></li>
<li class="chapter" data-level="23" data-path="linear-regression-1.html"><a href="linear-regression-1.html"><i class="fa fa-check"></i><b>23</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="23.1" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-regression---theory"><i class="fa fa-check"></i><b>23.1</b> Linear regression - theory</a></li>
<li class="chapter" data-level="23.2" data-path="linear-regression-1.html"><a href="linear-regression-1.html#generate-random-data-set-for-the-linear-model"><i class="fa fa-check"></i><b>23.2</b> Generate random data set for the linear model</a></li>
<li class="chapter" data-level="23.3" data-path="linear-regression-1.html"><a href="linear-regression-1.html#practical-example"><i class="fa fa-check"></i><b>23.3</b> Practical example</a></li>
<li class="chapter" data-level="23.4" data-path="linear-regression-1.html"><a href="linear-regression-1.html#mean-squared-error-mse"><i class="fa fa-check"></i><b>23.4</b> Mean squared error (MSE)</a></li>
<li class="chapter" data-level="23.5" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-model-in-r"><i class="fa fa-check"></i><b>23.5</b> Linear model in R</a></li>
<li class="chapter" data-level="23.6" data-path="linear-regression-1.html"><a href="linear-regression-1.html#linear-regression-model-for-multiple-parameters"><i class="fa fa-check"></i><b>23.6</b> Linear regression model for multiple parameters</a></li>
<li class="chapter" data-level="23.7" data-path="linear-regression-1.html"><a href="linear-regression-1.html#choosing-explanatory-variables-for-the-model"><i class="fa fa-check"></i><b>23.7</b> Choosing explanatory variables for the model</a></li>
<li class="chapter" data-level="23.8" data-path="linear-regression-1.html"><a href="linear-regression-1.html#assessment-of-model-performance-for-categorical-data."><i class="fa fa-check"></i><b>23.8</b> Assessment of model performance for categorical data.</a></li>
<li class="chapter" data-level="23.9" data-path="linear-regression-1.html"><a href="linear-regression-1.html#confidence-intervals-for-linear-model"><i class="fa fa-check"></i><b>23.9</b> Confidence intervals for linear model</a></li>
<li class="chapter" data-level="23.10" data-path="linear-regression-1.html"><a href="linear-regression-1.html#practical-examples-for-linear-model-regression"><i class="fa fa-check"></i><b>23.10</b> Practical examples for linear model regression</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html"><i class="fa fa-check"></i><b>24</b> Linear regression complex cases</a>
<ul>
<li class="chapter" data-level="24.1" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#cars"><i class="fa fa-check"></i><b>24.1</b> Cars</a></li>
<li class="chapter" data-level="24.2" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#linear-regression-modeling-compair-with-knn"><i class="fa fa-check"></i><b>24.2</b> Linear regression modeling, compair with kNN</a></li>
<li class="chapter" data-level="24.3" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#more-complex-example"><i class="fa fa-check"></i><b>24.3</b> More complex example</a></li>
<li class="chapter" data-level="24.4" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#next-part"><i class="fa fa-check"></i><b>24.4</b> NEXT part</a></li>
<li class="chapter" data-level="24.5" data-path="linear-regression-complex-cases.html"><a href="linear-regression-complex-cases.html#next-part-1"><i class="fa fa-check"></i><b>24.5</b> NEXT Part</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>25</b> Nonlinear regression</a></li>
<li class="chapter" data-level="26" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>26</b> Multiple linear regression</a></li>
<li class="chapter" data-level="27" data-path="spline-model.html"><a href="spline-model.html"><i class="fa fa-check"></i><b>27</b> Spline model</a>
<ul>
<li class="chapter" data-level="27.1" data-path="spline-model.html"><a href="spline-model.html#generate-dataset-from-a-given-function"><i class="fa fa-check"></i><b>27.1</b> Generate dataset from a given function</a></li>
<li class="chapter" data-level="27.2" data-path="spline-model.html"><a href="spline-model.html#split-data-for-train-and-test"><i class="fa fa-check"></i><b>27.2</b> Split data for train and test</a></li>
<li class="chapter" data-level="27.3" data-path="spline-model.html"><a href="spline-model.html#diagram-of-the-given-function-and-generated-datasets"><i class="fa fa-check"></i><b>27.3</b> Diagram of the given function and generated datasets</a></li>
<li class="chapter" data-level="27.4" data-path="spline-model.html"><a href="spline-model.html#build-a-model-using-splines"><i class="fa fa-check"></i><b>27.4</b> Build a model using splines</a></li>
<li class="chapter" data-level="27.5" data-path="spline-model.html"><a href="spline-model.html#diagram-of-mse-for-train-and-test-data"><i class="fa fa-check"></i><b>27.5</b> Diagram of MSE for train and test data</a></li>
<li class="chapter" data-level="27.6" data-path="spline-model.html"><a href="spline-model.html#build-optimal-model-and-plot-for-the-model"><i class="fa fa-check"></i><b>27.6</b> Build optimal model and plot for the model</a></li>
<li class="chapter" data-level="27.7" data-path="spline-model.html"><a href="spline-model.html#bibliograpy"><i class="fa fa-check"></i><b>27.7</b> Bibliograpy</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>28</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="28.1" data-path="logistic-regression.html"><a href="logistic-regression.html#confusion-matrix"><i class="fa fa-check"></i><b>28.1</b> Confusion matrix</a></li>
<li class="chapter" data-level="28.2" data-path="logistic-regression.html"><a href="logistic-regression.html#next-part-2"><i class="fa fa-check"></i><b>28.2</b> Next part</a></li>
<li class="chapter" data-level="28.3" data-path="logistic-regression.html"><a href="logistic-regression.html#next-part-3"><i class="fa fa-check"></i><b>28.3</b> NExt part</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>29</b> Clustering</a>
<ul>
<li class="chapter" data-level="29.1" data-path="clustering.html"><a href="clustering.html#next-part-4"><i class="fa fa-check"></i><b>29.1</b> Next part</a></li>
<li class="chapter" data-level="29.2" data-path="clustering.html"><a href="clustering.html#example"><i class="fa fa-check"></i><b>29.2</b> Example</a></li>
<li class="chapter" data-level="29.3" data-path="clustering.html"><a href="clustering.html#next-part-5"><i class="fa fa-check"></i><b>29.3</b> NEXT PART</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="learning-vector-quantization.html"><a href="learning-vector-quantization.html"><i class="fa fa-check"></i><b>30</b> Learning Vector Quantization</a></li>
<li class="chapter" data-level="31" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html"><i class="fa fa-check"></i><b>31</b> Bayesian Statistics</a>
<ul>
<li class="chapter" data-level="31.1" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html#simple-model-with-one-binary-parameter"><i class="fa fa-check"></i><b>31.1</b> Simple model with one binary parameter</a></li>
<li class="chapter" data-level="31.2" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html#website-visitors-model"><i class="fa fa-check"></i><b>31.2</b> Website visitors model</a></li>
<li class="chapter" data-level="31.3" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html#the-best-models"><i class="fa fa-check"></i><b>31.3</b> The BEST models</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i><b>32</b> Naive Bayes</a></li>
<li class="chapter" data-level="33" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>33</b> Markov Chain Monte Carlo (MCMC)</a></li>
<li class="chapter" data-level="34" data-path="simple-markov-process.html"><a href="simple-markov-process.html"><i class="fa fa-check"></i><b>34</b> Simple Markov process</a>
<ul>
<li class="chapter" data-level="34.0.1" data-path="simple-markov-process.html"><a href="simple-markov-process.html#sources-2"><i class="fa fa-check"></i><b>34.0.1</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="tree-based-models.html"><a href="tree-based-models.html"><i class="fa fa-check"></i><b>35</b> Tree-based models</a>
<ul>
<li class="chapter" data-level="35.1" data-path="tree-based-models.html"><a href="tree-based-models.html#classification-tree-example"><i class="fa fa-check"></i><b>35.1</b> Classification Tree example</a></li>
<li class="chapter" data-level="35.2" data-path="tree-based-models.html"><a href="tree-based-models.html#regression-tree-example"><i class="fa fa-check"></i><b>35.2</b> Regression Tree example</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-statistics" class="section level1" number="31">
<h1><span class="header-section-number">Chapter 31</span> Bayesian Statistics</h1>
<p><strong>Bayesian data analysis</strong> the use of Bayesian inference to learn from data.</p>
<p><strong>Bayesian inference</strong> is a method for figuring out unobservable quantities given known facts that uses probability to describe the uncertainty over what the values of the unknown quantities could be.<br />
<strong>Bayesian inference</strong> is conditioning on data, in order to learn about parameter values.</p>
<ul>
<li>A <strong>prior</strong> is a probability distribution that represents what the model knows before seeing the data.<br />
</li>
<li>A <strong>posterior</strong> is a probability distribution that represents what the model knows after having seen the data.</li>
</ul>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="bayesian-statistics.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization function of Bayesian inference for binary data </span></span>
<span id="cb240-2"><a href="bayesian-statistics.html#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggjoy)</span>
<span id="cb240-3"><a href="bayesian-statistics.html#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb240-4"><a href="bayesian-statistics.html#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggjoy)</span>
<span id="cb240-5"><a href="bayesian-statistics.html#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb240-6"><a href="bayesian-statistics.html#cb240-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-7"><a href="bayesian-statistics.html#cb240-7" aria-hidden="true" tabindex="-1"></a><span class="co"># prop_model function to visualize bayesian posterior distributions</span></span>
<span id="cb240-8"><a href="bayesian-statistics.html#cb240-8" aria-hidden="true" tabindex="-1"></a>prop_model <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> <span class="fu">c</span>(), <span class="at">prior_prop =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">n_draws =</span> <span class="dv">10000</span>, </span>
<span id="cb240-9"><a href="bayesian-statistics.html#cb240-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show_plot =</span> <span class="cn">TRUE</span>) </span>
<span id="cb240-10"><a href="bayesian-statistics.html#cb240-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb240-11"><a href="bayesian-statistics.html#cb240-11" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(data)</span>
<span id="cb240-12"><a href="bayesian-statistics.html#cb240-12" aria-hidden="true" tabindex="-1"></a>    proportion_success <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">1</span>)</span>
<span id="cb240-13"><a href="bayesian-statistics.html#cb240-13" aria-hidden="true" tabindex="-1"></a>    data_indices <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">length</span>(data), <span class="at">length.out =</span> <span class="fu">min</span>(<span class="fu">length</span>(data) <span class="sc">+</span> </span>
<span id="cb240-14"><a href="bayesian-statistics.html#cb240-14" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="dv">1</span>, <span class="dv">20</span>)))</span>
<span id="cb240-15"><a href="bayesian-statistics.html#cb240-15" aria-hidden="true" tabindex="-1"></a>    post_curves <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(data_indices, <span class="cf">function</span>(i) {</span>
<span id="cb240-16"><a href="bayesian-statistics.html#cb240-16" aria-hidden="true" tabindex="-1"></a>        value <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(i <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;Prior&quot;</span>, <span class="fu">ifelse</span>(data[i], <span class="st">&quot;Success&quot;</span>, </span>
<span id="cb240-17"><a href="bayesian-statistics.html#cb240-17" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">&quot;Failure&quot;</span>))</span>
<span id="cb240-18"><a href="bayesian-statistics.html#cb240-18" aria-hidden="true" tabindex="-1"></a>        label <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;n=&quot;</span>, i)</span>
<span id="cb240-19"><a href="bayesian-statistics.html#cb240-19" aria-hidden="true" tabindex="-1"></a>        probability <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(proportion_success, prior_prop[<span class="dv">1</span>] <span class="sc">+</span> </span>
<span id="cb240-20"><a href="bayesian-statistics.html#cb240-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">sum</span>(data[<span class="fu">seq_len</span>(i)]), prior_prop[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">sum</span>(<span class="sc">!</span>data[<span class="fu">seq_len</span>(i)]))</span>
<span id="cb240-21"><a href="bayesian-statistics.html#cb240-21" aria-hidden="true" tabindex="-1"></a>        probability <span class="ot">&lt;-</span> probability<span class="sc">/</span><span class="fu">max</span>(probability)</span>
<span id="cb240-22"><a href="bayesian-statistics.html#cb240-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tibble</span>(value, label, proportion_success, probability)</span>
<span id="cb240-23"><a href="bayesian-statistics.html#cb240-23" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb240-24"><a href="bayesian-statistics.html#cb240-24" aria-hidden="true" tabindex="-1"></a>    post_curves<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">fct_rev</span>(<span class="fu">factor</span>(post_curves<span class="sc">$</span>label, <span class="at">levels =</span> <span class="fu">paste0</span>(<span class="st">&quot;n=&quot;</span>, </span>
<span id="cb240-25"><a href="bayesian-statistics.html#cb240-25" aria-hidden="true" tabindex="-1"></a>                                                                           data_indices)))</span>
<span id="cb240-26"><a href="bayesian-statistics.html#cb240-26" aria-hidden="true" tabindex="-1"></a>    post_curves<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">factor</span>(post_curves<span class="sc">$</span>value, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span>, </span>
<span id="cb240-27"><a href="bayesian-statistics.html#cb240-27" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">&quot;Success&quot;</span>, <span class="st">&quot;Failure&quot;</span>))</span>
<span id="cb240-28"><a href="bayesian-statistics.html#cb240-28" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(post_curves, <span class="fu">aes</span>(<span class="at">x =</span> proportion_success, <span class="at">y =</span> label, </span>
<span id="cb240-29"><a href="bayesian-statistics.html#cb240-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">height =</span> probability, <span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_joy</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, </span>
<span id="cb240-30"><a href="bayesian-statistics.html#cb240-30" aria-hidden="true" tabindex="-1"></a>                                                                                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">panel_scaling =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb240-31"><a href="bayesian-statistics.html#cb240-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_discrete</span>(<span class="st">&quot;&quot;</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Underlying proportion of success&quot;</span>) <span class="sc">+</span> </span>
<span id="cb240-32"><a href="bayesian-statistics.html#cb240-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">hcl</span>(<span class="dv">120</span> <span class="sc">*</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">0</span> <span class="sc">+</span> <span class="dv">15</span>, <span class="dv">100</span>, <span class="dv">65</span>), </span>
<span id="cb240-33"><a href="bayesian-statistics.html#cb240-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Prior   &quot;</span>, <span class="st">&quot;Success   &quot;</span>, </span>
<span id="cb240-34"><a href="bayesian-statistics.html#cb240-34" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">&quot;Failure   &quot;</span>)) <span class="sc">+</span> <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">18</span>) <span class="sc">+</span> </span>
<span id="cb240-35"><a href="bayesian-statistics.html#cb240-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb240-36"><a href="bayesian-statistics.html#cb240-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (show_plot) {</span>
<span id="cb240-37"><a href="bayesian-statistics.html#cb240-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(p)</span>
<span id="cb240-38"><a href="bayesian-statistics.html#cb240-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb240-39"><a href="bayesian-statistics.html#cb240-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">invisible</span>(<span class="fu">rbeta</span>(n_draws, prior_prop[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">sum</span>(data), prior_prop[<span class="dv">2</span>] <span class="sc">+</span> </span>
<span id="cb240-40"><a href="bayesian-statistics.html#cb240-40" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">sum</span>(<span class="sc">!</span>data)))</span>
<span id="cb240-41"><a href="bayesian-statistics.html#cb240-41" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="simple-model-with-one-binary-parameter" class="section level2" number="31.1">
<h2><span class="header-section-number">31.1</span> Simple model with one binary parameter</h2>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="bayesian-statistics.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 50 random binary data with P(1)=0.75</span></span>
<span id="cb241-2"><a href="bayesian-statistics.html#cb241-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.25</span>),</span>
<span id="cb241-3"><a href="bayesian-statistics.html#cb241-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb241-4"><a href="bayesian-statistics.html#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and explore the posterior</span></span>
<span id="cb241-5"><a href="bayesian-statistics.html#cb241-5" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">prop_model</span>(data)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="bayesian-statistics.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(posterior)</span></code></pre></div>
<pre><code>## [1] 0.6907880 0.6526425 0.4462395 0.6992505 0.5693596 0.5330336</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="bayesian-statistics.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the histogram of the posterior</span></span>
<span id="cb244-2"><a href="bayesian-statistics.html#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks=</span><span class="dv">30</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-81-2.png" width="672" /></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="bayesian-statistics.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the median</span></span>
<span id="cb245-2"><a href="bayesian-statistics.html#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(posterior)</span></code></pre></div>
<pre><code>## [1] 0.5882531</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="bayesian-statistics.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the credible interval (CI)</span></span>
<span id="cb247-2"><a href="bayesian-statistics.html#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(posterior, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span></code></pre></div>
<pre><code>##        5%       95% 
## 0.3505923 0.7977435</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="bayesian-statistics.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of successes in our distribution &gt; 0.07</span></span>
<span id="cb249-2"><a href="bayesian-statistics.html#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(posterior <span class="sc">&gt;</span> <span class="fl">0.07</span>) <span class="sc">/</span> <span class="fu">length</span>(posterior)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p><strong>Generate binomial data</strong></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="bayesian-statistics.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb251-2"><a href="bayesian-statistics.html#cb251-2" aria-hidden="true" tabindex="-1"></a>p_success <span class="ot">&lt;-</span> <span class="fl">0.42</span>     <span class="co"># probability of success</span></span>
<span id="cb251-3"><a href="bayesian-statistics.html#cb251-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>              <span class="co"># number of observations</span></span>
<span id="cb251-4"><a href="bayesian-statistics.html#cb251-4" aria-hidden="true" tabindex="-1"></a><span class="co"># logical vector with false if Uniform distribution </span></span>
<span id="cb251-5"><a href="bayesian-statistics.html#cb251-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generates value less then probability of success</span></span>
<span id="cb251-6"><a href="bayesian-statistics.html#cb251-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb251-7"><a href="bayesian-statistics.html#cb251-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb251-8"><a href="bayesian-statistics.html#cb251-8" aria-hidden="true" tabindex="-1"></a>    data[i] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>) <span class="sc">&lt;</span> p_success</span>
<span id="cb251-9"><a href="bayesian-statistics.html#cb251-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb251-10"><a href="bayesian-statistics.html#cb251-10" aria-hidden="true" tabindex="-1"></a><span class="co"># convert logical to numeric 0/1</span></span>
<span id="cb251-11"><a href="bayesian-statistics.html#cb251-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data)</span>
<span id="cb251-12"><a href="bayesian-statistics.html#cb251-12" aria-hidden="true" tabindex="-1"></a>data</span></code></pre></div>
<pre><code>##   [1] 0 0 1 0 1 1 0 0 0 0 1 1 0 0 0 0 1 1 0 1 1 1 0 1 1 1 1 0 1 0 0 1 0 0 0 0 0 1 1 1 1 0 0 0 0 1 1 1 0 1 0 1 0 1 0 1 0 1 0 0 1 1 0 1 1 0 1 1 0 1 0 0 0 1 1 1 0 0 0 0 0 0 1 1
##  [85] 0 1 0 1 1 0 0 0 1 1 0 0 1 0 0 0</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="bayesian-statistics.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the same vector using rbinom distribution</span></span>
<span id="cb253-2"><a href="bayesian-statistics.html#cb253-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb253-3"><a href="bayesian-statistics.html#cb253-3" aria-hidden="true" tabindex="-1"></a>size <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb253-4"><a href="bayesian-statistics.html#cb253-4" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">=</span> <span class="fl">0.42</span></span>
<span id="cb253-5"><a href="bayesian-statistics.html#cb253-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(n, size, prob)</span></code></pre></div>
<pre><code>##   [1] 1 0 1 0 1 0 1 0 0 1 1 0 1 0 0 0 1 1 0 1 0 0 1 0 0 1 0 0 0 1 1 1 0 0 0 1 0 1 0 1 1 0 1 1 1 0 1 1 1 0 1 0 1 0 1 1 0 0 0 0 0 1 0 0 0 1 0 0 1 0 1 1 0 0 0 1 1 1 1 1 0 0 1 1
##  [85] 0 1 0 0 0 0 0 0 1 1 0 0 0 0 0 1</code></pre>
</div>
<div id="website-visitors-model" class="section level2" number="31.2">
<h2><span class="header-section-number">31.2</span> Website visitors model</h2>
<p>To get more visitors to your website you are considering paying for an ad to be
shown 100 times on a popular social media site. According to the social media site,
their ads get clicked on 10% of the time. How many visitors could your site get?</p>
<p>We can fix % of clicks as 0.1 but we do not know exactly how many clicks people do (uncertain).
We suggest the % of cliks is uniformly distributed between 0 and 20.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="bayesian-statistics.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb255-2"><a href="bayesian-statistics.html#cb255-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span>          <span class="co"># number of simulations</span></span>
<span id="cb255-3"><a href="bayesian-statistics.html#cb255-3" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span>   <span class="co"># number of shown adds</span></span>
<span id="cb255-4"><a href="bayesian-statistics.html#cb255-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-5"><a href="bayesian-statistics.html#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="co"># probability that add will be clicked</span></span>
<span id="cb255-6"><a href="bayesian-statistics.html#cb255-6" aria-hidden="true" tabindex="-1"></a>p_clicks <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="fl">0.0</span>, <span class="at">max =</span> <span class="fl">0.2</span>)  </span>
<span id="cb255-7"><a href="bayesian-statistics.html#cb255-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-8"><a href="bayesian-statistics.html#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL: We assume that the binomial distribution is a reasonable generative model</span></span>
<span id="cb255-9"><a href="bayesian-statistics.html#cb255-9" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, </span>
<span id="cb255-10"><a href="bayesian-statistics.html#cb255-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> n_ads_shown, </span>
<span id="cb255-11"><a href="bayesian-statistics.html#cb255-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> p_clicks)</span>
<span id="cb255-12"><a href="bayesian-statistics.html#cb255-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-13"><a href="bayesian-statistics.html#cb255-13" aria-hidden="true" tabindex="-1"></a><span class="co">#---&gt; Visualize the prior model simulation</span></span>
<span id="cb255-14"><a href="bayesian-statistics.html#cb255-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb255-15"><a href="bayesian-statistics.html#cb255-15" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> n_visitors, <span class="at">y =</span> p_clicks)</span>
<span id="cb255-16"><a href="bayesian-statistics.html#cb255-16" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(n_visitors, p_clicks)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb255-17"><a href="bayesian-statistics.html#cb255-17" aria-hidden="true" tabindex="-1"></a>ggExtra<span class="sc">::</span><span class="fu">ggMarginal</span>(p, <span class="at">type =</span> <span class="st">&quot;histogram&quot;</span>,  <span class="at">bins =</span> <span class="dv">18</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="bayesian-statistics.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&lt;---</span></span></code></pre></div>
<p>Updated Bayesian model<br />
New data: 13 people clicked and visited site when the ad was shown 100 times.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="bayesian-statistics.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior distribution</span></span>
<span id="cb257-2"><a href="bayesian-statistics.html#cb257-2" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(p_clicks, n_visitors)</span>
<span id="cb257-3"><a href="bayesian-statistics.html#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The posterior subset</span></span>
<span id="cb257-4"><a href="bayesian-statistics.html#cb257-4" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">13</span>, ]</span>
<span id="cb257-5"><a href="bayesian-statistics.html#cb257-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(posterior)</span></code></pre></div>
<pre><code>##     p_clicks n_visitors
## 6  0.1650342         13
## 11 0.1480911         13
## 20 0.1011115         13
## 23 0.1511866         13
## 40 0.1314564         13
## 51 0.1263088         13</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="bayesian-statistics.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior distribution for 13 visitors</span></span>
<span id="cb259-2"><a href="bayesian-statistics.html#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>p_clicks)</span>
<span id="cb259-3"><a href="bayesian-statistics.html#cb259-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-4"><a href="bayesian-statistics.html#cb259-4" aria-hidden="true" tabindex="-1"></a><span class="co"># update</span></span>
<span id="cb259-5"><a href="bayesian-statistics.html#cb259-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign posterior to a new variable called prior</span></span>
<span id="cb259-6"><a href="bayesian-statistics.html#cb259-6" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> posterior</span>
<span id="cb259-7"><a href="bayesian-statistics.html#cb259-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(prior)</span></code></pre></div>
<pre><code>##     p_clicks n_visitors
## 6  0.1650342         13
## 11 0.1480911         13
## 20 0.1011115         13
## 23 0.1511866         13
## 40 0.1314564         13
## 51 0.1263088         13</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="bayesian-statistics.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---&gt; plot of subset distribution taken from data</span></span>
<span id="cb261-2"><a href="bayesian-statistics.html#cb261-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> prior</span>
<span id="cb261-3"><a href="bayesian-statistics.html#cb261-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(n_visitors, p_clicks)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb261-4"><a href="bayesian-statistics.html#cb261-4" aria-hidden="true" tabindex="-1"></a>ggExtra<span class="sc">::</span><span class="fu">ggMarginal</span>(p, <span class="at">type =</span> <span class="st">&quot;histogram&quot;</span>,  <span class="at">bins =</span> <span class="dv">18</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="bayesian-statistics.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&lt;---</span></span>
<span id="cb262-2"><a href="bayesian-statistics.html#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="bayesian-statistics.html#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace prior$n_visitors with a new sample and visualize the result</span></span>
<span id="cb262-4"><a href="bayesian-statistics.html#cb262-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span>  <span class="fu">nrow</span>(prior)</span>
<span id="cb262-5"><a href="bayesian-statistics.html#cb262-5" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb262-6"><a href="bayesian-statistics.html#cb262-6" aria-hidden="true" tabindex="-1"></a>prior<span class="sc">$</span>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> n_ads_shown, <span class="at">prob =</span> prior<span class="sc">$</span>p_clicks)</span>
<span id="cb262-7"><a href="bayesian-statistics.html#cb262-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(prior<span class="sc">$</span>n_visitors)</span>
<span id="cb262-8"><a href="bayesian-statistics.html#cb262-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-9"><a href="bayesian-statistics.html#cb262-9" aria-hidden="true" tabindex="-1"></a><span class="co">#---&gt; plot of distributions</span></span>
<span id="cb262-10"><a href="bayesian-statistics.html#cb262-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> prior</span>
<span id="cb262-11"><a href="bayesian-statistics.html#cb262-11" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(n_visitors, p_clicks)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb262-12"><a href="bayesian-statistics.html#cb262-12" aria-hidden="true" tabindex="-1"></a>ggExtra<span class="sc">::</span><span class="fu">ggMarginal</span>(p, <span class="at">type =</span> <span class="st">&quot;histogram&quot;</span>,  <span class="at">bins =</span> <span class="dv">18</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-84-2.png" width="672" /></p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="bayesian-statistics.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&lt;---</span></span></code></pre></div>
<p>Use result of the model for prediction:<br />
Calculate the probability that you will get 5 or more visitors.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="bayesian-statistics.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(prior<span class="sc">$</span>n_visitors <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">/</span> <span class="fu">length</span>(prior<span class="sc">$</span>n_visitors)</span></code></pre></div>
<pre><code>## [1] 0.9863665</code></pre>
<p>Now we update prior and will use <strong>beta distribution</strong>.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="bayesian-statistics.html#cb266-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb266-2"><a href="bayesian-statistics.html#cb266-2" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb266-3"><a href="bayesian-statistics.html#cb266-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-4"><a href="bayesian-statistics.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the prior on proportion_clicks</span></span>
<span id="cb266-5"><a href="bayesian-statistics.html#cb266-5" aria-hidden="true" tabindex="-1"></a>p_clicks <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, <span class="at">shape1 =</span> <span class="dv">5</span>, <span class="at">shape2 =</span> <span class="dv">95</span>)</span>
<span id="cb266-6"><a href="bayesian-statistics.html#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(p_clicks)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="bayesian-statistics.html#cb267-1" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n,</span>
<span id="cb267-2"><a href="bayesian-statistics.html#cb267-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> n_ads_shown, </span>
<span id="cb267-3"><a href="bayesian-statistics.html#cb267-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> p_clicks)</span>
<span id="cb267-4"><a href="bayesian-statistics.html#cb267-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-5"><a href="bayesian-statistics.html#cb267-5" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(p_clicks, n_visitors)</span>
<span id="cb267-6"><a href="bayesian-statistics.html#cb267-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-7"><a href="bayesian-statistics.html#cb267-7" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">13</span>, ]</span>
<span id="cb267-8"><a href="bayesian-statistics.html#cb267-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-9"><a href="bayesian-statistics.html#cb267-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots the prior and the posterior</span></span>
<span id="cb267-10"><a href="bayesian-statistics.html#cb267-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb267-11"><a href="bayesian-statistics.html#cb267-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(prior<span class="sc">$</span>p_clicks, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>))</span>
<span id="cb267-12"><a href="bayesian-statistics.html#cb267-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>p_clicks, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-86-2.png" width="672" /></p>
<p>Let’s fit the binomial model to both the video ad data (13 out of 100 clicked) and
the new text ad data (6 out of a 100 clicked).</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="bayesian-statistics.html#cb268-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb268-2"><a href="bayesian-statistics.html#cb268-2" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb268-3"><a href="bayesian-statistics.html#cb268-3" aria-hidden="true" tabindex="-1"></a>p_clicks <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="fl">0.0</span>, <span class="at">max =</span> <span class="fl">0.2</span>)</span>
<span id="cb268-4"><a href="bayesian-statistics.html#cb268-4" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> n_ads_shown, </span>
<span id="cb268-5"><a href="bayesian-statistics.html#cb268-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> p_clicks)</span>
<span id="cb268-6"><a href="bayesian-statistics.html#cb268-6" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(p_clicks, n_visitors)</span>
<span id="cb268-7"><a href="bayesian-statistics.html#cb268-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-8"><a href="bayesian-statistics.html#cb268-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the posteriors for video and text ads</span></span>
<span id="cb268-9"><a href="bayesian-statistics.html#cb268-9" aria-hidden="true" tabindex="-1"></a>posterior_video <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">13</span>, ]</span>
<span id="cb268-10"><a href="bayesian-statistics.html#cb268-10" aria-hidden="true" tabindex="-1"></a>posterior_text <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">6</span>, ]</span>
<span id="cb268-11"><a href="bayesian-statistics.html#cb268-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-12"><a href="bayesian-statistics.html#cb268-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb268-13"><a href="bayesian-statistics.html#cb268-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the posteriors</span></span>
<span id="cb268-14"><a href="bayesian-statistics.html#cb268-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior_video<span class="sc">$</span>p_clicks, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>))</span>
<span id="cb268-15"><a href="bayesian-statistics.html#cb268-15" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior_text<span class="sc">$</span>p_clicks, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="bayesian-statistics.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine data into dataframe</span></span>
<span id="cb269-2"><a href="bayesian-statistics.html#cb269-2" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">video_prop =</span> posterior_video<span class="sc">$</span>p_clicks[<span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>],</span>
<span id="cb269-3"><a href="bayesian-statistics.html#cb269-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">text_prop =</span> posterior_text<span class="sc">$</span>p_click[<span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>])</span>
<span id="cb269-4"><a href="bayesian-statistics.html#cb269-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-5"><a href="bayesian-statistics.html#cb269-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior difference: video_prop - text_prop</span></span>
<span id="cb269-6"><a href="bayesian-statistics.html#cb269-6" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>prop_diff <span class="ot">&lt;-</span> posterior<span class="sc">$</span>video_prop <span class="sc">-</span> posterior<span class="sc">$</span>text_prop</span>
<span id="cb269-7"><a href="bayesian-statistics.html#cb269-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-8"><a href="bayesian-statistics.html#cb269-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the median of prop_diff</span></span>
<span id="cb269-9"><a href="bayesian-statistics.html#cb269-9" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(posterior<span class="sc">$</span>prop_diff)</span></code></pre></div>
<pre><code>## [1] 0.06563094</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="bayesian-statistics.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the proportion</span></span>
<span id="cb271-2"><a href="bayesian-statistics.html#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(posterior<span class="sc">$</span>prop_diff <span class="sc">&gt;</span> <span class="fl">0.0</span>)</span></code></pre></div>
<pre><code>## [1] 0.94825</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="bayesian-statistics.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize prop_diff</span></span>
<span id="cb273-2"><a href="bayesian-statistics.html#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>prop_diff)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-87-2.png" width="672" /></p>
<p><strong>Decision analysis</strong><br />
As we see the video ads are clicked more often.<br />
Each visitor spends $2.53 on average, a video ad costs $0.25 and a text ad
costs $0.05. Let’s figure out the probable profit when using video ads and text ads.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="bayesian-statistics.html#cb274-1" aria-hidden="true" tabindex="-1"></a>visitor_spend <span class="ot">&lt;-</span> <span class="fl">2.53</span></span>
<span id="cb274-2"><a href="bayesian-statistics.html#cb274-2" aria-hidden="true" tabindex="-1"></a>video_cost <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb274-3"><a href="bayesian-statistics.html#cb274-3" aria-hidden="true" tabindex="-1"></a>text_cost <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb274-4"><a href="bayesian-statistics.html#cb274-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-5"><a href="bayesian-statistics.html#cb274-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the column posterior$video_profit</span></span>
<span id="cb274-6"><a href="bayesian-statistics.html#cb274-6" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>video_profit <span class="ot">&lt;-</span> posterior<span class="sc">$</span>video_prop <span class="sc">*</span> visitor_spend <span class="sc">-</span> video_cost</span>
<span id="cb274-7"><a href="bayesian-statistics.html#cb274-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-8"><a href="bayesian-statistics.html#cb274-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the column posterior$text_profit</span></span>
<span id="cb274-9"><a href="bayesian-statistics.html#cb274-9" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>text_profit <span class="ot">&lt;-</span> posterior<span class="sc">$</span>text_prop <span class="sc">*</span> visitor_spend <span class="sc">-</span> text_cost</span>
<span id="cb274-10"><a href="bayesian-statistics.html#cb274-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-11"><a href="bayesian-statistics.html#cb274-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(posterior)</span></code></pre></div>
<pre><code>##   video_prop  text_prop  prop_diff video_profit text_profit
## 1  0.1991635 0.03699197 0.16217154   0.25388368  0.04358969
## 2  0.1931784 0.09495372 0.09822467   0.23874133  0.19023292
## 3  0.1316657 0.05753025 0.07413544   0.08311420  0.09555153
## 4  0.1654641 0.06146723 0.10399688   0.16862420  0.10551210
## 5  0.1260397 0.07971197 0.04632772   0.06888041  0.15167129
## 6  0.1152924 0.05278979 0.06250263   0.04168981  0.08355816</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="bayesian-statistics.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the video_profit and text_profit columns</span></span>
<span id="cb276-2"><a href="bayesian-statistics.html#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb276-3"><a href="bayesian-statistics.html#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>video_profit)</span>
<span id="cb276-4"><a href="bayesian-statistics.html#cb276-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>text_profit)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="bayesian-statistics.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Difference between video and text ad profits</span></span>
<span id="cb277-2"><a href="bayesian-statistics.html#cb277-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-3"><a href="bayesian-statistics.html#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the column posterior$profit_diff</span></span>
<span id="cb277-4"><a href="bayesian-statistics.html#cb277-4" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>profit_diff <span class="ot">&lt;-</span> posterior<span class="sc">$</span>video_profit <span class="sc">-</span> posterior<span class="sc">$</span>text_profit</span>
<span id="cb277-5"><a href="bayesian-statistics.html#cb277-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-6"><a href="bayesian-statistics.html#cb277-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize posterior$profit_diff</span></span>
<span id="cb277-7"><a href="bayesian-statistics.html#cb277-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>profit_diff)</span>
<span id="cb277-8"><a href="bayesian-statistics.html#cb277-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-9"><a href="bayesian-statistics.html#cb277-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate a &quot;best guess&quot; for the difference in profits</span></span>
<span id="cb277-10"><a href="bayesian-statistics.html#cb277-10" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(posterior<span class="sc">$</span>profit_diff)</span></code></pre></div>
<pre><code>## [1] -0.03395372</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="bayesian-statistics.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability that text ads are better than video ads</span></span>
<span id="cb279-2"><a href="bayesian-statistics.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(posterior<span class="sc">$</span>profit_diff <span class="sc">&lt;</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.63125</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-88-2.png" width="672" />
When you put up a banner on your friend’s site you got 19 clicks in a day, how many daily clicks should you expect this banner to generate on average? Now, modify your model, one piece at a time, to calculate this.<br />
Start by replacing the prior distribution over proportion_clicks by a prior over mean_clicks. Make the prior a uniform (runif) distribution from 0 to 80 clicks per day.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="bayesian-statistics.html#cb281-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb281-2"><a href="bayesian-statistics.html#cb281-2" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb281-3"><a href="bayesian-statistics.html#cb281-3" aria-hidden="true" tabindex="-1"></a>mean_clicks <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">80</span>)</span>
<span id="cb281-4"><a href="bayesian-statistics.html#cb281-4" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> n_ads_shown, </span>
<span id="cb281-5"><a href="bayesian-statistics.html#cb281-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> p_clicks)</span>
<span id="cb281-6"><a href="bayesian-statistics.html#cb281-6" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb281-7"><a href="bayesian-statistics.html#cb281-7" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(p_clicks, n_visitors)</span>
<span id="cb281-8"><a href="bayesian-statistics.html#cb281-8" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">13</span>, ]</span></code></pre></div>
<p>Clicks per day instead of clicks per ad</p>
<p>When you put up a banner on your friend’s site you got 19 clicks in a day,
how many daily clicks should you expect this banner to generate on average?
Now, modify your model, one piece at a time, to calculate this.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="bayesian-statistics.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change this model so that it uses a Poisson distribution</span></span>
<span id="cb282-2"><a href="bayesian-statistics.html#cb282-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb282-3"><a href="bayesian-statistics.html#cb282-3" aria-hidden="true" tabindex="-1"></a>mean_clicks <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">80</span>)</span>
<span id="cb282-4"><a href="bayesian-statistics.html#cb282-4" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> n, mean_clicks)</span>
<span id="cb282-5"><a href="bayesian-statistics.html#cb282-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-6"><a href="bayesian-statistics.html#cb282-6" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mean_clicks, n_visitors)</span>
<span id="cb282-7"><a href="bayesian-statistics.html#cb282-7" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">13</span>, ]</span>
<span id="cb282-8"><a href="bayesian-statistics.html#cb282-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-9"><a href="bayesian-statistics.html#cb282-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(prior<span class="sc">$</span>mean_clicks)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="bayesian-statistics.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>mean_clicks)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-90-2.png" width="672" /></p>
<p>Simulates the number of clicks/visitors (n_clicks) from 100 shown ads using the rbinom function
given that the underlying proportion of clicks is 10%.<br />
Calculates the probability of getting 13 visitors (prob_13_visitors).
That is, in probability notation it’s calculating P(n_visitors = 13 | proportion_clicks = 10%).</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="bayesian-statistics.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rewrite this code so that it uses dbinom instead of rbinom</span></span>
<span id="cb284-2"><a href="bayesian-statistics.html#cb284-2" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb284-3"><a href="bayesian-statistics.html#cb284-3" aria-hidden="true" tabindex="-1"></a>p_clicks <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb284-4"><a href="bayesian-statistics.html#cb284-4" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="dv">13</span></span>
<span id="cb284-5"><a href="bayesian-statistics.html#cb284-5" aria-hidden="true" tabindex="-1"></a>prob_13_visitors <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(n_visitors,</span>
<span id="cb284-6"><a href="bayesian-statistics.html#cb284-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> n_ads_shown,</span>
<span id="cb284-7"><a href="bayesian-statistics.html#cb284-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> p_clicks)</span>
<span id="cb284-8"><a href="bayesian-statistics.html#cb284-8" aria-hidden="true" tabindex="-1"></a>prob_13_visitors</span></code></pre></div>
<pre><code>## [1] 0.07430209</code></pre>
<p>Currently the code calculates P(n_visitors = 13 | proportion_clicks = 10%): The probability of getting 13 visitors given that the proportion of clicks is 10%.</p>
<p>Change the code to instead calculate P(n_visitors | proportion_clicks = 10%): The probability distribution over all possible numbers of visitors.
Tip: As dbinom is vectorized it suffices to change the value of n_visitors into a vector with the numbers 0, 1, 2, …, 100.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="bayesian-statistics.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore using dbinom to calculate probability distributions</span></span>
<span id="cb286-2"><a href="bayesian-statistics.html#cb286-2" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb286-3"><a href="bayesian-statistics.html#cb286-3" aria-hidden="true" tabindex="-1"></a>p_clicks <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb286-4"><a href="bayesian-statistics.html#cb286-4" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb286-5"><a href="bayesian-statistics.html#cb286-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-6"><a href="bayesian-statistics.html#cb286-6" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(n_visitors,</span>
<span id="cb286-7"><a href="bayesian-statistics.html#cb286-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> n_ads_shown, </span>
<span id="cb286-8"><a href="bayesian-statistics.html#cb286-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">prob =</span> p_clicks)</span>
<span id="cb286-9"><a href="bayesian-statistics.html#cb286-9" aria-hidden="true" tabindex="-1"></a>prob</span></code></pre></div>
<pre><code>##   [1]  2.656140e-05  2.951267e-04  1.623197e-03  5.891602e-03  1.587460e-02  3.386580e-02  5.957873e-02  8.889525e-02  1.148230e-01  1.304163e-01  1.318653e-01  1.198776e-01
##  [13]  9.878801e-02  7.430209e-02  5.130383e-02  3.268244e-02  1.929172e-02  1.059153e-02  5.426525e-03  2.602193e-03  1.170987e-03  4.956559e-04  1.977617e-04  7.451890e-05
##  [25]  2.656461e-05  8.972934e-06  2.875940e-06  8.758007e-07  2.537042e-07  6.998736e-08  1.840408e-08  4.617512e-09  1.106279e-09  2.532895e-10  5.545880e-11  1.161994e-11
##  [37]  2.331161e-12  4.480309e-13  8.253201e-14  1.457830e-14  2.470212e-15  4.016606e-16  6.269305e-17  9.395858e-18  1.352434e-18  1.870032e-19  2.484342e-20  3.171501e-21
##  [49]  3.890962e-22  4.587982e-23  5.199713e-24  5.664175e-25  5.930440e-26  5.967739e-27  5.771270e-28  5.363200e-29  4.788572e-30  4.107157e-31  3.383290e-32  2.676049e-33
##  [61]  2.031815e-34  1.480375e-35  1.034671e-36  6.934301e-38  4.454325e-39  2.741123e-40  1.615140e-41  9.106926e-43  4.910597e-44  2.530420e-45  1.245128e-46  5.845669e-48
##  [73]  2.616117e-49  1.114936e-50  4.520010e-52  1.741041e-53  6.363454e-55  2.203794e-56  7.220406e-58  2.234162e-59  6.516307e-61  1.787738e-62  4.602579e-64  1.109055e-65
##  [85]  2.493907e-67  5.216014e-69  1.010856e-70  1.807405e-72  2.966699e-74  4.444493e-76  6.035732e-78  7.369636e-80  8.010474e-82  7.656367e-84  6.335055e-86  4.445653e-88
##  [97]  2.572716e-90  1.178793e-92  4.009500e-95  9.000000e-98 1.000000e-100</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="bayesian-statistics.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the distribution</span></span>
<span id="cb288-2"><a href="bayesian-statistics.html#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n_visitors, prob, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<p>Calculating a joint distribution<br />
Add the column pars$probability: The probability of each proportion_clicks and n_visitors combination.
This should be calculated by multiplying the likelihood by the prior.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="bayesian-statistics.html#cb289-1" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb289-2"><a href="bayesian-statistics.html#cb289-2" aria-hidden="true" tabindex="-1"></a>p_clicks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb289-3"><a href="bayesian-statistics.html#cb289-3" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb289-4"><a href="bayesian-statistics.html#cb289-4" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">proportion_clicks =</span> p_clicks,</span>
<span id="cb289-5"><a href="bayesian-statistics.html#cb289-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n_visitors =</span> n_visitors)</span>
<span id="cb289-6"><a href="bayesian-statistics.html#cb289-6" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>prior <span class="ot">&lt;-</span> <span class="fu">dunif</span>(pars<span class="sc">$</span>proportion_clicks, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fl">0.2</span>)</span>
<span id="cb289-7"><a href="bayesian-statistics.html#cb289-7" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(pars<span class="sc">$</span>n_visitors, </span>
<span id="cb289-8"><a href="bayesian-statistics.html#cb289-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> n_ads_shown, <span class="at">prob =</span> pars<span class="sc">$</span>proportion_clicks)</span>
<span id="cb289-9"><a href="bayesian-statistics.html#cb289-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-10"><a href="bayesian-statistics.html#cb289-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the column pars$probability and normalize it</span></span>
<span id="cb289-11"><a href="bayesian-statistics.html#cb289-11" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>likelihood <span class="sc">*</span> pars<span class="sc">$</span>prior</span>
<span id="cb289-12"><a href="bayesian-statistics.html#cb289-12" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>probability <span class="sc">/</span> <span class="fu">sum</span>(pars<span class="sc">$</span>probability)</span></code></pre></div>
<p>Conditioning on the data<br />
Let’s resurrect the site example where you tested text ads.
Out of a 100 impressions of the text ad, 6 out of a 100 clicked and
visited your site.<br />
pars is currently the joint distribution over all combinations of
proportion_clicks and n_visitors.<br />
Condition on the data and keep only the rows in pars where n_visitors == 6.
Normalize pars<span class="math inline">\(probability again, to make sure it sums to 1.0. Plot the posterior pars\)</span>probability using plot(x = , y = , type = “h”)
with pars<span class="math inline">\(proportion_clicks on the x-axis and pars\)</span>probability on the y-axis.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="bayesian-statistics.html#cb290-1" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb290-2"><a href="bayesian-statistics.html#cb290-2" aria-hidden="true" tabindex="-1"></a>proportion_clicks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb290-3"><a href="bayesian-statistics.html#cb290-3" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb290-4"><a href="bayesian-statistics.html#cb290-4" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">proportion_clicks =</span> proportion_clicks,</span>
<span id="cb290-5"><a href="bayesian-statistics.html#cb290-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n_visitors =</span> n_visitors)</span>
<span id="cb290-6"><a href="bayesian-statistics.html#cb290-6" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>prior <span class="ot">&lt;-</span> <span class="fu">dunif</span>(pars<span class="sc">$</span>proportion_clicks, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fl">0.2</span>)</span>
<span id="cb290-7"><a href="bayesian-statistics.html#cb290-7" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(pars<span class="sc">$</span>n_visitors, </span>
<span id="cb290-8"><a href="bayesian-statistics.html#cb290-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> n_ads_shown, <span class="at">prob =</span> pars<span class="sc">$</span>proportion_clicks)</span>
<span id="cb290-9"><a href="bayesian-statistics.html#cb290-9" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>likelihood <span class="sc">*</span> pars<span class="sc">$</span>prior</span>
<span id="cb290-10"><a href="bayesian-statistics.html#cb290-10" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>probability <span class="sc">/</span> <span class="fu">sum</span>(pars<span class="sc">$</span>probability)</span>
<span id="cb290-11"><a href="bayesian-statistics.html#cb290-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Condition on the data </span></span>
<span id="cb290-12"><a href="bayesian-statistics.html#cb290-12" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> pars[pars<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">6</span>, ]</span>
<span id="cb290-13"><a href="bayesian-statistics.html#cb290-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize again</span></span>
<span id="cb290-14"><a href="bayesian-statistics.html#cb290-14" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>probability <span class="sc">/</span> <span class="fu">sum</span>(pars<span class="sc">$</span>probability)</span>
<span id="cb290-15"><a href="bayesian-statistics.html#cb290-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the posterior pars$probability</span></span>
<span id="cb290-16"><a href="bayesian-statistics.html#cb290-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pars<span class="sc">$</span>proportion_clicks, pars<span class="sc">$</span>probability, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<p>Set n_visitors directly to 6, just replace the seq-statement.
Now you can remove the line that conditions on the data, and the line after that, that normalizes pars$probability.
Take an extra look at the final code and convince yourself that the result of this modified code will be the same as before.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="bayesian-statistics.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simplify the code below by directly conditioning on the data</span></span>
<span id="cb291-2"><a href="bayesian-statistics.html#cb291-2" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb291-3"><a href="bayesian-statistics.html#cb291-3" aria-hidden="true" tabindex="-1"></a>proportion_clicks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb291-4"><a href="bayesian-statistics.html#cb291-4" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb291-5"><a href="bayesian-statistics.html#cb291-5" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">proportion_clicks =</span> proportion_clicks)</span>
<span id="cb291-6"><a href="bayesian-statistics.html#cb291-6" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>prior <span class="ot">&lt;-</span> <span class="fu">dunif</span>(pars<span class="sc">$</span>proportion_clicks, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fl">0.2</span>) </span>
<span id="cb291-7"><a href="bayesian-statistics.html#cb291-7" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(n_visitors, </span>
<span id="cb291-8"><a href="bayesian-statistics.html#cb291-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> n_ads_shown, <span class="at">prob =</span> pars<span class="sc">$</span>proportion_clicks)</span>
<span id="cb291-9"><a href="bayesian-statistics.html#cb291-9" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>likelihood <span class="sc">*</span> pars<span class="sc">$</span>prior</span>
<span id="cb291-10"><a href="bayesian-statistics.html#cb291-10" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>probability <span class="sc">/</span> <span class="fu">sum</span>(pars<span class="sc">$</span>probability)</span>
<span id="cb291-11"><a href="bayesian-statistics.html#cb291-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pars<span class="sc">$</span>proportion_clicks, pars<span class="sc">$</span>probability, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<p>Let’s assume that the Normal distribution is a decent model of birth weight data.</p>
<p>Given the birth weight data, what would be reasonable values of the mean (mu) and standard deviation (sigma) that generated this data?
Assign these value to mu and sigma.
No need to do anything fancy here, just eyeball the data and try to come up with something reasonable.</p>
<p>Remember: The standard deviation sigma describes the spread of the distribution, where around 70% of the drawn values will be within one standard deviation from the mean.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="bayesian-statistics.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign mu and sigma</span></span>
<span id="cb292-2"><a href="bayesian-statistics.html#cb292-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">3500</span></span>
<span id="cb292-3"><a href="bayesian-statistics.html#cb292-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">600</span></span>
<span id="cb292-4"><a href="bayesian-statistics.html#cb292-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-5"><a href="bayesian-statistics.html#cb292-5" aria-hidden="true" tabindex="-1"></a>weight_distr <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100000</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb292-6"><a href="bayesian-statistics.html#cb292-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(weight_distr, <span class="dv">60</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6000</span>), <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-96-1.png" width="672" />
Here is a small data set with the birth weights of six newborn babies in grams.<br />
<code>c(3164, 3362, 4435, 3542, 3578, 4529)</code><br />
The resulting histogram gives you a sense of the uncertainty over the birth weight of newborns. Let’s recreate this plot, but calculating the distribution using dnorm instead of simulating using rnorm.</p>
<p>Create a vector called weight that should contain all values from 0 to 6000 in increments of 100, that is, 0, 100, 200, …, 5900, 6000.
Tip: use seq(from = , to = , by = )</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="bayesian-statistics.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign mu and sigma</span></span>
<span id="cb293-2"><a href="bayesian-statistics.html#cb293-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">3500</span></span>
<span id="cb293-3"><a href="bayesian-statistics.html#cb293-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">600</span></span>
<span id="cb293-4"><a href="bayesian-statistics.html#cb293-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-5"><a href="bayesian-statistics.html#cb293-5" aria-hidden="true" tabindex="-1"></a>weight_distr <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100000</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb293-6"><a href="bayesian-statistics.html#cb293-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(weight_distr, <span class="dv">60</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6000</span>), <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="bayesian-statistics.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create weight</span></span>
<span id="cb294-2"><a href="bayesian-statistics.html#cb294-2" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6000</span>, <span class="at">by =</span> <span class="dv">100</span>)</span>
<span id="cb294-3"><a href="bayesian-statistics.html#cb294-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-4"><a href="bayesian-statistics.html#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate likelihood</span></span>
<span id="cb294-5"><a href="bayesian-statistics.html#cb294-5" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(weight, mu, sigma)</span>
<span id="cb294-6"><a href="bayesian-statistics.html#cb294-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-7"><a href="bayesian-statistics.html#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the distribution of weight</span></span>
<span id="cb294-8"><a href="bayesian-statistics.html#cb294-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weight, likelihood, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-97-2.png" width="672" /></p>
<p>A Bayesian model of Zombie IQ
Zombies are stupid, and you and your colleagues at the National Zombie
Research Laboratory are interested in how stupid they are. To the right,
you have the Normal model we developed in the last video, but with the
temperature data switched out with some zombie IQs fresh from the lab.
What we’re interested in is how much we can learn about the mean zombie
IQ from this data. The model is complete, save for that we need to calculate
the probability of each parameter combination in pars.<br />
Use Bayes Theorem to calculate these probabilities and assign them to pars$probability to complete the model.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="bayesian-statistics.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The IQ of a bunch of zombies</span></span>
<span id="cb295-2"><a href="bayesian-statistics.html#cb295-2" aria-hidden="true" tabindex="-1"></a>iq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">44</span>, <span class="dv">34</span>, <span class="dv">18</span>, <span class="dv">51</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="dv">49</span>, <span class="dv">48</span>, <span class="dv">46</span>)</span>
<span id="cb295-3"><a href="bayesian-statistics.html#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the parameter grid</span></span>
<span id="cb295-4"><a href="bayesian-statistics.html#cb295-4" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mu =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="at">length.out =</span> <span class="dv">100</span>), </span>
<span id="cb295-5"><a href="bayesian-statistics.html#cb295-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sigma =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">50</span>, <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb295-6"><a href="bayesian-statistics.html#cb295-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining and calculating the prior density for each parameter combination</span></span>
<span id="cb295-7"><a href="bayesian-statistics.html#cb295-7" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>mu_prior <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(pars<span class="sc">$</span>mu, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span>
<span id="cb295-8"><a href="bayesian-statistics.html#cb295-8" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>sigma_prior <span class="ot">&lt;-</span> <span class="fu">dunif</span>(pars<span class="sc">$</span>sigma, <span class="at">min =</span> <span class="fl">0.1</span>, <span class="at">max =</span> <span class="dv">50</span>)</span>
<span id="cb295-9"><a href="bayesian-statistics.html#cb295-9" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>prior <span class="ot">&lt;-</span> pars<span class="sc">$</span>mu_prior <span class="sc">*</span> pars<span class="sc">$</span>sigma_prior</span>
<span id="cb295-10"><a href="bayesian-statistics.html#cb295-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the likelihood for each parameter combination</span></span>
<span id="cb295-11"><a href="bayesian-statistics.html#cb295-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pars)) {</span>
<span id="cb295-12"><a href="bayesian-statistics.html#cb295-12" aria-hidden="true" tabindex="-1"></a>  likelihoods <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(iq, pars<span class="sc">$</span>mu[i], pars<span class="sc">$</span>sigma[i])</span>
<span id="cb295-13"><a href="bayesian-statistics.html#cb295-13" aria-hidden="true" tabindex="-1"></a>  pars<span class="sc">$</span>likelihood[i] <span class="ot">&lt;-</span> <span class="fu">prod</span>(likelihoods)</span>
<span id="cb295-14"><a href="bayesian-statistics.html#cb295-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb295-15"><a href="bayesian-statistics.html#cb295-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability of each parameter combination</span></span>
<span id="cb295-16"><a href="bayesian-statistics.html#cb295-16" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>likelihood <span class="sc">*</span> pars<span class="sc">$</span>prior <span class="sc">/</span> <span class="fu">sum</span>(pars<span class="sc">$</span>likelihood <span class="sc">*</span> pars<span class="sc">$</span>prior)</span></code></pre></div>
<p>Sampling from the zombie posterior
Again pars contains the data frame representing the posterior
zombie IQ distribution you calculated earlier.
The code to the right draws sample_indices: a sample of row
numbers (a.k.a. indices) from the posterior. Now, let’s sample
from pars to calculate some new measures!<br />
Use sample_indices to create a new data frame pars_sample from pars with the columns mu and sigma drawn from the rows indicated by sample_indices.
Tip: If df is a data frame with many rows and columns here is how you would extract rows 1, 3 and 1 (again), and the columns named “height” and “weight”:</p>
<p>df[c(1,3,1), c(“height,”“weight”)]</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="bayesian-statistics.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pars)</span></code></pre></div>
<pre><code>##         mu sigma    mu_prior sigma_prior        prior likelihood probability
## 1 0.000000   0.1 0.002419707  0.02004008 4.849113e-05          0           0
## 2 1.515152   0.1 0.002456367  0.02004008 4.922578e-05          0           0
## 3 3.030303   0.1 0.002493009  0.02004008 4.996010e-05          0           0
## 4 4.545455   0.1 0.002529617  0.02004008 5.069373e-05          0           0
## 5 6.060606   0.1 0.002566174  0.02004008 5.142633e-05          0           0
## 6 7.575758   0.1 0.002602661  0.02004008 5.215754e-05          0           0</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="bayesian-statistics.html#cb298-1" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>( <span class="fu">nrow</span>(pars), <span class="at">size =</span> <span class="dv">10000</span>,</span>
<span id="cb298-2"><a href="bayesian-statistics.html#cb298-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> pars<span class="sc">$</span>probability)</span>
<span id="cb298-3"><a href="bayesian-statistics.html#cb298-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sample_indices)</span></code></pre></div>
<pre><code>## [1] 1932 2030 2426 1628 1928 2529</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="bayesian-statistics.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample from pars to calculate some new measures</span></span>
<span id="cb300-2"><a href="bayesian-statistics.html#cb300-2" aria-hidden="true" tabindex="-1"></a>pars_sample <span class="ot">&lt;-</span> pars[sample_indices, <span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>)]</span>
<span id="cb300-3"><a href="bayesian-statistics.html#cb300-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-4"><a href="bayesian-statistics.html#cb300-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the mean IQ</span></span>
<span id="cb300-5"><a href="bayesian-statistics.html#cb300-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pars_sample<span class="sc">$</span>mu)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="bayesian-statistics.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the mean IQ</span></span>
<span id="cb301-2"><a href="bayesian-statistics.html#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pars_sample<span class="sc">$</span>mu, <span class="dv">100</span>, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-99-2.png" width="672" /></p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="bayesian-statistics.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate quantiles</span></span>
<span id="cb302-2"><a href="bayesian-statistics.html#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(pars_sample<span class="sc">$</span>mu, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##     2.5%      50%    97.5% 
## 34.84848 42.42424 50.00000</code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="bayesian-statistics.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pars_sample)</span></code></pre></div>
<pre><code>##            mu     sigma
## 1932 46.96970  9.676768
## 2030 43.93939 10.180808
## 2426 37.87879 12.196970
## 1628 40.90909  8.164646
## 1928 40.90909  9.676768
## 2529 42.42424 12.701010</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="bayesian-statistics.html#cb306-1" aria-hidden="true" tabindex="-1"></a>pred_iq <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> pars_sample<span class="sc">$</span>mu, </span>
<span id="cb306-2"><a href="bayesian-statistics.html#cb306-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sd =</span> pars_sample<span class="sc">$</span>sigma)</span>
<span id="cb306-3"><a href="bayesian-statistics.html#cb306-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-4"><a href="bayesian-statistics.html#cb306-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize pred_iq</span></span>
<span id="cb306-5"><a href="bayesian-statistics.html#cb306-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pred_iq)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-99-3.png" width="672" /></p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="bayesian-statistics.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability of a zombie being &quot;smart&quot; (+60 IQ)</span></span>
<span id="cb307-2"><a href="bayesian-statistics.html#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pred_iq <span class="sc">&gt;=</span> <span class="dv">60</span>) <span class="sc">/</span> <span class="fu">length</span>(pred_iq)</span></code></pre></div>
<pre><code>## [1] 0.089</code></pre>
</div>
<div id="the-best-models" class="section level2" number="31.3">
<h2><span class="header-section-number">31.3</span> The BEST models</h2>
<p>The t-test is a classical statistical procedure used to compare the
means of two data sets.</p>
<p>In 2013 John Kruschke developed a souped-up Bayesian version of the
t-test he named BEST (standing for Bayesian Estimation Supersedes
the t-test).</p>
<p>We would like to compair IQ of two groups of 10 patiens on different diets (a and b).</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="bayesian-statistics.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The IQ of patients.</span></span>
<span id="cb309-2"><a href="bayesian-statistics.html#cb309-2" aria-hidden="true" tabindex="-1"></a>iq_a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">44</span>, <span class="dv">34</span>, <span class="dv">18</span>, <span class="dv">51</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="dv">49</span>, <span class="dv">48</span>, <span class="dv">46</span>)</span>
<span id="cb309-3"><a href="bayesian-statistics.html#cb309-3" aria-hidden="true" tabindex="-1"></a>iq_b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">44</span>, <span class="dv">52</span>, <span class="dv">42</span>, <span class="dv">66</span>, <span class="dv">53</span>, <span class="dv">42</span>, <span class="dv">55</span>, <span class="dv">57</span>, <span class="dv">56</span>, <span class="dv">51</span>)</span>
<span id="cb309-4"><a href="bayesian-statistics.html#cb309-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-5"><a href="bayesian-statistics.html#cb309-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean difference in IQ between the two groups</span></span>
<span id="cb309-6"><a href="bayesian-statistics.html#cb309-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(iq_b) <span class="sc">-</span> <span class="fu">mean</span>(iq_a)</span></code></pre></div>
<pre><code>## [1] 9.3</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="bayesian-statistics.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(BEST)</span>
<span id="cb311-2"><a href="bayesian-statistics.html#cb311-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-3"><a href="bayesian-statistics.html#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the BEST model to the data from both groups</span></span>
<span id="cb311-4"><a href="bayesian-statistics.html#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(BEST)</span>
<span id="cb311-5"><a href="bayesian-statistics.html#cb311-5" aria-hidden="true" tabindex="-1"></a>best_posterior <span class="ot">&lt;-</span> BEST<span class="sc">::</span><span class="fu">BESTmcmc</span>(iq_b, iq_a)</span></code></pre></div>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="bayesian-statistics.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the model result</span></span>
<span id="cb312-2"><a href="bayesian-statistics.html#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(best_posterior)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<p>The Bayesian model behind BEST assumes that the generative model for
the data is a <strong>t-distribution</strong>; a more flexible distribution than the normal
distribution as it assumes that data points might be outliers to some degree.
This makes BEST’s estimate of the mean difference robust to outliers in the data.</p>
<p><strong>Sources</strong></p>
<p><a href="https://learn.datacamp.com/courses/fundamentals-of-bayesian-data-analysis-in-r">Fundamentals of Bayesian Data Analysis in R on Datacamp</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="learning-vector-quantization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="naive-bayes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/42_bayesian_statistics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
